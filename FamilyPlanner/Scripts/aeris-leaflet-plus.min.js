!function(t,e){e(),t.aeris.VERSION="1.0.2"}(this,function(){function t(t,e,i){var r=e-String(t).length+1;return i||(i="0"),new Array(r).join(i||"0")+t}var e,i,r;!function(t){function n(t,e){return b.call(t,e)}function s(t,e){var i,r,n,s,o,a,l,u,c,p,h,d=e&&e.split("/"),f=y.map,m=f&&f["*"]||{};if(t&&"."===t.charAt(0))if(e){for(d=d.slice(0,d.length-1),t=t.split("/"),o=t.length-1,y.nodeIdCompat&&w.test(t[o])&&(t[o]=t[o].replace(w,"")),t=d.concat(t),c=0;c<t.length;c+=1)if(h=t[c],"."===h)t.splice(c,1),c-=1;else if(".."===h){if(1===c&&(".."===t[2]||".."===t[0]))break;c>0&&(t.splice(c-1,2),c-=2)}t=t.join("/")}else 0===t.indexOf("./")&&(t=t.substring(2));if((d||m)&&f){for(i=t.split("/"),c=i.length;c>0;c-=1){if(r=i.slice(0,c).join("/"),d)for(p=d.length;p>0;p-=1)if(n=f[d.slice(0,p).join("/")],n&&(n=n[r])){s=n,a=c;break}if(s)break;!l&&m&&m[r]&&(l=m[r],u=c)}!s&&l&&(s=l,a=u),s&&(i.splice(0,a,s),t=i.join("/"))}return t}function o(e,i){return function(){return d.apply(t,L.call(arguments,0).concat([e,i]))}}function a(t){return function(e){return s(e,t)}}function l(t){return function(e){g[t]=e}}function u(e){if(n(_,e)){var i=_[e];delete _[e],v[e]=!0,h.apply(t,i)}if(!n(g,e)&&!n(v,e))throw new Error("No "+e);return g[e]}function c(t){var e,i=t?t.indexOf("!"):-1;return i>-1&&(e=t.substring(0,i),t=t.substring(i+1,t.length)),[e,t]}function p(t){return function(){return y&&y.config&&y.config[t]||{}}}var h,d,f,m,g={},_={},y={},v={},b=Object.prototype.hasOwnProperty,L=[].slice,w=/\.js$/;f=function(t,e){var i,r=c(t),n=r[0];return t=r[1],n&&(n=s(n,e),i=u(n)),n?t=i&&i.normalize?i.normalize(t,a(e)):s(t,e):(t=s(t,e),r=c(t),n=r[0],t=r[1],n&&(i=u(n))),{f:n?n+"!"+t:t,n:t,pr:n,p:i}},m={require:function(t){return o(t)},exports:function(t){var e=g[t];return"undefined"!=typeof e?e:g[t]={}},module:function(t){return{id:t,uri:"",exports:g[t],config:p(t)}}},h=function(e,i,r,s){var a,c,p,h,d,y,b=[],L=typeof r;if(s=s||e,"undefined"===L||"function"===L){for(i=!i.length&&r.length?["require","exports","module"]:i,d=0;d<i.length;d+=1)if(h=f(i[d],s),c=h.f,"require"===c)b[d]=m.require(e);else if("exports"===c)b[d]=m.exports(e),y=!0;else if("module"===c)a=b[d]=m.module(e);else if(n(g,c)||n(_,c)||n(v,c))b[d]=u(c);else{if(!h.p)throw new Error(e+" missing "+c);h.p.load(h.n,o(s,!0),l(c),{}),b[d]=g[c]}p=r?r.apply(g[e],b):void 0,e&&(a&&a.exports!==t&&a.exports!==g[e]?g[e]=a.exports:p===t&&y||(g[e]=p))}else e&&(g[e]=r)},e=i=d=function(e,i,r,n,s){if("string"==typeof e)return m[e]?m[e](i):u(f(e,i).f);if(!e.splice){if(y=e,y.deps&&d(y.deps,y.callback),!i)return;i.splice?(e=i,i=r,r=null):e=t}return i=i||function(){},"function"==typeof r&&(r=n,n=s),n?h(t,e,i,r):setTimeout(function(){h(t,e,i,r)},4),d},d.config=function(t){return d(t)},e._defined=g,r=function(t,e,i){e.splice||(i=e,e=[]),n(g,t)||n(_,t)||(_[t]=[t,e,i])},r.amd={jQuery:!0}}(),r("bower_components/almond/almond",function(){}),function(){var t=this,e=t._,i={},n=Array.prototype,s=Object.prototype,o=Function.prototype,a=n.push,l=n.slice,u=n.concat,c=s.toString,p=s.hasOwnProperty,h=n.forEach,d=n.map,f=n.reduce,m=n.reduceRight,g=n.filter,_=n.every,y=n.some,v=n.indexOf,b=n.lastIndexOf,L=Array.isArray,w=Object.keys,T=o.bind,k=function(t){return t instanceof k?t:this instanceof k?void(this._wrapped=t):new k(t)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=k),exports._=k):t._=k,k.VERSION="1.6.0";var x=k.each=k.forEach=function(t,e,r){if(null==t)return t;if(h&&t.forEach===h)t.forEach(e,r);else if(t.length===+t.length){for(var n=0,s=t.length;s>n;n++)if(e.call(r,t[n],n,t)===i)return}else for(var o=k.keys(t),n=0,s=o.length;s>n;n++)if(e.call(r,t[o[n]],o[n],t)===i)return;return t};k.map=k.collect=function(t,e,i){var r=[];return null==t?r:d&&t.map===d?t.map(e,i):(x(t,function(t,n,s){r.push(e.call(i,t,n,s))}),r)};var S="Reduce of empty array with no initial value";k.reduce=k.foldl=k.inject=function(t,e,i,r){var n=arguments.length>2;if(null==t&&(t=[]),f&&t.reduce===f)return r&&(e=k.bind(e,r)),n?t.reduce(e,i):t.reduce(e);if(x(t,function(t,s,o){n?i=e.call(r,i,t,s,o):(i=t,n=!0)}),!n)throw new TypeError(S);return i},k.reduceRight=k.foldr=function(t,e,i,r){var n=arguments.length>2;if(null==t&&(t=[]),m&&t.reduceRight===m)return r&&(e=k.bind(e,r)),n?t.reduceRight(e,i):t.reduceRight(e);var s=t.length;if(s!==+s){var o=k.keys(t);s=o.length}if(x(t,function(a,l,u){l=o?o[--s]:--s,n?i=e.call(r,i,t[l],l,u):(i=t[l],n=!0)}),!n)throw new TypeError(S);return i},k.find=k.detect=function(t,e,i){var r;return C(t,function(t,n,s){return e.call(i,t,n,s)?(r=t,!0):void 0}),r},k.filter=k.select=function(t,e,i){var r=[];return null==t?r:g&&t.filter===g?t.filter(e,i):(x(t,function(t,n,s){e.call(i,t,n,s)&&r.push(t)}),r)},k.reject=function(t,e,i){return k.filter(t,function(t,r,n){return!e.call(i,t,r,n)},i)},k.every=k.all=function(t,e,r){e||(e=k.identity);var n=!0;return null==t?n:_&&t.every===_?t.every(e,r):(x(t,function(t,s,o){return(n=n&&e.call(r,t,s,o))?void 0:i}),!!n)};var C=k.some=k.any=function(t,e,r){e||(e=k.identity);var n=!1;return null==t?n:y&&t.some===y?t.some(e,r):(x(t,function(t,s,o){return n||(n=e.call(r,t,s,o))?i:void 0}),!!n)};k.contains=k.include=function(t,e){return null==t?!1:v&&t.indexOf===v?-1!=t.indexOf(e):C(t,function(t){return t===e})},k.invoke=function(t,e){var i=l.call(arguments,2),r=k.isFunction(e);return k.map(t,function(t){return(r?e:t[e]).apply(t,i)})},k.pluck=function(t,e){return k.map(t,k.property(e))},k.where=function(t,e){return k.filter(t,k.matches(e))},k.findWhere=function(t,e){return k.find(t,k.matches(e))},k.max=function(t,e,i){if(!e&&k.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.max.apply(Math,t);var r=-(1/0),n=-(1/0);return x(t,function(t,s,o){var a=e?e.call(i,t,s,o):t;a>n&&(r=t,n=a)}),r},k.min=function(t,e,i){if(!e&&k.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.min.apply(Math,t);var r=1/0,n=1/0;return x(t,function(t,s,o){var a=e?e.call(i,t,s,o):t;n>a&&(r=t,n=a)}),r},k.shuffle=function(t){var e,i=0,r=[];return x(t,function(t){e=k.random(i++),r[i-1]=r[e],r[e]=t}),r},k.sample=function(t,e,i){return null==e||i?(t.length!==+t.length&&(t=k.values(t)),t[k.random(t.length-1)]):k.shuffle(t).slice(0,Math.max(0,e))};var A=function(t){return null==t?k.identity:k.isFunction(t)?t:k.property(t)};k.sortBy=function(t,e,i){return e=A(e),k.pluck(k.map(t,function(t,r,n){return{value:t,index:r,criteria:e.call(i,t,r,n)}}).sort(function(t,e){var i=t.criteria,r=e.criteria;if(i!==r){if(i>r||void 0===i)return 1;if(r>i||void 0===r)return-1}return t.index-e.index}),"value")};var E=function(t){return function(e,i,r){var n={};return i=A(i),x(e,function(s,o){var a=i.call(r,s,o,e);t(n,a,s)}),n}};k.groupBy=E(function(t,e,i){k.has(t,e)?t[e].push(i):t[e]=[i]}),k.indexBy=E(function(t,e,i){t[e]=i}),k.countBy=E(function(t,e){k.has(t,e)?t[e]++:t[e]=1}),k.sortedIndex=function(t,e,i,r){i=A(i);for(var n=i.call(r,e),s=0,o=t.length;o>s;){var a=s+o>>>1;i.call(r,t[a])<n?s=a+1:o=a}return s},k.toArray=function(t){return t?k.isArray(t)?l.call(t):t.length===+t.length?k.map(t,k.identity):k.values(t):[]},k.size=function(t){return null==t?0:t.length===+t.length?t.length:k.keys(t).length},k.first=k.head=k.take=function(t,e,i){return null!=t?null==e||i?t[0]:0>e?[]:l.call(t,0,e):void 0},k.initial=function(t,e,i){return l.call(t,0,t.length-(null==e||i?1:e))},k.last=function(t,e,i){return null!=t?null==e||i?t[t.length-1]:l.call(t,Math.max(t.length-e,0)):void 0},k.rest=k.tail=k.drop=function(t,e,i){return l.call(t,null==e||i?1:e)},k.compact=function(t){return k.filter(t,k.identity)};var M=function(t,e,i){return e&&k.every(t,k.isArray)?u.apply(i,t):(x(t,function(t){k.isArray(t)||k.isArguments(t)?e?a.apply(i,t):M(t,e,i):i.push(t)}),i)};k.flatten=function(t,e){return M(t,e,[])},k.without=function(t){return k.difference(t,l.call(arguments,1))},k.partition=function(t,e){var i=[],r=[];return x(t,function(t){(e(t)?i:r).push(t)}),[i,r]},k.uniq=k.unique=function(t,e,i,r){k.isFunction(e)&&(r=i,i=e,e=!1);var n=i?k.map(t,i,r):t,s=[],o=[];return x(n,function(i,r){(e?r&&o[o.length-1]===i:k.contains(o,i))||(o.push(i),s.push(t[r]))}),s},k.union=function(){return k.uniq(k.flatten(arguments,!0))},k.intersection=function(t){var e=l.call(arguments,1);return k.filter(k.uniq(t),function(t){return k.every(e,function(e){return k.contains(e,t)})})},k.difference=function(t){var e=u.apply(n,l.call(arguments,1));return k.filter(t,function(t){return!k.contains(e,t)})},k.zip=function(){for(var t=k.max(k.pluck(arguments,"length").concat(0)),e=new Array(t),i=0;t>i;i++)e[i]=k.pluck(arguments,""+i);return e},k.object=function(t,e){if(null==t)return{};for(var i={},r=0,n=t.length;n>r;r++)e?i[t[r]]=e[r]:i[t[r][0]]=t[r][1];return i},k.indexOf=function(t,e,i){if(null==t)return-1;var r=0,n=t.length;if(i){if("number"!=typeof i)return r=k.sortedIndex(t,e),t[r]===e?r:-1;r=0>i?Math.max(0,n+i):i}if(v&&t.indexOf===v)return t.indexOf(e,i);for(;n>r;r++)if(t[r]===e)return r;return-1},k.lastIndexOf=function(t,e,i){if(null==t)return-1;var r=null!=i;if(b&&t.lastIndexOf===b)return r?t.lastIndexOf(e,i):t.lastIndexOf(e);for(var n=r?i:t.length;n--;)if(t[n]===e)return n;return-1},k.range=function(t,e,i){arguments.length<=1&&(e=t||0,t=0),i=arguments[2]||1;for(var r=Math.max(Math.ceil((e-t)/i),0),n=0,s=new Array(r);r>n;)s[n++]=t,t+=i;return s};var O=function(){};k.bind=function(t,e){var i,r;if(T&&t.bind===T)return T.apply(t,l.call(arguments,1));if(!k.isFunction(t))throw new TypeError;return i=l.call(arguments,2),r=function(){if(!(this instanceof r))return t.apply(e,i.concat(l.call(arguments)));O.prototype=t.prototype;var n=new O;O.prototype=null;var s=t.apply(n,i.concat(l.call(arguments)));return Object(s)===s?s:n}},k.partial=function(t){var e=l.call(arguments,1);return function(){for(var i=0,r=e.slice(),n=0,s=r.length;s>n;n++)r[n]===k&&(r[n]=arguments[i++]);for(;i<arguments.length;)r.push(arguments[i++]);return t.apply(this,r)}},k.bindAll=function(t){var e=l.call(arguments,1);if(0===e.length)throw new Error("bindAll must be passed function names");return x(e,function(e){t[e]=k.bind(t[e],t)}),t},k.memoize=function(t,e){var i={};return e||(e=k.identity),function(){var r=e.apply(this,arguments);return k.has(i,r)?i[r]:i[r]=t.apply(this,arguments)}},k.delay=function(t,e){var i=l.call(arguments,2);return setTimeout(function(){return t.apply(null,i)},e)},k.defer=function(t){return k.delay.apply(k,[t,1].concat(l.call(arguments,1)))},k.throttle=function(t,e,i){var r,n,s,o=null,a=0;i||(i={});var l=function(){a=i.leading===!1?0:k.now(),o=null,s=t.apply(r,n),r=n=null};return function(){var u=k.now();a||i.leading!==!1||(a=u);var c=e-(u-a);return r=this,n=arguments,0>=c?(clearTimeout(o),o=null,a=u,s=t.apply(r,n),r=n=null):o||i.trailing===!1||(o=setTimeout(l,c)),s}},k.debounce=function(t,e,i){var r,n,s,o,a,l=function(){var u=k.now()-o;e>u?r=setTimeout(l,e-u):(r=null,i||(a=t.apply(s,n),s=n=null))};return function(){s=this,n=arguments,o=k.now();var u=i&&!r;return r||(r=setTimeout(l,e)),u&&(a=t.apply(s,n),s=n=null),a}},k.once=function(t){var e,i=!1;return function(){return i?e:(i=!0,e=t.apply(this,arguments),t=null,e)}},k.wrap=function(t,e){return k.partial(e,t)},k.compose=function(){var t=arguments;return function(){for(var e=arguments,i=t.length-1;i>=0;i--)e=[t[i].apply(this,e)];return e[0]}},k.after=function(t,e){return function(){return--t<1?e.apply(this,arguments):void 0}},k.keys=function(t){if(!k.isObject(t))return[];if(w)return w(t);var e=[];for(var i in t)k.has(t,i)&&e.push(i);return e},k.values=function(t){for(var e=k.keys(t),i=e.length,r=new Array(i),n=0;i>n;n++)r[n]=t[e[n]];return r},k.pairs=function(t){for(var e=k.keys(t),i=e.length,r=new Array(i),n=0;i>n;n++)r[n]=[e[n],t[e[n]]];return r},k.invert=function(t){for(var e={},i=k.keys(t),r=0,n=i.length;n>r;r++)e[t[i[r]]]=i[r];return e},k.functions=k.methods=function(t){var e=[];for(var i in t)k.isFunction(t[i])&&e.push(i);return e.sort()},k.extend=function(t){return x(l.call(arguments,1),function(e){if(e)for(var i in e)t[i]=e[i]}),t},k.pick=function(t){var e={},i=u.apply(n,l.call(arguments,1));return x(i,function(i){i in t&&(e[i]=t[i])}),e},k.omit=function(t){var e={},i=u.apply(n,l.call(arguments,1));for(var r in t)k.contains(i,r)||(e[r]=t[r]);return e},k.defaults=function(t){return x(l.call(arguments,1),function(e){if(e)for(var i in e)void 0===t[i]&&(t[i]=e[i])}),t},k.clone=function(t){return k.isObject(t)?k.isArray(t)?t.slice():k.extend({},t):t},k.tap=function(t,e){return e(t),t};var I=function(t,e,i,r){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return t===e;t instanceof k&&(t=t._wrapped),e instanceof k&&(e=e._wrapped);var n=c.call(t);if(n!=c.call(e))return!1;switch(n){case"[object String]":return t==String(e);case"[object Number]":return t!=+t?e!=+e:0==t?1/t==1/e:t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object RegExp]":return t.source==e.source&&t.global==e.global&&t.multiline==e.multiline&&t.ignoreCase==e.ignoreCase}if("object"!=typeof t||"object"!=typeof e)return!1;for(var s=i.length;s--;)if(i[s]==t)return r[s]==e;var o=t.constructor,a=e.constructor;if(o!==a&&!(k.isFunction(o)&&o instanceof o&&k.isFunction(a)&&a instanceof a)&&"constructor"in t&&"constructor"in e)return!1;i.push(t),r.push(e);var l=0,u=!0;if("[object Array]"==n){if(l=t.length,u=l==e.length)for(;l--&&(u=I(t[l],e[l],i,r)););}else{for(var p in t)if(k.has(t,p)&&(l++,!(u=k.has(e,p)&&I(t[p],e[p],i,r))))break;if(u){for(p in e)if(k.has(e,p)&&!l--)break;u=!l}}return i.pop(),r.pop(),u};k.isEqual=function(t,e){return I(t,e,[],[])},k.isEmpty=function(t){if(null==t)return!0;if(k.isArray(t)||k.isString(t))return 0===t.length;for(var e in t)if(k.has(t,e))return!1;return!0},k.isElement=function(t){return!(!t||1!==t.nodeType)},k.isArray=L||function(t){return"[object Array]"==c.call(t)},k.isObject=function(t){return t===Object(t)},x(["Arguments","Function","String","Number","Date","RegExp"],function(t){k["is"+t]=function(e){return c.call(e)=="[object "+t+"]"}}),k.isArguments(arguments)||(k.isArguments=function(t){return!(!t||!k.has(t,"callee"))}),"function"!=typeof/./&&(k.isFunction=function(t){return"function"==typeof t}),k.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},k.isNaN=function(t){return k.isNumber(t)&&t!=+t},k.isBoolean=function(t){return t===!0||t===!1||"[object Boolean]"==c.call(t)},k.isNull=function(t){return null===t},k.isUndefined=function(t){return void 0===t},k.has=function(t,e){return p.call(t,e)},k.noConflict=function(){return t._=e,this},k.identity=function(t){return t},k.constant=function(t){return function(){return t}},k.property=function(t){return function(e){return e[t]}},k.matches=function(t){return function(e){if(e===t)return!0;for(var i in t)if(t[i]!==e[i])return!1;return!0}},k.times=function(t,e,i){for(var r=Array(Math.max(0,t)),n=0;t>n;n++)r[n]=e.call(i,n);return r},k.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},k.now=Date.now||function(){return(new Date).getTime()};var P={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};P.unescape=k.invert(P.escape);var j={escape:new RegExp("["+k.keys(P.escape).join("")+"]","g"),unescape:new RegExp("("+k.keys(P.unescape).join("|")+")","g")};k.each(["escape","unescape"],function(t){k[t]=function(e){return null==e?"":(""+e).replace(j[t],function(e){return P[t][e]})}}),k.result=function(t,e){if(null!=t){var i=t[e];return k.isFunction(i)?i.call(t):i}},k.mixin=function(t){x(k.functions(t),function(e){var i=k[e]=t[e];k.prototype[e]=function(){var t=[this._wrapped];return a.apply(t,arguments),B.call(this,i.apply(k,t))}})};var U=0;k.uniqueId=function(t){var e=++U+"";return t?t+e:e},k.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var F=/(.)^/,N={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},R=/\\|'|\r|\n|\t|\u2028|\u2029/g;k.template=function(t,e,i){var r;i=k.defaults({},i,k.templateSettings);var n=new RegExp([(i.escape||F).source,(i.interpolate||F).source,(i.evaluate||F).source].join("|")+"|$","g"),s=0,o="__p+='";t.replace(n,function(e,i,r,n,a){return o+=t.slice(s,a).replace(R,function(t){return"\\"+N[t]}),i&&(o+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'"),r&&(o+="'+\n((__t=("+r+"))==null?'':__t)+\n'"),n&&(o+="';\n"+n+"\n__p+='"),s=a+e.length,e}),o+="';\n",i.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{r=new Function(i.variable||"obj","_",o)}catch(a){throw a.source=o,a}if(e)return r(e,k);var l=function(t){return r.call(this,t,k)};return l.source="function("+(i.variable||"obj")+"){\n"+o+"}",l},k.chain=function(t){return k(t).chain()};var B=function(t){return this._chain?k(t).chain():t};k.mixin(k),x(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=n[t];k.prototype[t]=function(){var i=this._wrapped;return e.apply(i,arguments),"shift"!=t&&"splice"!=t||0!==i.length||delete i[0],B.call(this,i)}}),x(["concat","join","slice"],function(t){var e=n[t];k.prototype[t]=function(){return B.call(this,e.apply(this._wrapped,arguments))}}),k.extend(k.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}}),"function"==typeof r&&r.amd&&r("underscore",[],function(){return k})}.call(this),r("aeris/util",["underscore"],function(t){var e=this,i=t.noConflict();e._||(e._=i);var r={abstractMethod:function(){},bindAllMethods:function(t,e){var r=e||t;i.each(t,function(e,n){i.isFunction(e)&&(t[n]=e.bind(r))})},inherits:function(t,e){function i(){this.__Parent=e}i.prototype=e.prototype,t.prototype=new i,t.prototype.constructor=t},expose:function(t,e){var r=e.split("."),n=r.length,s=window;return i.each(r,function(e,i){var r=i===n-1,o=s[e]||{};s[e]=r?t:o,s=s[e]},this),t},provide:function(t){return this.expose({},t,!1)},average:function(t){var e=i.isArray(t)?t:n.argsToArray(arguments),r=e.reduce(function(t,e){return t+e},0);return r/e.length},interval:function(t,e,r,n){var s=Array.prototype.slice.call(arguments,3);return r&&(t=i.bind.apply(i,[t,r].concat(s))),window.setInterval(t,e)},argsToArray:function(t){return Array.prototype.slice.call(t,0)},path:function(t,e){var r,n;if(i.isString(t)&&t.length)return r=t.split("."),n=i.isUndefined(e)?window:e,i.reduce(r,function(t,e){return i.isObject(t)?t[e]:void 0},n)},isNumeric:function(t){return!i.isObject(t)&&!isNaN(parseFloat(t))&&isFinite(t)},isInteger:function(t){return i.isNumeric(t)&&t%1===0},isPlainObject:function(t){var e=!i.isFunction(t)&&!i.isArray(t);return i.isObject(t)&&e},throwUncatchable:function(t){i.defer(function(){throw t})},throwError:function(t){throw t},template:function(){var t,e=i.clone(i.templateSettings);return i.templateSettings.interpolate=/\{(.+?)\}/g,t=i.template.apply(i,arguments),i.templateSettings=e,t},eachAtInterval:function(t,e,r){var n=function(s){var o=t[s],a=i.partial(n,s+1);o&&(e(o),i.delay(a,r))};n(0)},tryCatch:function(t,e){try{t()}catch(i){e(i)}}},n=function(t){var e=i.apply(i,arguments);return i.each(r,function(t,i){e[i]=function(){return t.call(e,e._wrapped)}}),e.mixin(r),e};return i.extend(n,i,r),n}),r("jquery",{}),function(t,e){if("function"==typeof r&&r.amd)r("backbone",["underscore","jquery","exports"],function(i,r,n){t.Backbone=e(t,n,i,r)});else if("undefined"!=typeof exports){var n=i("underscore");e(t,exports,n)}else t.Backbone=e(t,{},t._,t.jQuery||t.Zepto||t.ender||t.$)}(this,function(t,e,i,r){var n=t.Backbone,s=[],o=(s.push,s.slice);s.splice;e.VERSION="1.1.2",e.$=r,e.noConflict=function(){return t.Backbone=n,this},e.emulateHTTP=!1,e.emulateJSON=!1;var a=e.Events={on:function(t,e,i){if(!u(this,"on",t,[e,i])||!e)return this;this._events||(this._events={});var r=this._events[t]||(this._events[t]=[]);return r.push({callback:e,context:i,ctx:i||this}),this},once:function(t,e,r){if(!u(this,"once",t,[e,r])||!e)return this;var n=this,s=i.once(function(){n.off(t,s),e.apply(this,arguments)});return s._callback=e,this.on(t,s,r)},off:function(t,e,r){var n,s,o,a,l,c,p,h;if(!this._events||!u(this,"off",t,[e,r]))return this;if(!t&&!e&&!r)return this._events=void 0,this;for(a=t?[t]:i.keys(this._events),l=0,c=a.length;c>l;l++)if(t=a[l],o=this._events[t]){if(this._events[t]=n=[],e||r)for(p=0,h=o.length;h>p;p++)s=o[p],(e&&e!==s.callback&&e!==s.callback._callback||r&&r!==s.context)&&n.push(s);n.length||delete this._events[t]}return this},trigger:function(t){if(!this._events)return this;var e=o.call(arguments,1);if(!u(this,"trigger",t,e))return this;var i=this._events[t],r=this._events.all;return i&&c(i,e),r&&c(r,arguments),this},stopListening:function(t,e,r){var n=this._listeningTo;if(!n)return this;var s=!e&&!r;r||"object"!=typeof e||(r=this),t&&((n={})[t._listenId]=t);for(var o in n)t=n[o],t.off(e,r,this),(s||i.isEmpty(t._events))&&delete this._listeningTo[o];return this}},l=/\s+/,u=function(t,e,i,r){if(!i)return!0;if("object"==typeof i){for(var n in i)t[e].apply(t,[n,i[n]].concat(r));return!1}if(l.test(i)){for(var s=i.split(l),o=0,a=s.length;a>o;o++)t[e].apply(t,[s[o]].concat(r));return!1}return!0},c=function(t,e){var i,r=-1,n=t.length,s=e[0],o=e[1],a=e[2];switch(e.length){case 0:for(;++r<n;)(i=t[r]).callback.call(i.ctx);return;case 1:for(;++r<n;)(i=t[r]).callback.call(i.ctx,s);return;case 2:for(;++r<n;)(i=t[r]).callback.call(i.ctx,s,o);return;case 3:for(;++r<n;)(i=t[r]).callback.call(i.ctx,s,o,a);return;default:for(;++r<n;)(i=t[r]).callback.apply(i.ctx,e);return}},p={listenTo:"on",listenToOnce:"once"};i.each(p,function(t,e){a[e]=function(e,r,n){var s=this._listeningTo||(this._listeningTo={}),o=e._listenId||(e._listenId=i.uniqueId("l"));return s[o]=e,n||"object"!=typeof r||(n=this),e[t](r,n,this),this}}),a.bind=a.on,a.unbind=a.off,i.extend(e,a);var h=e.Model=function(t,e){var r=t||{};e||(e={}),this.cid=i.uniqueId("c"),this.attributes={},e.collection&&(this.collection=e.collection),e.parse&&(r=this.parse(r,e)||{}),r=i.defaults({},r,i.result(this,"defaults")),this.set(r,e),this.changed={},this.initialize.apply(this,arguments)};i.extend(h.prototype,a,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(t){return i.clone(this.attributes)},sync:function(){return e.sync.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(t){return i.escape(this.get(t))},has:function(t){return null!=this.get(t)},set:function(t,e,r){var n,s,o,a,l,u,c,p;if(null==t)return this;if("object"==typeof t?(s=t,r=e):(s={})[t]=e,r||(r={}),!this._validate(s,r))return!1;o=r.unset,l=r.silent,a=[],u=this._changing,this._changing=!0,u||(this._previousAttributes=i.clone(this.attributes),this.changed={}),p=this.attributes,c=this._previousAttributes,this.idAttribute in s&&(this.id=s[this.idAttribute]);for(n in s)e=s[n],i.isEqual(p[n],e)||a.push(n),i.isEqual(c[n],e)?delete this.changed[n]:this.changed[n]=e,o?delete p[n]:p[n]=e;if(!l){a.length&&(this._pending=r);for(var h=0,d=a.length;d>h;h++)this.trigger("change:"+a[h],this,p[a[h]],r)}if(u)return this;if(!l)for(;this._pending;)r=this._pending,this._pending=!1,this.trigger("change",this,r);return this._pending=!1,this._changing=!1,this},unset:function(t,e){return this.set(t,void 0,i.extend({},e,{unset:!0}))},clear:function(t){var e={};for(var r in this.attributes)e[r]=void 0;return this.set(e,i.extend({},t,{unset:!0}))},hasChanged:function(t){return null==t?!i.isEmpty(this.changed):i.has(this.changed,t)},changedAttributes:function(t){if(!t)return this.hasChanged()?i.clone(this.changed):!1;var e,r=!1,n=this._changing?this._previousAttributes:this.attributes;for(var s in t)i.isEqual(n[s],e=t[s])||((r||(r={}))[s]=e);return r},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return i.clone(this._previousAttributes)},fetch:function(t){t=t?i.clone(t):{},void 0===t.parse&&(t.parse=!0);var e=this,r=t.success;return t.success=function(i){return e.set(e.parse(i,t),t)?(r&&r(e,i,t),void e.trigger("sync",e,i,t)):!1},N(this,t),this.sync("read",this,t)},save:function(t,e,r){var n,s,o,a=this.attributes;if(null==t||"object"==typeof t?(n=t,r=e):(n={})[t]=e,r=i.extend({validate:!0},r),n&&!r.wait){if(!this.set(n,r))return!1}else if(!this._validate(n,r))return!1;n&&r.wait&&(this.attributes=i.extend({},a,n)),void 0===r.parse&&(r.parse=!0);var l=this,u=r.success;return r.success=function(t){l.attributes=a;var e=l.parse(t,r);return r.wait&&(e=i.extend(n||{},e)),i.isObject(e)&&!l.set(e,r)?!1:(u&&u(l,t,r),void l.trigger("sync",l,t,r))},N(this,r),s=this.isNew()?"create":r.patch?"patch":"update","patch"===s&&(r.attrs=n),o=this.sync(s,this,r),n&&r.wait&&(this.attributes=a),o},destroy:function(t){t=t?i.clone(t):{};var e=this,r=t.success,n=function(){e.trigger("destroy",e,e.collection,t)};if(t.success=function(i){(t.wait||e.isNew())&&n(),r&&r(e,i,t),e.isNew()||e.trigger("sync",e,i,t)},this.isNew())return t.success(),!1;N(this,t);var s=this.sync("delete",this,t);return t.wait||n(),s},url:function(){var t=i.result(this,"urlRoot")||i.result(this.collection,"url")||F();return this.isNew()?t:t.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},parse:function(t,e){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(t){return this._validate({},i.extend(t||{},{validate:!0}))},_validate:function(t,e){if(!e.validate||!this.validate)return!0;t=i.extend({},this.attributes,t);var r=this.validationError=this.validate(t,e)||null;return r?(this.trigger("invalid",this,r,i.extend(e,{validationError:r})),!1):!0}});var d=["keys","values","pairs","invert","pick","omit"];i.each(d,function(t){h.prototype[t]=function(){var e=o.call(arguments);return e.unshift(this.attributes),i[t].apply(i,e)}});var f=e.Collection=function(t,e){e||(e={}),e.model&&(this.model=e.model),void 0!==e.comparator&&(this.comparator=e.comparator),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,i.extend({silent:!0},e))},m={add:!0,remove:!0,merge:!0},g={add:!0,remove:!1};i.extend(f.prototype,a,{model:h,initialize:function(){},toJSON:function(t){return this.map(function(e){return e.toJSON(t)})},sync:function(){return e.sync.apply(this,arguments)},add:function(t,e){return this.set(t,i.extend({merge:!1},e,g))},remove:function(t,e){var r=!i.isArray(t);t=r?[t]:i.clone(t),e||(e={});var n,s,o,a;for(n=0,s=t.length;s>n;n++)a=t[n]=this.get(t[n]),a&&(delete this._byId[a.id],delete this._byId[a.cid],o=this.indexOf(a),this.models.splice(o,1),this.length--,e.silent||(e.index=o,a.trigger("remove",a,this,e)),this._removeReference(a,e));return r?t[0]:t},set:function(t,e){e=i.defaults({},e,m),e.parse&&(t=this.parse(t,e));var r=!i.isArray(t);t=r?t?[t]:[]:i.clone(t);var n,s,o,a,l,u,c,p=e.at,d=this.model,f=this.comparator&&null==p&&e.sort!==!1,g=i.isString(this.comparator)?this.comparator:null,_=[],y=[],v={},b=e.add,L=e.merge,w=e.remove,T=!f&&b&&w?[]:!1;for(n=0,s=t.length;s>n;n++){if(l=t[n]||{},o=l instanceof h?a=l:l[d.prototype.idAttribute||"id"],u=this.get(o))w&&(v[u.cid]=!0),L&&(l=l===a?a.attributes:l,e.parse&&(l=u.parse(l,e)),u.set(l,e),f&&!c&&u.hasChanged(g)&&(c=!0)),t[n]=u;else if(b){if(a=t[n]=this._prepareModel(l,e),!a)continue;_.push(a),this._addReference(a,e)}a=u||a,!T||!a.isNew()&&v[a.id]||T.push(a),v[a.id]=!0}if(w){for(n=0,s=this.length;s>n;++n)v[(a=this.models[n]).cid]||y.push(a);y.length&&this.remove(y,e)}if(_.length||T&&T.length)if(f&&(c=!0),this.length+=_.length,null!=p)for(n=0,s=_.length;s>n;n++)this.models.splice(p+n,0,_[n]);else{T&&(this.models.length=0);var k=T||_;for(n=0,s=k.length;s>n;n++)this.models.push(k[n])}if(c&&this.sort({silent:!0}),!e.silent){for(n=0,s=_.length;s>n;n++)(a=_[n]).trigger("add",a,this,e);(c||T&&T.length)&&this.trigger("sort",this,e)}return r?t[0]:t},reset:function(t,e){e||(e={});for(var r=0,n=this.models.length;n>r;r++)this._removeReference(this.models[r],e);return e.previousModels=this.models,this._reset(),t=this.add(t,i.extend({silent:!0},e)),e.silent||this.trigger("reset",this,e),t},push:function(t,e){return this.add(t,i.extend({at:this.length},e))},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t),e},unshift:function(t,e){return this.add(t,i.extend({at:0},e))},shift:function(t){var e=this.at(0);return this.remove(e,t),e},slice:function(){return o.apply(this.models,arguments)},get:function(t){return null!=t?this._byId[t]||this._byId[t.id]||this._byId[t.cid]:void 0},at:function(t){return this.models[t]},where:function(t,e){return i.isEmpty(t)?e?void 0:[]:this[e?"find":"filter"](function(e){for(var i in t)if(t[i]!==e.get(i))return!1;return!0})},findWhere:function(t){return this.where(t,!0)},sort:function(t){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return t||(t={}),i.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(i.bind(this.comparator,this)),t.silent||this.trigger("sort",this,t),this},pluck:function(t){return i.invoke(this.models,"get",t)},fetch:function(t){t=t?i.clone(t):{},void 0===t.parse&&(t.parse=!0);var e=t.success,r=this;return t.success=function(i){var n=t.reset?"reset":"set";r[n](i,t),e&&e(r,i,t),r.trigger("sync",r,i,t)},N(this,t),this.sync("read",this,t)},create:function(t,e){if(e=e?i.clone(e):{},!(t=this._prepareModel(t,e)))return!1;e.wait||this.add(t,e);var r=this,n=e.success;return e.success=function(t,i){e.wait&&r.add(t,e),n&&n(t,i,e)},t.save(null,e),t},parse:function(t,e){return t},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(t,e){if(t instanceof h)return t;e=e?i.clone(e):{},e.collection=this;var r=new this.model(t,e);return r.validationError?(this.trigger("invalid",this,r.validationError,e),!1):r},_addReference:function(t,e){this._byId[t.cid]=t,null!=t.id&&(this._byId[t.id]=t),t.collection||(t.collection=this),t.on("all",this._onModelEvent,this)},_removeReference:function(t,e){this===t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,i,r){("add"!==t&&"remove"!==t||i===this)&&("destroy"===t&&this.remove(e,r),e&&t==="change:"+e.idAttribute&&(delete this._byId[e.previous(e.idAttribute)],null!=e.id&&(this._byId[e.id]=e)),this.trigger.apply(this,arguments))}});var _=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain","sample"];i.each(_,function(t){f.prototype[t]=function(){var e=o.call(arguments);return e.unshift(this.models),i[t].apply(i,e)}});var y=["groupBy","countBy","sortBy","indexBy"];i.each(y,function(t){f.prototype[t]=function(e,r){var n=i.isFunction(e)?e:function(t){return t.get(e)};return i[t](this.models,n,r)}});var v=e.View=function(t){this.cid=i.uniqueId("view"),t||(t={}),i.extend(this,i.pick(t,L)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},b=/^(\S+)\s*(.*)$/,L=["model","collection","el","id","attributes","className","tagName","events"];i.extend(v.prototype,a,{tagName:"div",$:function(t){return this.$el.find(t)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(t,i){return this.$el&&this.undelegateEvents(),this.$el=t instanceof e.$?t:e.$(t),this.el=this.$el[0],i!==!1&&this.delegateEvents(),this},delegateEvents:function(t){if(!t&&!(t=i.result(this,"events")))return this;this.undelegateEvents();for(var e in t){var r=t[e];if(i.isFunction(r)||(r=this[t[e]]),r){var n=e.match(b),s=n[1],o=n[2];r=i.bind(r,this),s+=".delegateEvents"+this.cid,""===o?this.$el.on(s,r):this.$el.on(s,o,r)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(this.el)this.setElement(i.result(this,"el"),!1);else{var t=i.extend({},i.result(this,"attributes"));
this.id&&(t.id=i.result(this,"id")),this.className&&(t["class"]=i.result(this,"className"));var r=e.$("<"+i.result(this,"tagName")+">").attr(t);this.setElement(r,!1)}}}),e.sync=function(t,r,n){var s=T[t];i.defaults(n||(n={}),{emulateHTTP:e.emulateHTTP,emulateJSON:e.emulateJSON});var o={type:s,dataType:"json"};if(n.url||(o.url=i.result(r,"url")||F()),null!=n.data||!r||"create"!==t&&"update"!==t&&"patch"!==t||(o.contentType="application/json",o.data=JSON.stringify(n.attrs||r.toJSON(n))),n.emulateJSON&&(o.contentType="application/x-www-form-urlencoded",o.data=o.data?{model:o.data}:{}),n.emulateHTTP&&("PUT"===s||"DELETE"===s||"PATCH"===s)){o.type="POST",n.emulateJSON&&(o.data._method=s);var a=n.beforeSend;n.beforeSend=function(t){return t.setRequestHeader("X-HTTP-Method-Override",s),a?a.apply(this,arguments):void 0}}"GET"===o.type||n.emulateJSON||(o.processData=!1),"PATCH"===o.type&&w&&(o.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var l=n.xhr=e.ajax(i.extend(o,n));return r.trigger("request",r,l,n),l};var w=!("undefined"==typeof window||!window.ActiveXObject||window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent),T={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};e.ajax=function(){return e.$.ajax.apply(e.$,arguments)};var k=e.Router=function(t){t||(t={}),t.routes&&(this.routes=t.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},x=/\((.*?)\)/g,S=/(\(\?)?:\w+/g,C=/\*\w+/g,A=/[\-{}\[\]+?.,\\\^$|#\s]/g;i.extend(k.prototype,a,{initialize:function(){},route:function(t,r,n){i.isRegExp(t)||(t=this._routeToRegExp(t)),i.isFunction(r)&&(n=r,r=""),n||(n=this[r]);var s=this;return e.history.route(t,function(i){var o=s._extractParameters(t,i);s.execute(n,o),s.trigger.apply(s,["route:"+r].concat(o)),s.trigger("route",r,o),e.history.trigger("route",s,r,o)}),this},execute:function(t,e){t&&t.apply(this,e)},navigate:function(t,i){return e.history.navigate(t,i),this},_bindRoutes:function(){if(this.routes){this.routes=i.result(this,"routes");for(var t,e=i.keys(this.routes);null!=(t=e.pop());)this.route(t,this.routes[t])}},_routeToRegExp:function(t){return t=t.replace(A,"\\$&").replace(x,"(?:$1)?").replace(S,function(t,e){return e?t:"([^/?]+)"}).replace(C,"([^?]*?)"),new RegExp("^"+t+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(t,e){var r=t.exec(e).slice(1);return i.map(r,function(t,e){return e===r.length-1?t||null:t?decodeURIComponent(t):null})}});var E=e.History=function(){this.handlers=[],i.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},M=/^[#\/]|\s+$/g,O=/^\/+|\/+$/g,I=/msie [\w.]+/,P=/\/$/,j=/#.*$/;E.started=!1,i.extend(E.prototype,a,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root},getHash:function(t){var e=(t||this).location.href.match(/#(.*)$/);return e?e[1]:""},getFragment:function(t,e){if(null==t)if(this._hasPushState||!this._wantsHashChange||e){t=decodeURI(this.location.pathname+this.location.search);var i=this.root.replace(P,"");t.indexOf(i)||(t=t.slice(i.length))}else t=this.getHash();return t.replace(M,"")},start:function(t){if(E.started)throw new Error("Backbone.history has already been started");E.started=!0,this.options=i.extend({root:"/"},this.options,t),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var r=this.getFragment(),n=document.documentMode,s=I.exec(navigator.userAgent.toLowerCase())&&(!n||7>=n);if(this.root=("/"+this.root+"/").replace(O,"/"),s&&this._wantsHashChange){var o=e.$('<iframe src="javascript:0" tabindex="-1">');this.iframe=o.hide().appendTo("body")[0].contentWindow,this.navigate(r)}this._hasPushState?e.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!s?e.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=r;var a=this.location;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot())return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+"#"+this.fragment),!0;this._hasPushState&&this.atRoot()&&a.hash&&(this.fragment=this.getHash().replace(M,""),this.history.replaceState({},document.title,this.root+this.fragment))}return this.options.silent?void 0:this.loadUrl()},stop:function(){e.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),E.started=!1},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(t){var e=this.getFragment();return e===this.fragment&&this.iframe&&(e=this.getFragment(this.getHash(this.iframe))),e===this.fragment?!1:(this.iframe&&this.navigate(e),void this.loadUrl())},loadUrl:function(t){return t=this.fragment=this.getFragment(t),i.any(this.handlers,function(e){return e.route.test(t)?(e.callback(t),!0):void 0})},navigate:function(t,e){if(!E.started)return!1;e&&e!==!0||(e={trigger:!!e});var i=this.root+(t=this.getFragment(t||""));if(t=t.replace(j,""),this.fragment!==t){if(this.fragment=t,""===t&&"/"!==i&&(i=i.slice(0,-1)),this._hasPushState)this.history[e.replace?"replaceState":"pushState"]({},document.title,i);else{if(!this._wantsHashChange)return this.location.assign(i);this._updateHash(this.location,t,e.replace),this.iframe&&t!==this.getFragment(this.getHash(this.iframe))&&(e.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,t,e.replace))}return e.trigger?this.loadUrl(t):void 0}},_updateHash:function(t,e,i){if(i){var r=t.href.replace(/(javascript:|#).*$/,"");t.replace(r+"#"+e)}else t.hash="#"+e}}),e.history=new E;var U=function(t,e){var r,n=this;r=t&&i.has(t,"constructor")?t.constructor:function(){return n.apply(this,arguments)},i.extend(r,n,e);var s=function(){this.constructor=r};return s.prototype=n.prototype,r.prototype=new s,t&&i.extend(r.prototype,t),r.__super__=n.prototype,r};h.extend=f.extend=k.extend=v.extend=E.extend=U;var F=function(){throw new Error('A "url" property or function must be specified')},N=function(t,e){var i=e.error;e.error=function(r){i&&i(t,r,e),t.trigger("error",t,r,e)}};return e}),r("aeris/events",["aeris/util","backbone"],function(t,e){var i=function(){};return t.extend(i.prototype,e.Events),i.prototype.eachEventHash_=function(e,i,r){r||(r=this),t.each(e,function(e,n){e=t.isArray(e)?e:[e],t.each(e,function(e){e=t.isFunction(this[e])?this[e]:e,i.call(r,n,e)},this)},this)},i.prototype.on=function(i,r){t.isObject(i)?this.eachEventHash_(i,function(t,i){e.Events.on.call(this,t,i,r)},this):e.Events.on.apply(this,arguments)},i.prototype.off=function(i,r,n){t.isObject(i)?(n=arguments[1],this.eachEventHash_(i,function(t,i){e.Events.off.call(this,t,i,n)},this)):e.Events.off.apply(this,arguments)},i.prototype.proxyEvents=function(t,e,i){var r=t.trigger,n=e||function(t,e){return{topic:t,args:e}},s=i||this;t.trigger=function(e,i){var o=Array.prototype.slice.call(arguments,1),a=n.call(s,e,o),l=[a.topic].concat(a.args);r.apply(t,arguments),this.trigger.apply(s,l)},t.trigger=t.trigger.bind(this)},i.prototype.removeProxy=function(){this.trigger=function(){i.prototype.trigger.apply(this,arguments)},this.trigger=this.trigger.bind(this)},i.hub=new i,i.publish=function(){i.hub.trigger.apply(i.hub,arguments)},i.subscribe=function(){i.hub.on.apply(i.hub,arguments)},i.unsubscribe=function(){i.hub.off.apply(i.hub,arguments)},t.expose(i,"aeris.Events")}),r("aeris/errors/abstracterror",["aeris/util"],function(t){var e=function(t){try{window.Error.call(this),Error.captureStackTrace(this,e)}catch(i){}this.name=this.setName(),this.message=this.setMessage.apply(this,arguments)};try{t.inherits(e,window.Error)}catch(i){}return e.prototype.setName=function(){throw"UnimplementedMethodError: Classes extending from AbstractError must implement setName method"},e.prototype.setMessage=function(t){return t},e.prototype.toString=function(){return this.name+": "+this.message},t.expose(e,"aeris.errors.AbstractError")}),r("aeris/errors/errortypefactory",["aeris/util","aeris/errors/abstracterror"],function(t,e){var i=function(i){var r;return t.defaults(i,{type:e}),this.ParentType_=i.type,r=this.initializeType_(),r.prototype.setName=function(){return i.name},r.prototype.setMessage=function(){var t=i.message||function(t){return t};return t.apply(this,arguments)},r};return i.prototype.initializeType_=function(){var e=this.ParentType_,i=function(t){e.apply(this,arguments)};return t.inherits(i,e),i},i}),r("aeris/errors/validationerror",["aeris/errors/errortypefactory"],function(t){return new t({name:"ValidationError",message:function(t,e){return e?"Invalid model attribute '"+t+"': "+e+".":"Model failed to pass validation: "+t}})}),r("aeris/model",["aeris/util","backbone","aeris/events","aeris/errors/validationerror"],function(t,e,i,r){var n=function(r,n){var s=t.defaults(n||{},{validate:!1}),o=t.omit(s,"validate");this.idAttribute=s.idAttribute||"id",this.defaults=this.defaults||s.defaults,this.options_=n||{},e.Model.call(this,r,o),i.call(this),this.on("invalid",this.onValidationError_,this),s.validate&&this.isValid()};return t.inherits(n,e.Model),t.extend(n.prototype,i.prototype),n.prototype.onValidationError_=function(t,e){throw e=e instanceof Error?e:new r(e)},n.prototype.set=function(i,r,n){var s;if(t.isString(i)?(s={})[i]=r:(s=i,n=r),s=this.normalize_(s),!s)throw Error("Invalid model attributes. Make sure that Model#normalize_ is returning an object.");return e.Model.prototype.set.call(this,s,n)},n.prototype.normalize_=function(t){return t},n.prototype.getAtPath=function(e){var i=e.split("."),r=i.splice(0,1)[0],n=this.get(r);return i.length?t.path(i.join("."),n):n},n.prototype.clone=function(e,i){var r=t.extend({},this.attributes,e),n=t.extend({},this.options_,i);return new this.constructor(r,n)},n.prototype.bindAttributesTo=function(t,e){var i=this.updateWithAttributesOf_.bind(this,t,e),r=e.map(function(t){return"change:"+t});i(),this.listenTo(t,r.join(" "),i)},n.prototype.updateWithAttributesOf_=function(t,e){var i=e.reduce(function(e,i){return e[i]=t.get(i),e},{});this.set(i,{validate:!0})},n}),r("aeris/errors/invalidargumenterror",["aeris/errors/errortypefactory"],function(t){return new t({name:"InvalidArgumentError"})}),r("aeris/viewmodel",["aeris/util","aeris/model","aeris/errors/invalidargumenterror"],function(t,e,i){var r=function(i,r){var n=t.defaults(r||{},{data:new e,attributeTransforms:this.attributeTransforms});this.data_=n.data,this.attributeTransforms_=n.attributeTransforms,e.call(this,i,n),this.listenTo(this.data_,{change:this.syncToModel}),this.syncToModel()};return t.inherits(r,e),r.prototype.syncToModel=function(){var e={};t.each(this.attributeTransforms_,function(t,i){e[i]=t.call(this)},this),this.set(e,{validate:!0})},r.prototype.getData=function(t){return t?this.getDataAttribute(t):this.data_},r.prototype.getDataAttribute=function(e){var r,n,s;if(t.isUndefined(e))throw new i("Unable to get data attribute "+e);return r=e.split("."),n=this.data_.get(r[0]),s=r.slice(1).join("."),s?t.path(s,n):n},r.prototype.fetchData=function(t){return this.data_.fetch(t)},r.prototype.destroy=function(){this.stopListening(this.data_)},r}),r("aeris/promise",["aeris/util","aeris/errors/invalidargumenterror"],function(t,e){var i=function(){this.state="pending",this.arguments_=null,this.deferred_={resolved:[],rejected:[]},this.resolve=this.resolve.bind(this),this.reject=this.reject.bind(this)};return i.prototype.done=function(t,e){return this.bindCallbackToState_("resolved",t,e),this},i.prototype.fail=function(t,e){return this.bindCallbackToState_("rejected",t,e),this},i.prototype.always=function(t,e){return this.done(t,e),this.fail(t,e),this},i.prototype.bindCallbackToState_=function(i,r,n){if(!t.isFunction(r))throw new e("Invalid '"+i+"' state callback.");this.state===i?r.apply(n,this.arguments_):this.deferred_[i].push([r,n])},i.prototype.resolve=function(t){this.adoptState_("resolved",arguments)},i.prototype.reject=function(t){this.adoptState_("rejected",arguments)},i.prototype.adoptState_=function(t,e){var i,r;if("rejected"!==t&&"resolved"!==t)throw new Error("Invalid promise state: '"+t+"'. +Valid states are 'resolved' and 'rejected'");if("pending"===this.state){this.state=t,this.arguments_=e,r=this.deferred_[this.state],i=r.length;for(var n=0;i>n;n++){var s=r[n][0],o=r[n][1];s.apply(o,this.arguments_)}for(var a in this.deferred_)this.deferred_.hasOwnProperty(a)&&(this.deferred_[a]=[])}},i.prototype.getState=function(){return this.state},i.prototype.proxy=function(t){return t.done(this.resolve).fail(this.reject),this},i.when=function(r){var n=Array.prototype.slice.call(arguments),s=new i,o=[],a=0;return 1===n.length&&n[0]instanceof Array&&(n=n[0]),n.forEach(function(r,l){if(!(r instanceof i))throw new e("Unable to create master promise: "+r.toString()+" is not a valid Promise object");r.fail(function(){s.reject.apply(s,arguments)}),r.done(function(){var e=t.argsToArray(arguments);o[l]=e,a++,a===n.length&&s.resolve.apply(s,o)})},this),0===n.length&&s.resolve(),s},i.sequence=function(e,r){var n=new i,s=[],o=n.reject.bind(n),a=n.resolve.bind(n,s),l=function(n){var u=t.partial(l,n+1),c=e[n];c?i.callPromiseFn_(r,c).done(function(t){s.push(t),u()}).fail(o):a()};return l(0),n},i.callPromiseFn_=function(t,r){var n=Array.prototype.slice.call(arguments,1),s=t.apply(null,n);if(!(s instanceof i))throw new e("Promise.sequence expects the promiseFn argument to return an aeris.Promise object.");return s},i.map=function(t,e,r){return i.when(t.map(e,r))},i.resolve=function(t){var e=new i;return e.resolve(t),e},t.expose(i,"aeris.Promise")}),r("aeris/maps/extensions/strategyobject",["aeris/util","aeris/events","aeris/promise","aeris/errors/invalidargumenterror"],function(t,e,i,r){var n=function(i){var r=t.defaults(i||{},{strategy:null});this.strategy_=null,this.StrategyType_=r.strategy,e.call(this),t.isNull(this.StrategyType_)||this.setStrategy(this.StrategyType_)};return t.extend(n.prototype,e.prototype),n.prototype.setStrategy=function(e){if(this.strategy_&&this.removeStrategy(),!t.isFunction(e))throw new r("Unable to set StrategyObject strategy: invalid strategy constructor.");this.StrategyType_=e,this.strategy_=this.createStrategy_(e),this.trigger("strategy:set",this.strategy_)},n.prototype.createStrategy_=function(t){return new t(this)},n.prototype.removeStrategy=function(){this.strategy_&&(this.strategy_.destroy(),this.strategy_=null)},n.prototype.resetStrategy=function(){if(!this.StrategyType_)throw new Error("Unable to reset strategy: no strategy has yet been defined");this.setStrategy(this.StrategyType_)},n}),r("aeris/maps/extensions/mapextensionobject",["aeris/util","aeris/errors/validationerror","aeris/viewmodel","aeris/maps/extensions/strategyobject","aeris/promise"],function(t,e,i,r,n){var s=function(e,n){var s=t.defaults(e||{},{map:null});i.call(this,s,n),r.call(this,t.pick(n||{},"strategy")),this.listenTo(this,{"change:map":function(t,e,i){var r=this.hasMap()?"map:set":"map:remove";this.trigger(r,t,e,i)}})};return t.inherits(s,i),t.extend(s.prototype,r.prototype),s.prototype.validate=function(t){return null===t.map||t.map instanceof aeris.maps.Map?void 0:new e("Aeris Map","Invalid map object")},s.prototype.setMap=function(e,i){var r=t.defaults(i||{},{validate:!0});this.set("map",e,r)},s.prototype.getMap=function(){return this.get("map")},s.prototype.hasMap=function(){return this.has("map")},s.prototype.getView=function(){if(!this.strategy_)throw new Error("Unable to get MapExtensionObject view: no strategy is available for this object.");return this.strategy_.getView()},s.prototype.destroy=function(){this.stopListening(),this.removeStrategy()},s}),r("aeris/maps/abstractstrategy",["aeris/util","aeris/events"],function(t,e){var i=function(i){this.object_=i,this.mapView_,this.objectEvents_=t.extend({},this.objectEvents_,{"map:set":function(t,e){this.setMap(e)},"map:remove":this.remove}),e.call(this),this.view_=this.createView_(),this.listenTo(this.object_,this.objectEvents_),this.object_.hasMap()&&this.setMap(this.object_.getMap())};return t.extend(i.prototype,e.prototype),i.prototype.setMap=function(t){this.mapView_&&this.remove(),this.mapView_=t.getView()},i.prototype.remove=function(){this.mapView_&&(this.beforeRemove_(),this.mapView_=null,this.afterRemove_())},i.prototype.destroy=function(){this.stopListening(),this.remove()},i.prototype.beforeRemove_=t.abstractMethod,i.prototype.afterRemove_=function(){},i.prototype.createView_=t.abstractMethod,i.prototype.getView=function(){return this.view_},i}),r("aeris/errors/unimplementedpropertyerror",["aeris/errors/errortypefactory"],function(t){return new t({name:"UnimplementedPropertyError",message:function(t){return t?"Abstract property "+t+" has not been implemented":"Abstract property has not been implemented"}})}),r("aeris/maps/layers/errors/layerloadingerror",["aeris/errors/errortypefactory"],function(t){return new t({name:"LayerLoadingError"})}),r("aeris/maps/layers/layer",["aeris/util","aeris/maps/extensions/mapextensionobject"],function(t,e){var i=function(){e.apply(this,arguments)};return t.inherits(i,e),i}),r("aeris/maps/layers/animationlayer",["aeris/util","aeris/maps/layers/layer"],function(t,e){var i=function(i,r){var n=t.extend({autoUpdateInterval:6e4},i);e.call(this,n,r)};return t.inherits(i,e),i.prototype.fadeTo=function(e,i){var r=this.get("opacity")>e?-1:1,n=Math.abs(this.get("opacity")-e),s=13,o=i/s,a=n/o;this.stop(),this.animationClock_=window.setInterval(t.bind(function(){var t=this.get("opacity")+a*r;return 0>t||t>1?(this.setOpacity(e),void window.clearInterval(this.animationClock_)):(this.setOpacity(t),void((-1===r&&this.get("opacity")<=e||1===r&&this.get("opacity")>=e)&&window.clearInterval(this.animationClock_)))},this),s)},i.prototype.fadeOut=function(t){this.fadeTo(0,t)},i.prototype.fadeIn=function(t){this.fadeTo(1,t)},i.prototype.stop=function(){return this.animationClock_&&window.clearInterval(this.animationClock_),this},i.prototype.show=function(){this.setOpacity(1)},i.prototype.hide=function(){this.setOpacity(0)},i}),r("leaflet",[],function(){return window.L}),r("aeris/maps/strategy/layers/tile",["aeris/util","aeris/maps/abstractstrategy","leaflet"],function(t,e,i){var r=function(t){e.call(this,t),this.proxyLoadEvents_(),this.bindLayerAttributes_()};return t.inherits(r,e),r.prototype.createView_=function(){var t=new i.TileLayer(this.getTileUrl_(),{subdomains:this.object_.get("subdomains"),minZoom:this.object_.get("minZoom"),maxZoom:this.object_.get("maxZoom"),opacity:this.object_.get("opacity"),zIndex:this.object_.get("zIndex"),attribution:this.getOSMAttribution_()});return t},r.prototype.setMap=function(t){e.prototype.setMap.call(this,t),this.view_.addTo(t.getView())},r.prototype.beforeRemove_=function(){this.mapView_.removeLayer(this.view_)},r.prototype.getTileUrl_=function(){return this.object_.getUrl().replace("{d}","{s}")},r.prototype.getOSMAttribution_=function(){return'<a href="https://www.openstreetmap.org/copyright" target="_blank">&copy OpenStreetMap contributors</a>'},r.prototype.proxyLoadEvents_=function(){var t=this.object_.trigger.bind(this.object_,"load:reset"),e={loading:t},i=function(){var t=this.mapView_;this.mapView_.addEventListener(e,this),this.once("map:remove",function(){t.removeEventListener(e,this)})}.bind(this);this.view_.addEventListener({load:function(){this.object_.trigger("load")}},this),this.listenTo(this.object_,{"map:set":i}),this.object_.hasMap()&&i()},r.prototype.bindLayerAttributes_=function(){this.listenTo(this.object_,{"change:opacity":function(){this.view_.setOpacity(this.object_.get("opacity"))},"change:zIndex":function(){this.view_.setZIndex(this.object_.get("zIndex"))}})},r.prototype.destroy=function(){this.view_.clearAllEventListeners(),e.prototype.destroy.call(this),this.view_=null},r}),r("aeris/maps/layers/abstracttile",["aeris/util","aeris/promise","aeris/events","aeris/errors/unimplementedpropertyerror","aeris/errors/validationerror","aeris/maps/layers/errors/layerloadingerror","aeris/maps/layers/animationlayer","aeris/maps/strategy/layers/tile"],function(t,e,i,r,n,s,o,a){var l=function(e,i){var r=t.extend({strategy:a,validate:!0},i),n=t.extend({subdomains:[],name:void 0,server:void 0,minZoom:0,maxZoom:22,opacity:1,zIndex:1},e);this.listenTo(this,{load:function(){this.loaded_=!0},"load:reset":function(){this.loaded_=!1}}),o.call(this,n,r)};return t.inherits(l,o),l.prototype.validate=function(e){return t.isString(e.server)?!t.isNumber(e.opacity)||e.opacity>1||e.opacity<0?new n("opacity","must be a number between 0 and 1"):o.prototype.validate.apply(this,arguments):new n("server","not a valid string")},l.prototype.getUrl=t.abstractMethod,l.prototype.getRandomSubdomain=function(){var t=Math.floor(Math.random()*this.get("subdomains").length);return this.get("subdomains")[t]},l.prototype.zoomFactor=function(t){return t},l.prototype.setOpacity=function(t){this.set("opacity",t,{validate:!0})},l.prototype.getOpacity=function(){return this.get("opacity")},l.prototype.setZIndex=function(t){this.set("zIndex",t,{validate:!0})},l.prototype.getZIndex=function(){return this.get("zIndex")},l.prototype.isLoaded=function(){return!!this.loaded_},l.prototype.preload=function(t){if(this.isPreloading_||this.isLoaded())return e.resolve();this.isPreloading_=!0;var r=new e,n=this.pick(["opacity"]),o=new i;return this.isLoaded()?(r.resolve(),r):t?(this.listenToOnce(this,"load",function(){o.stopListening(),o.off(),this.hasMap()?this.strategy_.setMap(this.getMap()):this.strategy_.remove(),this.set(n),this.isPreloading_=!1,r.resolve()}),this.set({opacity:0}),this.strategy_.setMap(t),o.listenTo(this,{"change:opacity":function(t,e){n.opacity=e}}),r):(this.isPreloading_=!1,r.reject(new s("Unable to preload Tile: no map has been specified.")),r)},l}),r("aeris/maps/strategy/layers/osm",["aeris/maps/strategy/layers/tile"],function(t){return t}),r("aeris/maps/layers/osm",["aeris/util","aeris/maps/layers/abstracttile","aeris/maps/strategy/layers/osm"],function(t,e,i){var r=function(r,n){var s=t.extend({strategy:i},n),o=t.extend({name:"OpenStreetMap",subdomains:["a","b","c"],server:"https://{d}.tile.openstreetmap.org",maxZoom:18},r);e.call(this,o,s)};return t.inherits(r,e),r.prototype.getUrl=function(){return this.get("server")+"/{z}/{x}/{y}.png"},t.expose(r,"aeris.maps.layers.OSM")}),r("aeris/maps/strategy/util",["aeris/util","leaflet"],function(t,e){var i={toAerisLatLon:function(t){var e=t.wrap();return[e.lat,e.lng]},toAerisBounds:function(t){var e=t.getSouthWest(),r=t.getNorthEast();return[i.toAerisLatLon(e),i.toAerisLatLon(r)]},toLeafletLatLng:function(t){return new e.LatLng(t[0],t[1])},toLeafletBounds:function(t){var i=new e.LatLng(t[0][0],t[0][1]),r=new e.LatLng(t[1][0],t[1][1]);return new e.LatLngBounds(i,r)}};return i}),r("aeris/maps/strategy/map",["aeris/util","aeris/maps/abstractstrategy","aeris/maps/layers/osm","aeris/maps/strategy/util","leaflet"],function(t,e,i,r,n){var s=function(t){e.call(this,t),this.ensureBaseLayer_(),this.updateObjectFromView_(),this.updateLeafletMapPosition_(),this.proxyLeafletMapEvents_(),this.bindToLeafletMapState_(),this.updateSizeWhenCanasAddedToDOM_()};t.inherits(s,e),s.prototype.createView_=function(){var t,e=this.object_.getElement();return e instanceof n.Map?e:t=new n.Map(e,{center:r.toLeafletLatLng(this.object_.getCenter()),zoom:this.object_.getZoom(),scrollWheelZoom:this.object_.get("scrollZoom")})},s.prototype.ensureBaseLayer_=function(){var t=this.object_.getBaseLayer();t||(t=new s.DEFAULT_BASE_LAYER_TYPE_,this.object_.setBaseLayer(t)),this.getLayerCount_()||this.renderBaseLayer_(t)},s.DEFAULT_BASE_LAYER_TYPE_=i,s.prototype.getLayerCount_=function(){var t=0;return this.view_.eachLayer(function(){t++}),t},s.prototype.updateLeafletMapPosition_=function(){this.view_.setView(this.object_.getCenter(),this.object_.getZoom())},s.prototype.proxyLeafletMapEvents_=function(){this.proxyLeafletMouseEvent_("click"),this.proxyLeafletMouseEvent_("dblclick"),this.view_.addEventListener({load:function(){this.object_.trigger("load")}.bind(this)})},s.prototype.proxyLeafletMouseEvent_=function(t,e){var i=e||t;this.view_.addEventListener(t,function(t){var e=r.toAerisLatLon(t.latlng);this.object_.trigger(i,e)}.bind(this))},s.prototype.bindToLeafletMapState_=function(){this.view_.addEventListener({moveend:this.updateObjectFromView_.bind(this)}),this.listenTo(this.object_,{"change:center change:zoom":this.updateLeafletMapPosition_,"change:baseLayer":this.updateBaseLayer_,updateSize:this.updateSize_})},s.prototype.updateObjectFromView_=function(){this.object_.set({center:r.toAerisLatLon(this.view_.getCenter()),bounds:r.toAerisBounds(this.view_.getBounds()),zoom:this.view_.getZoom(),scrollZoom:this.view_.options.scrollWheelZoom},{validate:!0})},s.prototype.updateBaseLayer_=function(){var t=this.object_.getBaseLayer(),e=this.object_.previousAttributes().baseLayer,i=t===e;i||(e&&(this.view_.removeLayer(e.getView()),e.set("map",null,{silent:!0})),this.renderBaseLayer_(t))},s.prototype.renderBaseLayer_=function(t){this.view_.addLayer(t.getView(),!0),t.set("map",this.object_,{silent:!0})},s.prototype.fitToBounds=function(t){this.view_.fitBounds(r.toLeafletBounds(t))},s.prototype.updateSizeWhenCanasAddedToDOM_=function(){function t(t,e,i){var r,n=function(){t()&&(e(),o.clearInterval(r))};r=o.setInterval(n,i),n()}var e=this.object_.mapEl_,i=function(){return 0!==e.offsetWidth&&0!==e.offsetHeight};t(i,this.updateSize_.bind(this),100)},s.prototype.updateSize_=function(){this.getView().invalidateSize()};var o=this;return s}),r("aeris/maps/map",["aeris/util","aeris/events","aeris/errors/validationerror","aeris/maps/extensions/mapextensionobject","aeris/maps/strategy/map"],function(t,e,i,r,n){var s=function(i,s,o){var a=t.extend({center:[45,-90],bounds:[[22.43,-135.52],[52.37,-55.016]],zoom:4,scrollZoom:!0,baseLayer:null},s),l=t.extend({strategy:n,validate:!0},o);this.mapEl_=this.normalizeElement_(i),this.validateElementExists_(this.mapEl_),e.call(this),r.call(this,a,l)};return t.inherits(s,r),t.extend(s.prototype,e.prototype),s.prototype.validate=function(e){return t.isArray(e.center)?t.isNumber(e.zoom)?void 0:new i("zoom",e.zoom+" is not a valid zoom level"):new i("center",e.center+" is not a valid coordinate")},s.prototype.setBounds=function(t){this.set("bounds",t,{validate:!0})},s.prototype.getBounds=function(){return this.get("bounds")},s.prototype.getView=function(){return this.strategy_.getView()},s.prototype.setCenter=function(t){this.set("center",t,{validate:!0})},s.prototype.getCenter=function(){return this.get("center")},s.prototype.setZoom=function(t){this.set("zoom",t,{validate:!0})},s.prototype.getZoom=function(){return this.get("zoom")},s.prototype.setBaseLayer=function(t){this.set("baseLayer",t,{validate:!0})},s.prototype.getBaseLayer=function(){return this.get("baseLayer")},s.prototype.fitToBounds=function(t){if(!this.strategy_||!this.strategy_.fitToBounds)throw Error("Unable to fit to bounds: no fitToBounds strategy has been implemented");this.strategy_.fitToBounds(t)},s.prototype.normalizeElement_=function(e){return t.isString(e)?document.getElementById(e):e},s.prototype.validateElementExists_=function(t){if(!t)throw new i("el",t+" is not a valid map canvas element or id")},s.prototype.getElement=function(){return this.mapEl_},s.prototype.updateSize=function(){this.trigger("updateSize")},t.expose(s,"aeris.maps.Map")}),r("aeris/maps/animations/animationinterface",["aeris/util","aeris/events"],function(t,e){var i=function(){e.call(this)};return t.extend(i.prototype,e.prototype),i.prototype.preload=t.abstractMethod,i.prototype.start=t.abstractMethod,i.prototype.pause=t.abstractMethod,i.prototype.stop=t.abstractMethod,i.prototype.previous=t.abstractMethod,i.prototype.next=t.abstractMethod,i.prototype.goToTime=t.abstractMethod,i.prototype.getCurrentTime=t.abstractMethod,i.prototype.setFrom=t.abstractMethod,i.prototype.setTo=t.abstractMethod,i.prototype.getFrom=t.abstractMethod,i.prototype.getFrom=t.abstractMethod,i.prototype.isAnimating=t.abstractMethod,i.prototype.hasMap=t.abstractMethod,i}),r("aeris/maps/animations/abstractanimation",["aeris/util","aeris/maps/animations/animationinterface","aeris/errors/invalidargumenterror"],function(t,e,i){var r=function(i){var r=t.defaults(i||{},{from:t.now()-36e5,to:t.now(),limit:20,speed:30,timestep:6e4,endDelay:1e3});this.speed_=r.speed,this.timestep_=r.timestep,this.endDelay_=r.endDelay,this.from_=r.from,this.to_=r.to,this.limit_=r.limit,this.normalizeTimeBounds_(),this.currentTime_=Date.now(),this.animationClock_=null,e.call(this),this.keepCurrentTimeInBounds_()};return t.inherits(r,e),r.prototype.start=function(){var e=25;if(!this.isAnimating()){this.currentTime_===this.to_&&this.goToTime(this.from_);var i=!1;this.animationClock_=t.interval(function(){var t=e/1e3,r=this.timestep_*this.speed_*t,n=this.currentTime_+r;i||(n>this.to_?(i=!0,setTimeout(function(){i=!1,this.isAnimating()&&this.goToTime(this.from_)}.bind(this),this.endDelay_)):this.goToTime(n))},e,this)}},r.prototype.normalizeTimeBounds_=function(){t.isDate(this.from_)&&(this.from_=this.from_.getTime()),t.isDate(this.to_)&&(this.to_=this.to_.getTime())},r.prototype.keepCurrentTimeInBounds_=function(){this.listenTo(this,{"change:to":function(){this.getCurrentTime()>this.getTo()&&this.goToTime(this.getTo())},"change:from":function(){this.getCurrentTime()<this.getFrom()&&this.goToTime(this.getFrom())}})},r.prototype.goToTime=function(e){this.currentTime_=t.isDate(e)?e.getTime():e},r.prototype.getCurrentTime=function(){return new Date(this.currentTime_)},r.prototype.stop=function(){this.pause(),t.isNull(this.to_)||this.goToTime(this.to_)},r.prototype.pause=function(){window.clearInterval(this.animationClock_),this.animationClock_=null},r.prototype.setSpeed=function(e){if(e!==this.speed_){if(!t.isNumber(e))throw new i(e+" is not a valid animation speed.");this.speed_=e,this.isAnimating()&&(this.pause(),this.start())}},r.prototype.setTimestep=function(t){t!==this.timestep_&&(this.timestep_=t,this.isAnimating()&&(this.pause(),this.start()))},r.prototype.setFrom=function(t){var e;t instanceof Date&&(t=t.getTime()),e=t===this.from_,e||(this.from_=t,this.trigger("change:from",new Date(this.from_)))},r.prototype.getFrom=function(){return new Date(this.from_)},r.prototype.setTo=function(t){var e;t instanceof Date&&(t=t.getTime()),e=t===this.to_,e||(this.to_=t,this.trigger("change:to",new Date(this.to_)))},r.prototype.getTo=function(){return new Date(this.to_)},r.prototype.isAnimating=function(){return t.isNumber(this.animationClock_)},r}),r("aeris/util/findclosest",["aeris/util"],function(t){function e(t,e){return Math.abs(t-e)}function i(t,i,r){var n=e(t,r),s=e(i,r);return n>s}return function(e,r){var n=t.clone(r).sort(function(t,r){var n=i(t,r,e);return n?1:-1});return n[0]}}),r("aeris/maps/animations/tileanimation",["aeris/util","aeris/maps/animations/abstractanimation","aeris/promise","aeris/errors/invalidargumenterror","aeris/util/findclosest"],function(t,e,i,r,n){function s(e,i,r){var n=i-e,s=6e4,o=Math.max(Math.floor(n/r),s);return t.range(e,i,o)}var o=function(t,i){var r=i||{};e.call(this,r),this.masterLayer_=t,this.currentLayer_=null,this.layersByTime_={},this.times_=[],this.masterLayer_.removeStrategy(),this.loadAnimationLayers(),this.listenTo(this,"change:to change:from",function(){this.loadAnimationLayers()}),this.listenTo(this.masterLayer_,"map:set",function(){this.preloadLayer_(this.getCurrentLayer())})};return t.inherits(o,e),o.DEFAULT_TIME_TOLERANCE_=72e5,o.prototype.loadAnimationLayers=function(){var e=this.getCurrentTime(),i=this.layersByTime_,r=s(this.from_,this.to_,this.limit_),n=r.reduce(function(t,e){return t[e]=this.masterLayer_.clone({time:new Date(e),map:null,autoUpdate:!1}),t}.bind(this),{}),o=this.getClosestTime_(e,r),a=n[o];this.times_=r,this.layersByTime_=n,this.bindLayerLoadEvents_(),
this.trigger("load:times",this.times_.slice(0));var l=function(){this.goToTime(this.getCurrentTime()),t.each(i,function(t){t.destroy()})}.bind(this);this.getCurrentLayer()?this.preloadLayer_(a).always(function(){setTimeout(l,1e3)},this):l()},o.prototype.bindLayerLoadEvents_=function(){var e=t.debounce(function(){this.trigger("load:reset",this.getLoadProgress())}.bind(this),15),i=function(){var t=this.getLoadProgress();1===t&&this.trigger("load:complete",t),this.trigger("load:progress",t)}.bind(this);t.each(this.layersByTime_,function(t){t.on({load:i,"load:reset":e})}.bind(this))},o.prototype.preload=function(){var e=new i,r=t.values(this.layersByTime_),n=[this.getCurrentLayer()].concat(t.shuffle(r));return i.map(n,this.preloadLayer_,this).done(e.resolve).fail(e.reject),e},o.prototype.preloadLayer_=function(t){var e=new i,r=function(){t.set({map:this.masterLayer_.getMap(),opacity:t===this.getCurrentLayer()?this.masterLayer_.getOpacity():0}),t.once("load",e.resolve),setTimeout(function(){"pending"===e.getState()&&t.trigger("load")}.bind(this),2e3)}.bind(this);return this.lastPromiseToPreload_||(this.lastPromiseToPreload_=i.resolve()),this.lastPromiseToPreload_.always(function(){t.isLoaded()?e.resolve():this.masterLayer_.getMap()?r():this.masterLayer_.once("map:set",r)},this),this.lastPromiseToPreload_=e,e},o.prototype.refreshCurrentLayer_=function(){this.goToTime(this.getCurrentTime())},o.prototype.start=function(){e.prototype.start.call(this),this.preload()},o.prototype.next=function(){var t=this.getNextTime_();t&&this.goToTime(t)},o.prototype.previous=function(){var t=this.getPreviousTime_();t&&this.goToTime(t)},o.prototype.goToTime=function(e){var i,n,s=!!this.getTimes().length;if(e=t.isDate(e)?e.getTime():e,!t.isNumeric(e))throw new r("Invalid animation time: time must be a Date or a timestamp (number).");n=this.getCurrentLayer(),i=this.getLayerForTimeInSameTense_(e)||null,this.currentTime_=e,i!==n&&(s||this.listenToOnce(this,"load:times",function(){this.goToTime(this.getCurrentTime())}),i?this.transition_(n,i):n&&this.transitionOut_(n),this.currentLayer_=i,this.trigger("change:time",new Date(this.currentTime_)))},o.prototype.getLoadProgress=function(){var e=t.keys(this.layersByTime_).length,i=0;return e?(t.each(this.layersByTime_,function(t){t.isLoaded()&&i++},0),Math.min(i/e,1)):0},o.prototype.hasMap=function(){return this.masterLayer_.hasMap()},o.prototype.destroy=function(){t.invoke(this.layersByTime_,"destroy"),this.layersByTime_={},this.times_.length=0,this.stopListening(),this.masterLayer_.resetStrategy()},o.prototype.getTimes=function(){return t.clone(this.times_)},o.prototype.getLayerForTimeInSameTense_=function(t){return this.layersByTime_[this.getClosestTimeInSameTense_(t)]},o.prototype.getClosestTime_=function(t,e){var i=e||this.times_;return n(t,i)},o.prototype.getClosestTimeInSameTense_=function(t,e){var i=t>Date.now(),r=e||this.times_,s=r.filter(function(t){var e=t>Date.now(),r=e&&i||!e&&!i;return r});return n(t,s)},o.prototype.transition_=function(e,i){i.isLoaded()||(this.preloadLayer_(i),this.transitionWhenLoaded_(e,i)),t.without(this.layersByTime_,i).forEach(this.transitionOut_,this),this.transitionInClosestLoadedLayer_(i)},o.prototype.transitionIn_=function(t){this.syncLayerToMaster_(t)},o.prototype.transitionOut_=function(t){t.stopListening(this.masterLayer_),t.setOpacity(0)},o.prototype.transitionWhenLoaded_=function(t,e){this.stopListening(e,"load"),this.listenToOnce(e,"load",function(){this.getCurrentLayer()===e&&this.transition_(t,e)})},o.prototype.transitionInClosestLoadedLayer_=function(e){var i=t.keys(this.layersByTime_).filter(function(t){return this.layersByTime_[t].isLoaded()},this),r=this.getClosestTimeInSameTense_(e.get("time").getTime(),i);r&&this.transitionIn_(this.layersByTime_[r])},o.prototype.syncLayerToMaster_=function(t){var e=["map","opacity","zIndex"];t.stopListening(this.masterLayer_),t.bindAttributesTo(this.masterLayer_,e)},o.prototype.getCurrentLayer=function(){return this.currentLayer_},o.prototype.getNextTime_=function(){return this.isCurrentLayerLast_()?this.times_[0]:this.times_[this.getLayerIndex_()+1]},o.prototype.getPreviousTime_=function(){var e=t.last(this.times_);return this.isCurrentLayerFirst_()?e:this.times_[this.getLayerIndex_()-1]},o.prototype.isCurrentLayer_=function(t){return t===this.getCurrentLayer()},o.prototype.isCurrentLayerFirst_=function(){return 0===this.getLayerIndex_()},o.prototype.isCurrentLayerLast_=function(){return this.getLayerIndex_()===this.times_.length-1},o.prototype.getLayerIndex_=function(t){return t||(t=this.getCurrentLayer()),this.times_.indexOf(t.get("time").getTime())},t.expose(o,"aeris.maps.animations.TileAnimation")}),r("aeris/maps/animations/autoupdateanimation",["aeris/util","aeris/maps/animations/tileanimation"],function(t,e){var i=function(t,i){e.call(this,t,i),this.bindToLayerAutoUpdate_()};return t.inherits(i,e),i.prototype.bindToLayerAutoUpdate_=function(){var t=this.masterLayer_.get("autoUpdateInterval");this.listenTo(this.masterLayer_,"autoUpdate",function(){this.setTo(this.to_+t),this.setFrom(this.from_+t),this.listenToOnce(this,"load:times",function(){this.trigger("autoUpdate",this)}),this.loadAnimationLayers()})},i}),r("aeris/maps/animations/animationsync",["aeris/util","aeris/maps/animations/abstractanimation","aeris/maps/layers/animationlayer","aeris/maps/animations/autoupdateanimation","aeris/promise"],function(t,e,i,r,n){var s=function(i,n){var s=t.defaults(n||{},{AnimationType:r});e.call(this,n),this.options_={to:this.to_,from:this.from_,limit:this.limit_,timeTolerance:s.timeTolerance},this.animations_=[],this.AnimationType_=s.AnimationType,this.animationsWhichHaveLoadedTimes_=[],this.add(i||[]),this.listenTo(this,{"change:to change:from":function(){this.animations_.forEach(function(t){t.setTo(this.getTo()),t.setFrom(this.getFrom())},this)}})};return t.inherits(s,e),s.prototype.preload=function(){var t=this.animations_.filter(function(t){return t.hasMap()});return n.sequence(t,function(t){return t.preload()})},s.prototype.add=function(e){var r;e=t.isArray(e)?e:[e],r=e.map(function(e){var r=e instanceof i,n=t.extend({},this.options_,{to:this.getTo(),from:this.getFrom(),limit:this.limit_});return r?new this.AnimationType_(e,n):e},this),t.each(r,this.addOne_,this)},s.prototype.addOne_=function(e){e.stop(),this.animations_.push(e),this.listenTo(e,{"load:times":function(){t.contains(this.animationsWhichHaveLoadedTimes_,e)||this.animationsWhichHaveLoadedTimes_.push(e),this.animationsWhichHaveLoadedTimes_.length===this.animations_.length&&this.trigger("load:times",this.getTimes())},"load:progress load:complete":this.triggerLoadProgress_,"load:error":function(t){this.trigger("load:error",t)},"load:reset":function(t){this.trigger("load:reset",t)},autoUpdate:function(t){this.setTo(t.getTo()),this.setFrom(t.getFrom()),this.trigger("autoUpdate")}}),e.setTo(this.getTo()),e.setFrom(this.getFrom()),this.triggerLoadProgress_()},s.prototype.remove=function(e){e=t.isArray(e)?e:[e],t.each(e,this.removeOne_,this)},s.prototype.removeOne_=function(e){this.stopListening(e),this.animations_=t.without(this.animations_,e),e.stop()},s.prototype.triggerLoadProgress_=function(){var t=this.getLoadProgress();return t>=1&&this.trigger("load:complete"),this.trigger("load:progress",t),t},s.prototype.getLoadProgress=function(){var e=this.animations_.filter(function(t){return t.hasMap()}),i=e.map(function(t){return t.getLoadProgress()});return t.average(i)},s.prototype.next=function(t){var e=t||this.timestep_,i=this.getNextTime_(this.currentTime_,e);this.goToTime(i)},s.prototype.getNextTime_=function(t,e){var i=t+e;return t>=this.to_?i=this.from_:i>=this.to_&&(i=this.to_),i},s.prototype.previous=function(t){var e=t||this.timestep_,i=this.getPrevTime_(this.currentTime_,e);this.goToTime(i)},s.prototype.getPrevTime_=function(t,e){var i=t-e;return t<=this.from_?i=this.to_:i<=this.from_&&(i=this.from_),i},s.prototype.goToTime=function(e){this.currentTime_=t.isDate(e)?e.getTime():e,t.each(this.animations_,function(t){t.goToTime(this.currentTime_)},this),this.trigger("change:time",new Date(this.currentTime_))},s.prototype.getTimes=function(){var e=[];return t.each(this.animations_,function(t){e=e.concat(t.getTimes())}),t.sortBy(e,function(t){return t})},t.expose(s,"aeris.maps.animations.AnimationSync")}),r("aeris/packages/animations",["aeris/maps/animations/tileanimation","aeris/maps/animations/animationsync"],function(){}),r("aeris/togglebehavior",["aeris/util"],function(t){var e=function(){};return e.prototype.initialize=function(){this.has("selected")||this.set("selected",!1),this.bindToggleEvents_()},e.prototype.bindToggleEvents_=function(){this.listenTo(this,{"change:selected":function(t,e){var i=e?"select":"deselect";this.trigger(i,t)}})},e.prototype.select=function(){this.set("selected",!0)},e.prototype.deselect=function(){this.set("selected",!1)},e.prototype.toggle=function(){this.set("selected",!this.get("selected"))},e.prototype.isSelected=function(){return this.get("selected")},e}),r("aeris/maps/strategy/markers/marker",["aeris/util","aeris/maps/abstractstrategy","aeris/maps/strategy/util","leaflet"],function(t,e,i,r){var n=function(t){e.call(this,t),this.bindMarkerAttributes_(),this.proxyMarkerEvents_()};return t.inherits(n,e),n.prototype.createView_=function(){var t=i.toLeafletLatLng(this.object_.getPosition());return new r.Marker(t,{icon:this.createIcon_(),clickable:this.object_.get("clickable"),draggable:this.object_.get("draggable"),title:this.object_.get("title"),alt:this.object_.get("title")})},n.prototype.setMap=function(t){e.prototype.setMap.call(this,t),this.view_.addTo(this.mapView_)},n.prototype.beforeRemove_=function(){this.mapView_.removeLayer(this.view_)},n.prototype.createIcon_=function(){return new r.Icon({iconUrl:this.getMarkerUrl_(),iconAnchor:this.createOffsetPoint_()})},n.prototype.createOffsetPoint_=function(){var t=this.object_.isSelected()?[this.object_.get("selectedOffsetX"),this.object_.get("selectedOffsetY")]:[this.object_.get("offsetX"),this.object_.get("offsetY")];return r.point.apply(r.point,t)},n.prototype.getMarkerUrl_=function(){return this.object_.isSelected()?this.object_.getSelectedUrl():this.object_.getUrl()},n.prototype.bindMarkerAttributes_=function(){var t=["change:url","change:offsetX","change:offsetY","change:selectedUrl","change:selectedOffsetX","change:selectedOffsetY","change:selected"],e={"change:position":function(){var t=i.toLeafletLatLng(this.object_.getPosition());this.view_.setLatLng(t)}};e[t.join(" ")]=function(){this.view_.setIcon(this.createIcon_())},this.listenTo(this.object_,e),this.view_.addEventListener({"move dragend":function(){var t=i.toAerisLatLon(this.view_.getLatLng());this.object_.setPosition(t)}},this)},n.prototype.proxyMarkerEvents_=function(){this.view_.addEventListener({click:function(t){var e=i.toAerisLatLon(t.latlng);this.object_.trigger("click",e,this.object_)},dragend:function(){var t=this.object_.getPosition();this.object_.trigger("dragend",t,this.object_)}},this)},n}),r("aeris/maps/markers/marker",["aeris/util","aeris/maps/extensions/mapextensionobject","aeris/togglebehavior","aeris/errors/validationerror","aeris/maps/strategy/markers/marker"],function(t,e,i,r,n){var s=function(r,s){var o=t.defaults(s||{},{strategy:n}),a=t.defaults(r||{},{position:[45,-90],url:"//iwx.aerisapi.com/v1.6/wnmapapp/css/assets/markers/earthquake/quake_mini.png",offsetX:9,offsetY:9,clickable:!0,draggable:!1,title:""});a.selectedUrl||(a.selectedUrl=a.url),a.selectedOffsetX||(a.selectedOffsetX=a.offsetX),a.selectedOffsetY||(a.selectedOffsetY=a.offsetY),e.call(this,a,o),i.call(this)};return t.inherits(s,e),t.extend(s.prototype,i.prototype),s.prototype.validate=function(e){return!e.position||t.isArray(e.position)&&t.isNumber(e.position[0])&&t.isNumber(e.position[1])&&2===e.position.length?t.isString(e.title)?void 0:new r(e.title+" is not a valid marker title."):new r(e.position.toString()+" is not a valid latLon position")},s.prototype.setPosition=function(t){this.set("position",t,{validate:!0})},s.prototype.getPosition=function(){return this.get("position")},s.prototype.setUrl=function(t){this.set("url",t,{validate:!0})},s.prototype.getUrl=function(){return this.get("url")},s.prototype.setSelectedUrl=function(t){this.set("selectedUrl",t,{validate:!0})},s.prototype.getSelectedUrl=function(){return this.get("selectedUrl")},s.prototype.getType=function(){return null},t.expose(s,"aeris.maps.markers.Marker")}),r("aeris/collection",["aeris/util","aeris/model","aeris/events","backbone","aeris/errors/invalidargumenterror"],function(t,e,i,r,n){var s=function(s,o){var a=t.extend({model:e,validate:!1,modelOptions:{}},o);if(s&&!t.isArray(s))throw new n(s+" is not a valid array of models.");this.modelOptions_=a.modelOptions,r.Collection.call(this,s,t.pick(a,["model","comparator"])),i.call(this),a.validate&&this.isValid()};return t.inherits(s,r.Collection),t.extend(s.prototype,i.prototype),s.prototype.isValid=function(){var t=!0;return this.each(function(e){e.isValid()||(t=!1)}),t},s.prototype._prepareModel=function(e,i){var n=t.defaults(i||{},this.modelOptions_);return r.Collection.prototype._prepareModel.call(this,e,n)},t.expose(s,"aeris.Collection")}),r("aeris/viewcollection",["aeris/util","aeris/collection","aeris/viewmodel"],function(t,e,i){var r=function(r,n){var s=n&&n.data,o=t.defaults(n||{},{data:new e,model:i,modelOptions:{}});o.attributeTransforms&&(o.modelOptions.attributeTransforms=o.attributeTransforms),this.data_=o.data,this.viewModelLookup_={},e.call(this,r,o),this.bindToDataCollection_(),s&&this.updateModelsFromData_()};return t.inherits(r,e),r.prototype.bindToDataCollection_=function(){this.listenTo(this.data_,{add:this.addViewModel_,remove:this.removeViewModel_,reset:this.updateModelsFromData_}),this.proxyDataSyncEvents_()},r.prototype.proxyDataSyncEvents_=function(){this.listenTo(this.data_,{request:function(t,e,i){this.trigger("data:request",this,e)},sync:function(t,e,i){this.trigger("data:sync",this,e)}})},r.prototype.addViewModel_=function(t){var e=this.createViewModel_(t);this.viewModelLookup_[t.cid]=e,this.add(e)},r.prototype.removeViewModel_=function(t){var e=this.viewModelLookup_[t.cid];e&&(this.remove(e),delete this.viewModelLookup_[t.cid])},r.prototype.updateModelsFromData_=function(){var t=[];this.viewModelLookup_={},this.data_.each(function(e){var i=this.createViewModel_(e);this.viewModelLookup_[e.cid]=i,t.push(i)},this),this.reset(t)},r.prototype.createViewModel_=function(e){return this._prepareModel(void 0,t.defaults({},this.modelOptions_,{data:e}))},r.prototype.getData=function(){return this.data_},r.prototype.fetchData=function(t){return this.data_.fetch(t)},r}),r("aeris/maps/extensions/mapobjectcollection",["aeris/util","aeris/viewcollection"],function(t,e){var i=function(){this.map_=null,e.apply(this,arguments),this.bindChildrenToMap_()};return t.inherits(i,e),i.prototype.bindChildrenToMap_=function(){this.listenTo(this,{add:function(t){t.setMap(this.map_)},remove:function(t){t.setMap(null)},reset:function(t,e){e.previousModels.forEach(function(t){t.setMap(null)}),this.each(function(t){t.setMap(this.getMap())},this)}})},i.prototype.setMap=function(t,e){var i=e||{},r=t?"map:set":"map:remove",n=t===this.map_;this.map_=t,this.invoke("setMap",t,i),n||i.silent||this.trigger(r,this,t)},i.prototype.getMap=function(){return this.map_},i.prototype.hasMap=function(){return!!this.map_},i.prototype._onModelEvent=function(t,i,r,n){var s="map:set"===t||"map:remove"===t;s||e.prototype._onModelEvent.apply(this,arguments)},i}),r("aeris/togglecollectionbehavior",["aeris/util"],function(t){var e=function(){};return e.prototype.selectAll=function(){this.invoke("select")},e.prototype.deselectAll=function(){this.invoke("deselect")},e.prototype.toggleAll=function(){this.invoke("toggle")},e.prototype.selectOnly=function(t){this.each(function(e){e!==t&&e.deselect()}),t.select()},e.prototype.getSelected=function(){return this.filter(function(t){return t.isSelected()},this)},e.prototype.getDeselected=function(){return this.filter(function(t){return!t.isSelected()},this)},e}),r("aeris/config",["module","backbone","aeris/util"],function(t,e,r){var n=function(t,n){var s=r.defaults(t||{},{assetPath:"//cdn.aerisjs.com/assets/"});e.Model.call(this,s,n),this.on("change:strategy",function(){i.config({map:{"*":{"aeris/maps/strategy":this.get("strategy")}}})},this)};return r.inherits(n,e.Model),n.prototype.validate=function(t){if(t.strategy&&-1===["gmaps","openlayers"].indexOf(t.strategy))throw new Error("Invalid map type strategy. Valid strategies are  'gmaps' or 'openlayers'")},n.prototype.setStrategy_=function(t){if(!t)throw new Error("Unable to set map type strategy: no strategy defined");this.set("strategy",t,{validate:!0})},n.prototype.setApiId=function(t){this.set("apiId",t,{validate:!0})},n.prototype.setApiSecret=function(t){this.set("apiSecret",t,{validate:!0})},r.expose(new n(t.config()),"aeris.config")}),r("aeris/maps/markers/config/iconlookup",["aeris/util","aeris/config"],function(t,e){var i={offsetX:12,offsetY:11,width:25,height:25},r={offsetX:8,offsetY:17,width:15,height:34,anchorText:[-17,10]};return{stormReport:{avalanche:t.defaults({url:e.get("assetPath")+"stormrep_marker_avalanche.png"},i),blizzard:t.defaults({url:e.get("assetPath")+"stormrep_marker_snow.png"},i),sleet:t.defaults({url:e.get("assetPath")+"stormrep_marker_ice.png"},i),flood:t.defaults({url:e.get("assetPath")+"stormrep_marker_flood.png"},i),fog:t.defaults({url:e.get("assetPath")+"stormrep_marker_densefog.png"},i),ice:t.defaults({url:e.get("assetPath")+"stormrep_marker_ice.png"},i),hail:t.defaults({url:e.get("assetPath")+"stormrep_marker_hail.png"},i),lightning:t.defaults({url:e.get("assetPath")+"stormrep_marker_lightning.png"},i),rain:t.defaults({url:e.get("assetPath")+"stormrep_marker_rain.png"},i),snow:t.defaults({url:e.get("assetPath")+"stormrep_marker_snow.png"},i),tides:t.defaults({url:e.get("assetPath")+"stormrep_marker_highsurf.png"},i),spout:t.defaults({url:e.get("assetPath")+"stormrep_marker_tornado.png"},i),tornado:t.defaults({url:e.get("assetPath")+"stormrep_marker_tornado.png"},i),funnel:t.defaults({url:e.get("assetPath")+"stormrep_marker_tornado.png"},i),wind:t.defaults({url:e.get("assetPath")+"stormrep_marker_highwind.png"},i),downburst:t.defaults({url:e.get("assetPath")+"stormrep_marker_highwind.png"},i),winds:t.defaults({url:e.get("assetPath")+"stormrep_marker_highwind.png"},i)},earthquake:{mini:{url:e.get("assetPath")+"quake_mini.png",offsetX:8,offsetY:9,width:18,height:18,anchorText:[-9,12]},shallow:{url:e.get("assetPath")+"quake_mini.png",offsetX:8,offsetY:9,width:18,height:18,anchorText:[-9,12]},minor:{url:e.get("assetPath")+"quake_minor.png",offsetX:14,offsetY:15,width:31,height:31,anchorText:[-16,18]},light:{url:e.get("assetPath")+"quake_light.png",offsetX:21,offsetY:22,width:45,height:44},moderate:{url:e.get("assetPath")+"quake_moderate.png",offsetX:28,offsetY:29,width:58,height:58},strong:{url:e.get("assetPath")+"quake_strong.png",offsetX:42,offsetY:43,width:86,height:86},major:{url:e.get("assetPath")+"quake_major.png",offsetX:49,offsetY:50,width:100,height:100},great:{url:e.get("assetPath")+"quake_great.png",offsetX:49,offsetY:50,width:100,height:100}},lightning:{15:t.defaults({url:e.get("assetPath")+"lightning_white.png"},r),30:t.defaults({url:e.get("assetPath")+"lightning_yellow.png"},r),45:t.defaults({url:e.get("assetPath")+"lightning_red.png"},r),60:t.defaults({url:e.get("assetPath")+"lightning_orange.png"},r),99999:t.defaults({url:e.get("assetPath")+"lightning_blue.png"},r)},fire:{defaultStyles:{url:e.get("assetPath")+"map_fire_marker.png",offsetX:13,offsetY:33,width:27,height:38,anchorText:[-19,16]}}}}),r("aeris/maps/markercollections/config/clusterstyles",["aeris/util","aeris/config","aeris/maps/markers/config/iconlookup"],function(t,e,i){function r(e){var i=t.clone(e),r={textColor:"#ffffff",textSize:13,anchorText:[-14,15]};return t.each(i,function(e,n){i[n]=[t.defaults({},e,r)]}),i}var n={};return t.each(i,function(t,e){n[e]=r(t)}),n.defaultStyles=t.map(["marker_green.png","marker_grey.png","marker_yellow.png"],function(t){return{url:e.get("assetPath")+t,width:18,height:18,offsetX:9,offsetY:9,textColor:"#ffffff",textSize:13,anchorText:[-14,15]}}),n}),function(t,e,i){L.MarkerClusterGroup=L.FeatureGroup.extend({options:{maxClusterRadius:80,iconCreateFunction:null,spiderfyOnMaxZoom:!0,showCoverageOnHover:!0,zoomToBoundsOnClick:!0,singleMarkerMode:!1,disableClusteringAtZoom:null,removeOutsideVisibleBounds:!0,animateAddingMarkers:!1,spiderfyDistanceMultiplier:1,polygonOptions:{}},initialize:function(t){L.Util.setOptions(this,t),this.options.iconCreateFunction||(this.options.iconCreateFunction=this._defaultIconCreateFunction),this._featureGroup=L.featureGroup(),this._featureGroup.on(L.FeatureGroup.EVENTS,this._propagateEvent,this),this._nonPointGroup=L.featureGroup(),this._nonPointGroup.on(L.FeatureGroup.EVENTS,this._propagateEvent,this),this._inZoomAnimation=0,this._needsClustering=[],this._needsRemoving=[],this._currentShownBounds=null,this._queue=[]},addLayer:function(t){if(t instanceof L.LayerGroup){var e=[];for(var i in t._layers)e.push(t._layers[i]);return this.addLayers(e)}if(!t.getLatLng)return this._nonPointGroup.addLayer(t),this;if(!this._map)return this._needsClustering.push(t),this;if(this.hasLayer(t))return this;this._unspiderfy&&this._unspiderfy(),this._addLayer(t,this._maxZoom);var r=t,n=this._map.getZoom();if(t.__parent)for(;r.__parent._zoom>=n;)r=r.__parent;return this._currentShownBounds.contains(r.getLatLng())&&(this.options.animateAddingMarkers?this._animationAddLayer(t,r):this._animationAddLayerNonAnimated(t,r)),this},removeLayer:function(t){if(t instanceof L.LayerGroup){var e=[];for(var i in t._layers)e.push(t._layers[i]);return this.removeLayers(e)}return t.getLatLng?this._map?t.__parent?(this._unspiderfy&&(this._unspiderfy(),this._unspiderfyLayer(t)),this._removeLayer(t,!0),this._featureGroup.hasLayer(t)&&(this._featureGroup.removeLayer(t),t.setOpacity&&t.setOpacity(1)),this):this:(!this._arraySplice(this._needsClustering,t)&&this.hasLayer(t)&&this._needsRemoving.push(t),this):(this._nonPointGroup.removeLayer(t),this)},addLayers:function(t){var e,i,r,n=this._map,s=this._featureGroup,o=this._nonPointGroup;for(e=0,i=t.length;i>e;e++)if(r=t[e],r.getLatLng){if(!this.hasLayer(r))if(n){if(this._addLayer(r,this._maxZoom),r.__parent&&2===r.__parent.getChildCount()){var a=r.__parent.getAllChildMarkers(),l=a[0]===r?a[1]:a[0];s.removeLayer(l)}}else this._needsClustering.push(r)}else o.addLayer(r);return n&&(s.eachLayer(function(t){t instanceof L.MarkerCluster&&t._iconNeedsUpdate&&t._updateIcon()}),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds)),this},removeLayers:function(t){var e,i,r,n=this._featureGroup,s=this._nonPointGroup;if(!this._map){for(e=0,i=t.length;i>e;e++)r=t[e],this._arraySplice(this._needsClustering,r),s.removeLayer(r);return this}for(e=0,i=t.length;i>e;e++)r=t[e],r.__parent?(this._removeLayer(r,!0,!0),n.hasLayer(r)&&(n.removeLayer(r),r.setOpacity&&r.setOpacity(1))):s.removeLayer(r);return this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds),n.eachLayer(function(t){t instanceof L.MarkerCluster&&t._updateIcon()}),this},clearLayers:function(){return this._map||(this._needsClustering=[],delete this._gridClusters,delete this._gridUnclustered),this._noanimationUnspiderfy&&this._noanimationUnspiderfy(),this._featureGroup.clearLayers(),this._nonPointGroup.clearLayers(),this.eachLayer(function(t){delete t.__parent}),this._map&&this._generateInitialClusters(),this},getBounds:function(){var t=new L.LatLngBounds;if(this._topClusterLevel)t.extend(this._topClusterLevel._bounds);else for(var e=this._needsClustering.length-1;e>=0;e--)t.extend(this._needsClustering[e].getLatLng());return t.extend(this._nonPointGroup.getBounds()),t},eachLayer:function(t,e){var i,r=this._needsClustering.slice();for(this._topClusterLevel&&this._topClusterLevel.getAllChildMarkers(r),i=r.length-1;i>=0;i--)t.call(e,r[i]);this._nonPointGroup.eachLayer(t,e)},getLayers:function(){var t=[];return this.eachLayer(function(e){t.push(e)}),t},getLayer:function(t){var e=null;return this.eachLayer(function(i){L.stamp(i)===t&&(e=i)}),e},hasLayer:function(t){if(!t)return!1;var e,i=this._needsClustering;for(e=i.length-1;e>=0;e--)if(i[e]===t)return!0;for(i=this._needsRemoving,e=i.length-1;e>=0;e--)if(i[e]===t)return!1;return!(!t.__parent||t.__parent._group!==this)||this._nonPointGroup.hasLayer(t)},zoomToShowLayer:function(t,e){var i=function(){if((t._icon||t.__parent._icon)&&!this._inZoomAnimation)if(this._map.off("moveend",i,this),this.off("animationend",i,this),t._icon)e();else if(t.__parent._icon){var r=function(){this.off("spiderfied",r,this),e()};this.on("spiderfied",r,this),t.__parent.spiderfy()}};t._icon&&this._map.getBounds().contains(t.getLatLng())?e():t.__parent._zoom<this._map.getZoom()?(this._map.on("moveend",i,this),this._map.panTo(t.getLatLng())):(this._map.on("moveend",i,this),this.on("animationend",i,this),this._map.setView(t.getLatLng(),t.__parent._zoom+1),t.__parent.zoomToBounds())},onAdd:function(t){this._map=t;var e,i,r;if(!isFinite(this._map.getMaxZoom()))throw"Map has no maxZoom specified";for(this._featureGroup.onAdd(t),this._nonPointGroup.onAdd(t),this._gridClusters||this._generateInitialClusters(),e=0,i=this._needsRemoving.length;i>e;e++)r=this._needsRemoving[e],this._removeLayer(r,!0);for(this._needsRemoving=[],e=0,i=this._needsClustering.length;i>e;e++)r=this._needsClustering[e],r.getLatLng?r.__parent||this._addLayer(r,this._maxZoom):this._featureGroup.addLayer(r);this._needsClustering=[],this._map.on("zoomend",this._zoomEnd,this),this._map.on("moveend",this._moveEnd,this),this._spiderfierOnAdd&&this._spiderfierOnAdd(),this._bindEvents(),this._zoom=this._map.getZoom(),this._currentShownBounds=this._getExpandedVisibleBounds(),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds)},onRemove:function(t){t.off("zoomend",this._zoomEnd,this),t.off("moveend",this._moveEnd,this),this._unbindEvents(),this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim",""),this._spiderfierOnRemove&&this._spiderfierOnRemove(),this._hideCoverage(),this._featureGroup.onRemove(t),this._nonPointGroup.onRemove(t),this._featureGroup.clearLayers(),this._map=null},getVisibleParent:function(t){for(var e=t;e&&!e._icon;)e=e.__parent;return e||null},_arraySplice:function(t,e){for(var i=t.length-1;i>=0;i--)if(t[i]===e)return t.splice(i,1),!0},_removeLayer:function(t,e,i){var r=this._gridClusters,n=this._gridUnclustered,s=this._featureGroup,o=this._map;if(e)for(var a=this._maxZoom;a>=0&&n[a].removeObject(t,o.project(t.getLatLng(),a));a--);var l,u=t.__parent,c=u._markers;for(this._arraySplice(c,t);u&&(u._childCount--,!(u._zoom<0));)e&&u._childCount<=1?(l=u._markers[0]===t?u._markers[1]:u._markers[0],r[u._zoom].removeObject(u,o.project(u._cLatLng,u._zoom)),n[u._zoom].addObject(l,o.project(l.getLatLng(),u._zoom)),this._arraySplice(u.__parent._childClusters,u),u.__parent._markers.push(l),l.__parent=u.__parent,u._icon&&(s.removeLayer(u),i||s.addLayer(l))):(u._recalculateBounds(),i&&u._icon||u._updateIcon()),u=u.__parent;delete t.__parent},_isOrIsParent:function(t,e){for(;e;){if(t===e)return!0;e=e.parentNode}return!1},_propagateEvent:function(t){if(t.layer instanceof L.MarkerCluster){if(t.originalEvent&&this._isOrIsParent(t.layer._icon,t.originalEvent.relatedTarget))return;t.type="cluster"+t.type}this.fire(t.type,t)},_defaultIconCreateFunction:function(t){var e=t.getChildCount(),i=" marker-cluster-";return i+=10>e?"small":100>e?"medium":"large",new L.DivIcon({html:"<div><span>"+e+"</span></div>",className:"marker-cluster"+i,iconSize:new L.Point(40,40)})},_bindEvents:function(){var t=this._map,e=this.options.spiderfyOnMaxZoom,i=this.options.showCoverageOnHover,r=this.options.zoomToBoundsOnClick;(e||r)&&this.on("clusterclick",this._zoomOrSpiderfy,this),i&&(this.on("clustermouseover",this._showCoverage,this),this.on("clustermouseout",this._hideCoverage,this),t.on("zoomend",this._hideCoverage,this))},_zoomOrSpiderfy:function(t){var e=this._map;e.getMaxZoom()===e.getZoom()?this.options.spiderfyOnMaxZoom&&t.layer.spiderfy():this.options.zoomToBoundsOnClick&&t.layer.zoomToBounds(),t.originalEvent&&13===t.originalEvent.keyCode&&e._container.focus()},_showCoverage:function(t){var e=this._map;this._inZoomAnimation||(this._shownPolygon&&e.removeLayer(this._shownPolygon),t.layer.getChildCount()>2&&t.layer!==this._spiderfied&&(this._shownPolygon=new L.Polygon(t.layer.getConvexHull(),this.options.polygonOptions),e.addLayer(this._shownPolygon)))},_hideCoverage:function(){this._shownPolygon&&(this._map.removeLayer(this._shownPolygon),this._shownPolygon=null)},_unbindEvents:function(){var t=this.options.spiderfyOnMaxZoom,e=this.options.showCoverageOnHover,i=this.options.zoomToBoundsOnClick,r=this._map;(t||i)&&this.off("clusterclick",this._zoomOrSpiderfy,this),e&&(this.off("clustermouseover",this._showCoverage,this),this.off("clustermouseout",this._hideCoverage,this),r.off("zoomend",this._hideCoverage,this))},_zoomEnd:function(){this._map&&(this._mergeSplitClusters(),this._zoom=this._map._zoom,this._currentShownBounds=this._getExpandedVisibleBounds())},_moveEnd:function(){if(!this._inZoomAnimation){var t=this._getExpandedVisibleBounds();this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,this._zoom,t),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._map._zoom,t),this._currentShownBounds=t}},_generateInitialClusters:function(){var t=this._map.getMaxZoom(),e=this.options.maxClusterRadius;this.options.disableClusteringAtZoom&&(t=this.options.disableClusteringAtZoom-1),this._maxZoom=t,this._gridClusters={},this._gridUnclustered={};for(var i=t;i>=0;i--)this._gridClusters[i]=new L.DistanceGrid(e),this._gridUnclustered[i]=new L.DistanceGrid(e);this._topClusterLevel=new L.MarkerCluster(this,-1)},_addLayer:function(t,e){var i,r,n=this._gridClusters,s=this._gridUnclustered;for(this.options.singleMarkerMode&&(t.options.icon=this.options.iconCreateFunction({getChildCount:function(){return 1},getAllChildMarkers:function(){return[t]}}));e>=0;e--){i=this._map.project(t.getLatLng(),e);var o=n[e].getNearObject(i);if(o)return o._addChild(t),void(t.__parent=o);if(o=s[e].getNearObject(i)){var a=o.__parent;a&&this._removeLayer(o,!1);var l=new L.MarkerCluster(this,e,o,t);n[e].addObject(l,this._map.project(l._cLatLng,e)),o.__parent=l,t.__parent=l;var u=l;for(r=e-1;r>a._zoom;r--)u=new L.MarkerCluster(this,r,u),n[r].addObject(u,this._map.project(o.getLatLng(),r));for(a._addChild(u),r=e;r>=0&&s[r].removeObject(o,this._map.project(o.getLatLng(),r));r--);return}s[e].addObject(t,i)}this._topClusterLevel._addChild(t),t.__parent=this._topClusterLevel},_enqueue:function(t){this._queue.push(t),this._queueTimeout||(this._queueTimeout=setTimeout(L.bind(this._processQueue,this),300))},_processQueue:function(){for(var t=0;t<this._queue.length;t++)this._queue[t].call(this);this._queue.length=0,clearTimeout(this._queueTimeout),this._queueTimeout=null},_mergeSplitClusters:function(){this._processQueue(),this._zoom<this._map._zoom&&this._currentShownBounds.contains(this._getExpandedVisibleBounds())?(this._animationStart(),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,this._zoom,this._getExpandedVisibleBounds()),this._animationZoomIn(this._zoom,this._map._zoom)):this._zoom>this._map._zoom?(this._animationStart(),this._animationZoomOut(this._zoom,this._map._zoom)):this._moveEnd()},_getExpandedVisibleBounds:function(){if(!this.options.removeOutsideVisibleBounds)return this.getBounds();var t=this._map,e=t.getBounds(),i=e._southWest,r=e._northEast,n=L.Browser.mobile?0:Math.abs(i.lat-r.lat),s=L.Browser.mobile?0:Math.abs(i.lng-r.lng);return new L.LatLngBounds(new L.LatLng(i.lat-n,i.lng-s,!0),new L.LatLng(r.lat+n,r.lng+s,!0))},_animationAddLayerNonAnimated:function(t,e){
if(e===t)this._featureGroup.addLayer(t);else if(2===e._childCount){e._addToMap();var i=e.getAllChildMarkers();this._featureGroup.removeLayer(i[0]),this._featureGroup.removeLayer(i[1])}else e._updateIcon()}}),L.MarkerClusterGroup.include(L.DomUtil.TRANSITION?{_animationStart:function(){this._map._mapPane.className+=" leaflet-cluster-anim",this._inZoomAnimation++},_animationEnd:function(){this._map&&(this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim","")),this._inZoomAnimation--,this.fire("animationend")},_animationZoomIn:function(t,e){var i,r=this._getExpandedVisibleBounds(),n=this._featureGroup;this._topClusterLevel._recursively(r,t,0,function(s){var o,a=s._latlng,l=s._markers;for(r.contains(a)||(a=null),s._isSingleParent()&&t+1===e?(n.removeLayer(s),s._recursivelyAddChildrenToMap(null,e,r)):(s.setOpacity(0),s._recursivelyAddChildrenToMap(a,e,r)),i=l.length-1;i>=0;i--)o=l[i],r.contains(o._latlng)||n.removeLayer(o)}),this._forceLayout(),this._topClusterLevel._recursivelyBecomeVisible(r,e),n.eachLayer(function(t){t instanceof L.MarkerCluster||!t._icon||t.setOpacity(1)}),this._topClusterLevel._recursively(r,t,e,function(t){t._recursivelyRestoreChildPositions(e)}),this._enqueue(function(){this._topClusterLevel._recursively(r,t,0,function(t){n.removeLayer(t),t.setOpacity(1)}),this._animationEnd()})},_animationZoomOut:function(t,e){this._animationZoomOutSingle(this._topClusterLevel,t-1,e),this._topClusterLevel._recursivelyAddChildrenToMap(null,e,this._getExpandedVisibleBounds()),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,t,this._getExpandedVisibleBounds())},_animationZoomOutSingle:function(t,e,i){var r=this._getExpandedVisibleBounds();t._recursivelyAnimateChildrenInAndAddSelfToMap(r,e+1,i);var n=this;this._forceLayout(),t._recursivelyBecomeVisible(r,i),this._enqueue(function(){if(1===t._childCount){var s=t._markers[0];s.setLatLng(s.getLatLng()),s.setOpacity(1)}else t._recursively(r,i,0,function(t){t._recursivelyRemoveChildrenFromMap(r,e+1)});n._animationEnd()})},_animationAddLayer:function(t,e){var i=this,r=this._featureGroup;r.addLayer(t),e!==t&&(e._childCount>2?(e._updateIcon(),this._forceLayout(),this._animationStart(),t._setPos(this._map.latLngToLayerPoint(e.getLatLng())),t.setOpacity(0),this._enqueue(function(){r.removeLayer(t),t.setOpacity(1),i._animationEnd()})):(this._forceLayout(),i._animationStart(),i._animationZoomOutSingle(e,this._map.getMaxZoom(),this._map.getZoom())))},_forceLayout:function(){L.Util.falseFn(e.body.offsetWidth)}}:{_animationStart:function(){},_animationZoomIn:function(t,e){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,t),this._topClusterLevel._recursivelyAddChildrenToMap(null,e,this._getExpandedVisibleBounds())},_animationZoomOut:function(t,e){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,t),this._topClusterLevel._recursivelyAddChildrenToMap(null,e,this._getExpandedVisibleBounds())},_animationAddLayer:function(t,e){this._animationAddLayerNonAnimated(t,e)}}),L.markerClusterGroup=function(t){return new L.MarkerClusterGroup(t)},L.MarkerCluster=L.Marker.extend({initialize:function(t,e,i,r){L.Marker.prototype.initialize.call(this,i?i._cLatLng||i.getLatLng():new L.LatLng(0,0),{icon:this}),this._group=t,this._zoom=e,this._markers=[],this._childClusters=[],this._childCount=0,this._iconNeedsUpdate=!0,this._bounds=new L.LatLngBounds,i&&this._addChild(i),r&&this._addChild(r)},getAllChildMarkers:function(t){t=t||[];for(var e=this._childClusters.length-1;e>=0;e--)this._childClusters[e].getAllChildMarkers(t);for(var i=this._markers.length-1;i>=0;i--)t.push(this._markers[i]);return t},getChildCount:function(){return this._childCount},zoomToBounds:function(){for(var t,e=this._childClusters.slice(),i=this._group._map,r=i.getBoundsZoom(this._bounds),n=this._zoom+1,s=i.getZoom();e.length>0&&r>n;){n++;var o=[];for(t=0;t<e.length;t++)o=o.concat(e[t]._childClusters);e=o}r>n?this._group._map.setView(this._latlng,n):s>=r?this._group._map.setView(this._latlng,s+1):this._group._map.fitBounds(this._bounds)},getBounds:function(){var t=new L.LatLngBounds;return t.extend(this._bounds),t},_updateIcon:function(){this._iconNeedsUpdate=!0,this._icon&&this.setIcon(this)},createIcon:function(){return this._iconNeedsUpdate&&(this._iconObj=this._group.options.iconCreateFunction(this),this._iconNeedsUpdate=!1),this._iconObj.createIcon()},createShadow:function(){return this._iconObj.createShadow()},_addChild:function(t,e){this._iconNeedsUpdate=!0,this._expandBounds(t),t instanceof L.MarkerCluster?(e||(this._childClusters.push(t),t.__parent=this),this._childCount+=t._childCount):(e||this._markers.push(t),this._childCount++),this.__parent&&this.__parent._addChild(t,!0)},_expandBounds:function(t){var e,i=t._wLatLng||t._latlng;t instanceof L.MarkerCluster?(this._bounds.extend(t._bounds),e=t._childCount):(this._bounds.extend(i),e=1),this._cLatLng||(this._cLatLng=t._cLatLng||i);var r=this._childCount+e;this._wLatLng?(this._wLatLng.lat=(i.lat*e+this._wLatLng.lat*this._childCount)/r,this._wLatLng.lng=(i.lng*e+this._wLatLng.lng*this._childCount)/r):this._latlng=this._wLatLng=new L.LatLng(i.lat,i.lng)},_addToMap:function(t){t&&(this._backupLatlng=this._latlng,this.setLatLng(t)),this._group._featureGroup.addLayer(this)},_recursivelyAnimateChildrenIn:function(t,e,i){this._recursively(t,0,i-1,function(t){var i,r,n=t._markers;for(i=n.length-1;i>=0;i--)r=n[i],r._icon&&(r._setPos(e),r.setOpacity(0))},function(t){var i,r,n=t._childClusters;for(i=n.length-1;i>=0;i--)r=n[i],r._icon&&(r._setPos(e),r.setOpacity(0))})},_recursivelyAnimateChildrenInAndAddSelfToMap:function(t,e,i){this._recursively(t,i,0,function(r){r._recursivelyAnimateChildrenIn(t,r._group._map.latLngToLayerPoint(r.getLatLng()).round(),e),r._isSingleParent()&&e-1===i?(r.setOpacity(1),r._recursivelyRemoveChildrenFromMap(t,e)):r.setOpacity(0),r._addToMap()})},_recursivelyBecomeVisible:function(t,e){this._recursively(t,0,e,null,function(t){t.setOpacity(1)})},_recursivelyAddChildrenToMap:function(t,e,i){this._recursively(i,-1,e,function(r){if(e!==r._zoom)for(var n=r._markers.length-1;n>=0;n--){var s=r._markers[n];i.contains(s._latlng)&&(t&&(s._backupLatlng=s.getLatLng(),s.setLatLng(t),s.setOpacity&&s.setOpacity(0)),r._group._featureGroup.addLayer(s))}},function(e){e._addToMap(t)})},_recursivelyRestoreChildPositions:function(t){for(var e=this._markers.length-1;e>=0;e--){var i=this._markers[e];i._backupLatlng&&(i.setLatLng(i._backupLatlng),delete i._backupLatlng)}if(t-1===this._zoom)for(var r=this._childClusters.length-1;r>=0;r--)this._childClusters[r]._restorePosition();else for(var n=this._childClusters.length-1;n>=0;n--)this._childClusters[n]._recursivelyRestoreChildPositions(t)},_restorePosition:function(){this._backupLatlng&&(this.setLatLng(this._backupLatlng),delete this._backupLatlng)},_recursivelyRemoveChildrenFromMap:function(t,e,i){var r,n;this._recursively(t,-1,e-1,function(t){for(n=t._markers.length-1;n>=0;n--)r=t._markers[n],i&&i.contains(r._latlng)||(t._group._featureGroup.removeLayer(r),r.setOpacity&&r.setOpacity(1))},function(t){for(n=t._childClusters.length-1;n>=0;n--)r=t._childClusters[n],i&&i.contains(r._latlng)||(t._group._featureGroup.removeLayer(r),r.setOpacity&&r.setOpacity(1))})},_recursively:function(t,e,i,r,n){var s,o,a=this._childClusters,l=this._zoom;if(e>l)for(s=a.length-1;s>=0;s--)o=a[s],t.intersects(o._bounds)&&o._recursively(t,e,i,r,n);else if(r&&r(this),n&&this._zoom===i&&n(this),i>l)for(s=a.length-1;s>=0;s--)o=a[s],t.intersects(o._bounds)&&o._recursively(t,e,i,r,n)},_recalculateBounds:function(){var t,e=this._markers,i=this._childClusters;for(this._bounds=new L.LatLngBounds,delete this._wLatLng,t=e.length-1;t>=0;t--)this._expandBounds(e[t]);for(t=i.length-1;t>=0;t--)this._expandBounds(i[t])},_isSingleParent:function(){return this._childClusters.length>0&&this._childClusters[0]._childCount===this._childCount}}),L.DistanceGrid=function(t){this._cellSize=t,this._sqCellSize=t*t,this._grid={},this._objectPoint={}},L.DistanceGrid.prototype={addObject:function(t,e){var i=this._getCoord(e.x),r=this._getCoord(e.y),n=this._grid,s=n[r]=n[r]||{},o=s[i]=s[i]||[],a=L.Util.stamp(t);this._objectPoint[a]=e,o.push(t)},updateObject:function(t,e){this.removeObject(t),this.addObject(t,e)},removeObject:function(t,e){var i,r,n=this._getCoord(e.x),s=this._getCoord(e.y),o=this._grid,a=o[s]=o[s]||{},l=a[n]=a[n]||[];for(delete this._objectPoint[L.Util.stamp(t)],i=0,r=l.length;r>i;i++)if(l[i]===t)return l.splice(i,1),1===r&&delete a[n],!0},eachObject:function(t,e){var i,r,n,s,o,a,l,u=this._grid;for(i in u){o=u[i];for(r in o)for(a=o[r],n=0,s=a.length;s>n;n++)l=t.call(e,a[n]),l&&(n--,s--)}},getNearObject:function(t){var e,i,r,n,s,o,a,l,u=this._getCoord(t.x),c=this._getCoord(t.y),p=this._objectPoint,h=this._sqCellSize,d=null;for(e=c-1;c+1>=e;e++)if(n=this._grid[e])for(i=u-1;u+1>=i;i++)if(s=n[i])for(r=0,o=s.length;o>r;r++)a=s[r],l=this._sqDist(p[L.Util.stamp(a)],t),h>l&&(h=l,d=a);return d},_getCoord:function(t){return Math.floor(t/this._cellSize)},_sqDist:function(t,e){var i=e.x-t.x,r=e.y-t.y;return i*i+r*r}},function(){L.QuickHull={getDistant:function(t,e){var i=e[1].lat-e[0].lat,r=e[0].lng-e[1].lng;return r*(t.lat-e[0].lat)+i*(t.lng-e[0].lng)},findMostDistantPointFromBaseLine:function(t,e){var i,r,n,s=0,o=null,a=[];for(i=e.length-1;i>=0;i--)r=e[i],n=this.getDistant(r,t),n>0&&(a.push(r),n>s&&(s=n,o=r));return{maxPoint:o,newPoints:a}},buildConvexHull:function(t,e){var i=[],r=this.findMostDistantPointFromBaseLine(t,e);return r.maxPoint?(i=i.concat(this.buildConvexHull([t[0],r.maxPoint],r.newPoints)),i=i.concat(this.buildConvexHull([r.maxPoint,t[1]],r.newPoints))):[t[0]]},getConvexHull:function(t){var e,i=!1,r=!1,n=null,s=null;for(e=t.length-1;e>=0;e--){var o=t[e];(i===!1||o.lat>i)&&(n=o,i=o.lat),(r===!1||o.lat<r)&&(s=o,r=o.lat)}var a=[].concat(this.buildConvexHull([s,n],t),this.buildConvexHull([n,s],t));return a}}}(),L.MarkerCluster.include({getConvexHull:function(){var t,e,i=this.getAllChildMarkers(),r=[];for(e=i.length-1;e>=0;e--)t=i[e].getLatLng(),r.push(t);return L.QuickHull.getConvexHull(r)}}),L.MarkerCluster.include({_2PI:2*Math.PI,_circleFootSeparation:25,_circleStartAngle:Math.PI/6,_spiralFootSeparation:28,_spiralLengthStart:11,_spiralLengthFactor:5,_circleSpiralSwitchover:9,spiderfy:function(){if(this._group._spiderfied!==this&&!this._group._inZoomAnimation){var t,e=this.getAllChildMarkers(),i=this._group,r=i._map,n=r.latLngToLayerPoint(this._latlng);this._group._unspiderfy(),this._group._spiderfied=this,e.length>=this._circleSpiralSwitchover?t=this._generatePointsSpiral(e.length,n):(n.y+=10,t=this._generatePointsCircle(e.length,n)),this._animationSpiderfy(e,t)}},unspiderfy:function(t){this._group._inZoomAnimation||(this._animationUnspiderfy(t),this._group._spiderfied=null)},_generatePointsCircle:function(t,e){var i,r,n=this._group.options.spiderfyDistanceMultiplier*this._circleFootSeparation*(2+t),s=n/this._2PI,o=this._2PI/t,a=[];for(a.length=t,i=t-1;i>=0;i--)r=this._circleStartAngle+i*o,a[i]=new L.Point(e.x+s*Math.cos(r),e.y+s*Math.sin(r))._round();return a},_generatePointsSpiral:function(t,e){var i,r=this._group.options.spiderfyDistanceMultiplier*this._spiralLengthStart,n=this._group.options.spiderfyDistanceMultiplier*this._spiralFootSeparation,s=this._group.options.spiderfyDistanceMultiplier*this._spiralLengthFactor,o=0,a=[];for(a.length=t,i=t-1;i>=0;i--)o+=n/r+5e-4*i,a[i]=new L.Point(e.x+r*Math.cos(o),e.y+r*Math.sin(o))._round(),r+=this._2PI*s/o;return a},_noanimationUnspiderfy:function(){var t,e,i=this._group,r=i._map,n=i._featureGroup,s=this.getAllChildMarkers();for(this.setOpacity(1),e=s.length-1;e>=0;e--)t=s[e],n.removeLayer(t),t._preSpiderfyLatlng&&(t.setLatLng(t._preSpiderfyLatlng),delete t._preSpiderfyLatlng),t.setZIndexOffset&&t.setZIndexOffset(0),t._spiderLeg&&(r.removeLayer(t._spiderLeg),delete t._spiderLeg);i._spiderfied=null}}),L.MarkerCluster.include(L.DomUtil.TRANSITION?{SVG_ANIMATION:function(){return e.createElementNS("http://www.w3.org/2000/svg","animate").toString().indexOf("SVGAnimate")>-1}(),_animationSpiderfy:function(t,i){var r,n,s,o,a=this,l=this._group,u=l._map,c=l._featureGroup,p=u.latLngToLayerPoint(this._latlng);for(r=t.length-1;r>=0;r--)n=t[r],n.setOpacity?(n.setZIndexOffset(1e6),n.setOpacity(0),c.addLayer(n),n._setPos(p)):c.addLayer(n);l._forceLayout(),l._animationStart();var h=L.Path.SVG?0:.3,d=L.Path.SVG_NS;for(r=t.length-1;r>=0;r--)if(o=u.layerPointToLatLng(i[r]),n=t[r],n._preSpiderfyLatlng=n._latlng,n.setLatLng(o),n.setOpacity&&n.setOpacity(1),s=new L.Polyline([a._latlng,o],{weight:1.5,color:"#222",opacity:h}),u.addLayer(s),n._spiderLeg=s,L.Path.SVG&&this.SVG_ANIMATION){var f=s._path.getTotalLength();s._path.setAttribute("stroke-dasharray",f+","+f);var m=e.createElementNS(d,"animate");m.setAttribute("attributeName","stroke-dashoffset"),m.setAttribute("begin","indefinite"),m.setAttribute("from",f),m.setAttribute("to",0),m.setAttribute("dur",.25),s._path.appendChild(m),m.beginElement(),m=e.createElementNS(d,"animate"),m.setAttribute("attributeName","stroke-opacity"),m.setAttribute("attributeName","stroke-opacity"),m.setAttribute("begin","indefinite"),m.setAttribute("from",0),m.setAttribute("to",.5),m.setAttribute("dur",.25),s._path.appendChild(m),m.beginElement()}if(a.setOpacity(.3),L.Path.SVG)for(this._group._forceLayout(),r=t.length-1;r>=0;r--)n=t[r]._spiderLeg,n.options.opacity=.5,n._path.setAttribute("stroke-opacity",.5);setTimeout(function(){l._animationEnd(),l.fire("spiderfied")},200)},_animationUnspiderfy:function(t){var e,i,r,n=this._group,s=n._map,o=n._featureGroup,a=t?s._latLngToNewLayerPoint(this._latlng,t.zoom,t.center):s.latLngToLayerPoint(this._latlng),l=this.getAllChildMarkers(),u=L.Path.SVG&&this.SVG_ANIMATION;for(n._animationStart(),this.setOpacity(1),i=l.length-1;i>=0;i--)e=l[i],e._preSpiderfyLatlng&&(e.setLatLng(e._preSpiderfyLatlng),delete e._preSpiderfyLatlng,e.setOpacity?(e._setPos(a),e.setOpacity(0)):o.removeLayer(e),u&&(r=e._spiderLeg._path.childNodes[0],r.setAttribute("to",r.getAttribute("from")),r.setAttribute("from",0),r.beginElement(),r=e._spiderLeg._path.childNodes[1],r.setAttribute("from",.5),r.setAttribute("to",0),r.setAttribute("stroke-opacity",0),r.beginElement(),e._spiderLeg._path.setAttribute("stroke-opacity",0)));setTimeout(function(){var t=0;for(i=l.length-1;i>=0;i--)e=l[i],e._spiderLeg&&t++;for(i=l.length-1;i>=0;i--)e=l[i],e._spiderLeg&&(e.setOpacity&&(e.setOpacity(1),e.setZIndexOffset(0)),t>1&&o.removeLayer(e),s.removeLayer(e._spiderLeg),delete e._spiderLeg);n._animationEnd()},200)}}:{_animationSpiderfy:function(t,e){var i,r,n,s,o=this._group,a=o._map,l=o._featureGroup;for(i=t.length-1;i>=0;i--)s=a.layerPointToLatLng(e[i]),r=t[i],r._preSpiderfyLatlng=r._latlng,r.setLatLng(s),r.setZIndexOffset&&r.setZIndexOffset(1e6),l.addLayer(r),n=new L.Polyline([this._latlng,s],{weight:1.5,color:"#222"}),a.addLayer(n),r._spiderLeg=n;this.setOpacity(.3),o.fire("spiderfied")},_animationUnspiderfy:function(){this._noanimationUnspiderfy()}}),L.MarkerClusterGroup.include({_spiderfied:null,_spiderfierOnAdd:function(){this._map.on("click",this._unspiderfyWrapper,this),this._map.options.zoomAnimation&&this._map.on("zoomstart",this._unspiderfyZoomStart,this),this._map.on("zoomend",this._noanimationUnspiderfy,this),L.Path.SVG&&!L.Browser.touch&&this._map._initPathRoot()},_spiderfierOnRemove:function(){this._map.off("click",this._unspiderfyWrapper,this),this._map.off("zoomstart",this._unspiderfyZoomStart,this),this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._unspiderfy()},_unspiderfyZoomStart:function(){this._map&&this._map.on("zoomanim",this._unspiderfyZoomAnim,this)},_unspiderfyZoomAnim:function(t){L.DomUtil.hasClass(this._map._mapPane,"leaflet-touching")||(this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._unspiderfy(t))},_unspiderfyWrapper:function(){this._unspiderfy()},_unspiderfy:function(t){this._spiderfied&&this._spiderfied.unspiderfy(t)},_noanimationUnspiderfy:function(){this._spiderfied&&this._spiderfied._noanimationUnspiderfy()},_unspiderfyLayer:function(t){t._spiderLeg&&(this._featureGroup.removeLayer(t),t.setOpacity(1),t.setZIndexOffset(0),this._map.removeLayer(t._spiderLeg),delete t._spiderLeg)}})}(window,document),r("leaflet-markercluster",["leaflet"],function(t){return function(){var e,i;return i=function(){return L.MarkerClusterGroup},e=i.apply(t,arguments),e||t.L.MarkerClusterGroup}}(this)),r("aeris/maps/strategy/markers/clustericontemplate",["aeris/util"],function(t){var e='<div>  <img src="{url}"       ">  <div style="position: absolute;          bottom: {height - 8}px;          right: -{width / 2}px;          color: #fff;          font-size: 12px;          font-family: Arial,sans-serif;          font-weight: bold;          font-style: normal;          text-decoration: none;          text-align: center;          width: 25px;          line-height:1.5em;           background-image: -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #a90329), color-stop(44%, #8f0222), color-stop(100%, #6d0019));           background-image: -webkit-linear-gradient(top, #a90329 0%, #8f0222 44%, #6d0019 100%);           background-image: -moz-linear-gradient(top, #a90329 0%, #8f0222 44%, #6d0019 100%);           background-image: -o-linear-gradient(top, #a90329 0%, #8f0222 44%, #6d0019 100%);           background-image: linear-gradient(top, #a90329 0%, #8f0222 44%, #6d0019 100%);           -webkit-border-radius: 5px;           -moz-border-radius: 5px;           -ms-border-radius: 5px;           -o-border-radius: 5px;           border-radius: 5px;           border: 1px solid rgba(0, 0, 0, 0.5);          ">    {count}  </div></div>';return t.template(e)}),r("aeris/maps/strategy/markers/markercluster",["aeris/util","aeris/maps/abstractstrategy","aeris/maps/strategy/util","leaflet","leaflet-markercluster","aeris/maps/strategy/markers/clustericontemplate"],function(t,e,i,r,n,s){var o=function(t){e.call(this,t),this.bindObjectToView_(),this.addBulkMarkers_(this.object_.models)};return t.inherits(o,e),o.prototype.createView_=function(){var t={};return t[o.SINGLE_CLUSTER_GROUPNAME_]=this.createCluster_(o.SINGLE_CLUSTER_GROUPNAME_),t},o.prototype.setMap=function(i){e.prototype.setMap.call(this,i),t.values(this.view_).forEach(function(t){t.addTo(this.mapView_)},this),this.resetMarkers_(this.object_.models)},o.prototype.beforeRemove_=function(){t.each(this.view_,function(t){this.mapView_.removeLayer(t)},this)},o.prototype.createCluster_=function(t){var e=new n({iconCreateFunction:function(e){return this.createIconForCluster_(e,t)}.bind(this)});return this.proxyMouseEventsForCluster_(e),this.mapView_&&e.addTo(this.mapView_),e},o.prototype.createIconForCluster_=function(t,e){var i=this.getClusterStyle_(t,e);return new L.DivIcon({html:this.createHtmlForCluster_(t,e),iconSize:new r.Point(i.width,i.height),iconAnchor:new r.Point(i.offsetX,i.offsetY),className:o.CLUSTER_CSS_CLASS_})},o.prototype.createHtmlForCluster_=function(e,i){var r=this.getClusterStyle_(e,i);return s(t.extend({},r,{count:e.getChildCount()}))},o.prototype.getClusterStyle_=function(t,e){for(var i=this.object_.getClusterStyle(e),r=t.getChildCount(),n=-1;0!==r;)r=parseInt(r/10,10),n++;return n=Math.min(n,i.length-1),i[n]},o.prototype.addBulkMarkers_=function(e){var i=t.groupBy(e,this.getMarkerType_,this);t.each(i,function(t,e){var i=t.map(function(t){return t.getView()});this.ensureClusterGroup_(e),t.forEach(this.hideMarkerView_,this),this.view_[e].addLayers(i)},this)},o.prototype.removeMarker_=function(t){this.getClusterForMarker_(t).removeLayer(t.getView())},o.prototype.resetMarkers_=function(e){t.invoke(this.view_,"clearLayers"),e&&this.addBulkMarkers_(e)},o.prototype.hideMarkerView_=function(t){this.mapView_&&this.mapView_.removeLayer(t.getView())},o.prototype.ensureClusterGroup_=function(t){this.view_[t]||(this.view_[t]=this.createCluster_(t))},o.prototype.getClusterForMarker_=function(t){var e=this.getMarkerType_(t);return this.view_[e]},o.prototype.getMarkerType_=function(t){return t.getType()||o.SINGLE_CLUSTER_GROUPNAME_},o.prototype.bindObjectToView_=function(){this.listenTo(this.object_,{add:function(){this.addBulkMarkers_(this.object_.models)},remove:this.removeMarker_,reset:function(){this.resetMarkers_(this.object_.models)}})},o.prototype.proxyMouseEventsForCluster_=function(t){t.on({clusterclick:this.triggerMouseEvent_.bind(this,"cluster:click"),clustermouseover:this.triggerMouseEvent_.bind(this,"cluster:mouseover"),clustermouseout:this.triggerMouseEvent_.bind(this,"cluster:mouseout")},this)},o.prototype.triggerMouseEvent_=function(t,e){var r=i.toAerisLatLon(e.latlng);this.object_.trigger(t,r)},o.prototype.destroy=function(){var t=this.object_.models.map(function(t){return t.getView()}),i=this.mapView_;e.prototype.destroy.call(this),i&&t.forEach(function(t){t.addTo(i)},this)},o.SINGLE_CLUSTER_GROUPNAME_="MARKERCLUSTERSTRATEGY_SINGLE_CLUSTER",o.CLUSTER_CSS_CLASS_="aeris-cluster aeris-leaflet",o}),r("aeris/maps/markercollections/markercollection",["aeris/util","aeris/maps/extensions/mapobjectcollection","aeris/togglecollectionbehavior","aeris/maps/extensions/strategyobject","aeris/maps/markers/marker","aeris/maps/markercollections/config/clusterstyles","aeris/maps/strategy/markers/markercluster"],function(t,e,i,r,n,s,o){var a=function(a,l){var u=t.defaults(l||{},{model:n,clusterStrategy:o,clusterStyles:{},clusterOptions:{},cluster:!0,strategy:null});u.clusterStyles=t.defaults(u.clusterStyles,{defaultStyles:s.defaultStyles}),this.clusterStyles_=u.clusterStyles,this.clusterStrategy_=u.clusterStrategy,this.clusterOptions_=u.clusterOptions,this.isClustering_=!1,e.call(this,a,u),i.call(this),r.call(this,{strategy:u.strategy}),u.cluster&&this.startClustering()};return t.inherits(a,e),t.extend(a.prototype,r.prototype),t.extend(a.prototype,i.prototype),a.prototype.getClusterStyle=function(t){var e=this.clusterStyles_[t]||this.clusterStyles_.defaultStyles;return e.slice(0)},a.prototype.getClusterOptions=function(){return t.clone(this.clusterOptions_)},a.prototype.startClustering=function(){this.setStrategy(this.clusterStrategy_);var t=this.getMap();this.setMap(null),this.setMap(t),this.isClustering_=!0},a.prototype.stopClustering=function(){this.isClustering_&&this.removeStrategy()},t.expose(a,"aeris.maps.markercollections.MarkerCollection")}),r("aeris/maps/markercollections/pointdatamarkers",["aeris/util","aeris/maps/markercollections/markercollection"],function(t,e){var i=function(t,i){e.call(this,t,i)};return t.inherits(i,e),t.each(["getParams","setParams","setFrom","setTo","setLimit","setBounds","addFilter","removeFilter","resetFilter","addQuery","removeQuery","resetQuery","getQuery"],function(t){i.prototype[t]=function(e){return this.data_[t].apply(this.data_,arguments)}}),i}),r("aeris/api/operator",["aeris/util"],function(t){var e={AND:"AND",OR:"OR"};return t.expose(e,"aeris.api.Operator")}),r("aeris/api/params/models/filter",["aeris/util","aeris/model","aeris/errors/validationerror","aeris/api/operator"],function(t,e,i,r){var n=function(i,n){var s=t.extend({operator:r.AND},i),o=t.defaults(n||{},{idAttribute:"name"});e.call(this,s,o),this.listenTo(this,"add",function(){this.isValid()})};return t.inherits(n,e),n.prototype.validate=function(t){return-1===[r.AND,r.OR].indexOf(t.operator)?new i("Operator","Must be an aeris.api.Operator."):void 0},n.prototype.isOr=function(){return this.get("operator")===r.OR},n.prototype.isAnd=function(){return this.get("operator")===r.AND},t.expose(n,"aeris.api.params.models.Filter")}),r("aeris/api/params/collections/filtercollection",["aeris/util","aeris/collection","aeris/api/params/models/filter","aeris/api/operator"],function(t,e,i,r){var n=function(r,n){var s=t.defaults(n||{},{model:i});e.call(this,r,s)};return t.inherits(n,e),n.prototype.toString=function(){var t="";return this.each(function(e,i){var r=this.operatorToString_(e.get("operator"));return 0===i?void(t+=e.get("name")):void(t+=r+e.get("name"))},this),t},n.prototype.operatorToString_=function(t){var e={};return e[r.AND]=",",e[r.OR]=";",e[t]},n.prototype.add=function(t,e){var i=e||{};i.reset=!1,this.addFiltersByName_(t,i)},n.prototype.reset=function(t,e){var i=e||{};i.reset=!0,this.addFiltersByName_(t,i)},n.prototype.addFiltersByName_=function(i,n){var s,o=[];return n=t.extend({operator:r.AND,reset:!1},n),s=n.reset?"reset":"add",t.isArray(i)||t.isUndefined(i)||(i=[i]),i&&t.isString(i[0])?(t.each(i,function(t){o.push({name:t,operator:n.operator})},this),e.prototype[s].call(this,o,n)):e.prototype[s].call(this,i)},n.prototype.remove=function(i,r){var n=[];return t.isArray(i)||(i=[i]),t.isString(i[0])?(t.each(i,function(t){var e=this.where({name:t});n=n.concat(e)},this),e.prototype.remove.call(this,n,r)):e.prototype.remove.apply(this,arguments)},n}),r("aeris/api/params/models/query",["aeris/util","aeris/model","aeris/errors/validationerror","aeris/api/operator"],function(t,e,i,r){var n=function(i,n){var s=t.defaults(n||{},{idAttribute:"property",defaults:{}});t.defaults(s.defaults,{operator:r.AND}),e.call(this,i,s),this.isValid()};return t.inherits(n,e),n.prototype.validate=function(e){var n=[r.AND,r.OR];return t.isString(e.property)?e.value?-1===t.indexOf(n,e.operator)?new i("operator",e.operator+" is not a valid query operator. Valid operators include: '"+n.join("', '")+"'."):void 0:new i("value","Value is not defined."):new i("property",e.property+" is not a valid query property")},n.prototype.toString=function(){return this.isValid(),this.get("property")+":"+this.get("value")},n}),r("aeris/api/params/collections/chainedqueries",["aeris/util","aeris/collection","aeris/api/params/models/query","aeris/api/operator"],function(t,e,i,r){var n=function(r,n){var s=t.defaults(n||{},{model:i});e.call(this,r,s)};return t.inherits(n,e),n.prototype.toString=function(){var t={};return t[r.AND]=",",t[r.OR]=";",this.reduce(function(e,i,r){var n=t[i.get("operator")];return 0!==r&&(e+=n),e+i.toString()},"",this)},n}),r("aeris/errors/unimplementedmethoderror",["aeris/errors/errortypefactory"],function(t){return new t({name:"UnimplementedMethodError"})}),r("aeris/helpers/validator/abstractvalidator",["aeris/util","aeris/errors/unimplementedmethoderror"],function(t,e){var i=function(){this.lastError_=null};return i.prototype.isValid=function(){throw new e("ValidatorInterface#isValid")},i.prototype.getLastError=function(){return this.lastError_},i.prototype.clearLastError_=function(){this.lastError_=null},i.prototype.setLastError_=function(t){this.lastError_=t},i}),r("aeris/helpers/validator/boundsvalidator",["aeris/util","aeris/helpers/validator/abstractvalidator","aeris/errors/validationerror"],function(t,e,i){var r=function(t){this.bounds_=t,e.apply(this,arguments)};return t.inherits(r,e),r.prototype.isValid=function(){function t(t){e||(e=t)}var e=null;return this.clearLastError_(),t(this.validateArea_()),this.hasCoordinates_()||t(this.createValidationError_("Invalid bounds coordinates")),this.setLastError_(e),!e},r.prototype.createValidationError_=function(t){return new i("bounds",t)},r.prototype.hasCoordinates_=function(){return t.isArray(this.getSW_())&&t.isArray(this.getNE_())},r.prototype.validateArea_=function(){var t,e=null;try{t=this.getAreaOfBounds_()}catch(i){var r="Unable to calculate bounds area: "+i.message;e=e||this.createValidationError_(r)}return(!t||0>=t)&&(e=e||this.createValidationError_("Bounds must define an area.")),e},r.prototype.getSW_=function(){return this.bounds_[0]},r.prototype.getNE_=function(){return this.bounds_[1]},r.prototype.getAreaOfBounds_=function(){var t,e,i,r;return t=this.bounds_[0],e=this.bounds_[1],i=Math.abs(e[0]-t[0]),r=Math.abs(e[1]-t[1]),r*i},r}),r("aeris/api/params/models/params",["aeris/util","aeris/config","aeris/model","aeris/api/params/collections/filtercollection","aeris/api/params/collections/chainedqueries","aeris/errors/validationerror","aeris/helpers/validator/boundsvalidator"],function(t,e,i,r,n,s,o){var a=function(s,o){var a=t.defaults(o||{},{FilterCollectionType:r,QueryType:n,validate:!0}),l=t.defaults(s||{},{p:null,filter:[],query:[],client_id:e.get("apiId"),client_secret:e.get("apiSecret")});this.QueryType_=a.QueryType,this.FilterCollectionType_=a.FilterCollectionType,l.query instanceof this.QueryType_||(l.query=new this.QueryType_(l.query)),l.filter instanceof this.FilterCollectionType_||(l.filter=new this.FilterCollectionType_(l.filter)),i.call(this,l,a),this.proxyEventsForAttr_("query"),this.proxyEventsForAttr_("filter"),this.bindToApiKeys_()};return t.inherits(a,i),a.prototype.validate=function(t){var e=this.validatePlace_(t.p);return e?e:!t.query||t.query instanceof this.QueryType_?void 0:new s("query",t.query+" is not a valid Query")},a.prototype.bindToApiKeys_=function(){this.listenTo(e,"change:apiId change:apiSecret",function(){this.set({client_id:this.get("client_id")||e.get("apiId"),client_secret:this.get("client_secret")||e.get("apiSecret")})})},a.prototype.validatePlace_=function(e){var i,r=void 0,n=t.isString(e),s=t.isNumeric(e),o=t.isArray(e)&&t.isNumeric(e[0]);return t.isNull(e)?r:n?r:s?r:o?r:(i=this.validateBounds_(e),i?i:void 0)},a.prototype.validateBounds_=function(t){var e=new o(t);return e.isValid()?void 0:e.getLastError()},a.prototype.toJSON=function(){var e=i.prototype.toJSON.apply(this,arguments);return t.each(e,function(i,r){var n=t.isArray(i)&&!i.length;return t.isNull(i)||t.isUndefined(i)||n?void delete e[r]:void(i instanceof Date&&(e[r]=Math.ceil(i.getTime()/1e3)))}),this.get("filter")&&(e.filter=this.get("filter").toString()),this.get("query")&&(e.query=this.get("query").toString()),t.isArray(this.get("p"))&&(e.p=this.get("p").join(",")),e},a.prototype.setBounds=function(e){return t.isNull(e)?void this.unset("p"):void this.set({p:e},{validate:!0})},a.prototype.addFilter=function(t,e){this.get("filter").add(t,e)},a.prototype.removeFilter=function(t,e){this.get("filter").remove(t,e)},a.prototype.resetFilter=function(t,e){this.get("filter").reset(t,e)},a.prototype.addQuery=function(t,e){this.get("query").add(t,e)},a.prototype.removeQuery=function(t,e){this.get("query").remove(t,e)},a.prototype.resetQuery=function(t,e){this.get("query").reset(t,e)},a.prototype.getQuery=function(){return this.get("query")},a.prototype.proxyEventsForAttr_=function(t){this.get(t)&&this.get(t).on&&this.listenTo(this.get(t),"add remove change reset",function(e,i){this.trigger("change:"+t,this,this.get(t),i),this.trigger("change",this,i)})},a}),r("aeris/errors/apiresponseerror",["aeris/errors/errortypefactory"],function(t){return new t({name:"APIResponseError"})}),r("aeris/api/mixins/aerisapibehavior",["aeris/util","aeris/model","aeris/promise","aeris/api/params/models/params","aeris/errors/invalidargumenterror","aeris/errors/apiresponseerror"],function(t,e,i,r,n,s){return{createParams_:function(t){return t instanceof e?t:new r(t,{validate:!0})},getParams:function(){return this.params_},setParams:function(t,e){var i=Array.prototype.slice.call(arguments,0);i.push({validate:!0}),this.params_.set.apply(this.params_,i)},setFrom:function(t){this.setParams("from",t)},setTo:function(t){this.setParams("to",t)},setLimit:function(t){this.setParams("limit",t)},setBounds:function(t){this.params_.setBounds(t)},addFilter:function(t,e){this.params_.addFilter(t,e)},removeFilter:function(t,e){this.params_.removeFilter(t,e)},resetFilter:function(t,e){this.params_.resetFilter(t,e)},addQuery:function(t,e){this.params_.addQuery(t,e)},removeQuery:function(t,e){this.params_.removeQuery(t,e)},resetQuery:function(t,e){this.params_.resetQuery(t,e)},getQuery:function(){return this.params_.getQuery()},sync:function(e,r,s){var o,a=function(){},l=new i,u=t.defaults(s||{},{success:a,error:a,complete:a});if("read"!==e)throw new n("Unable to send a "+e+" request to the Aeris API. The Aeris API is read-only");return this.trigger("request",this,l,u),o=this.serializeParams_(this.params_),this.jsonp_.get(this.getEndpointUrl_(),o,t.bind(function(t){this.isSuccessResponse_(t)?(l.resolve(t),
this.trigger("sync",this,t,u)):l.reject(this.createErrorFromResponse_(t))},this)),l.done(u.success).fail(u.error).always(u.complete)},isSuccessResponse_:function(t){return!t.error},createErrorFromResponse_:function(t){var e;try{e=new s(t.error.description),e.code=t.error.code,e.responseObject=t}catch(i){e=new s(i.message)}return e},serializeParams_:function(t){return t.toJSON()},getEndpointUrl_:function(){return t.compact([this.server_,this.endpoint_,this.action_]).join("/")+"/"},getEndpoint:function(){return this.endpoint_},getAction:function(){return this.action_},setAction:function(t){this.action_=t},parse:function(t){return t.response?t.response:t}}}),r("aeris/jsonp",["aeris/util"],function(t){return t.provide("aeris.jsonp"),aeris.jsonp=function(){function e(t,e){var i=document.createElement("script"),r=!1;i.src=t,i.async=!0;var n=e||a.error;"function"==typeof n&&(i.onerror=function(e){n({url:t,event:e})}),i.onload=i.onreadystatechange=function(){r||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(r=!0,i.onload=i.onreadystatechange=null,i&&i.parentNode&&i.parentNode.removeChild(i))},s||(s=document.getElementsByTagName("head")[0]),s.appendChild(i)}function i(t){return encodeURIComponent(t)}function r(r,n,s,l,u){var c,p=-1===(r||"").indexOf("?")?"?":"&";u=u||a.callbackName||"callback",l=l||u+t.uniqueId("_aeris_jsonp_"),n=n||{};for(c in n)n.hasOwnProperty(c)&&(p+=i(c)+"="+i(n[c])+"&");return o[l]=function(t){s(t);try{delete o[l]}catch(e){}o[l]=null},e(r+p+u+"="+l),l}function n(t){a=t}var s,o=this,a={};return{get:r,init:n}}(),aeris.jsonp}),r("aeris/api/collections/aerisapicollection",["aeris/util","aeris/collection","aeris/api/mixins/aerisapibehavior","aeris/jsonp"],function(t,e,i,r){var n=function(i,n){var s=t.extend({endpoint:"",action:"",params:{},server:"//api.aerisapi.com",jsonp:r},n);this.endpoint_=s.endpoint,this.action_=s.action,this.server_=s.server,this.params_=this.createParams_(s.params),this.jsonp_=s.jsonp,e.call(this,i,s)};return t.inherits(n,e),t.extend(n.prototype,i),n.prototype.parse=function(t){var e=i.parse.call(this,t),r=e.map(this.model.prototype.parse);return r},t.expose(n,"aeris.api.AerisApiCollection")}),r("aeris/api/models/aerisapimodel",["aeris/util","aeris/api/mixins/aerisapibehavior","aeris/model","aeris/jsonp"],function(t,e,i,r){var n=function(e,n){var s=t.defaults(n||{},{endpoint:"",action:"",params:{},jsonp:r,server:"//api.aerisapi.com"});this.endpoint_=s.endpoint,this.action_=s.action,this.server_=s.server,this.jsonp_=s.jsonp||r,this.params_=this.createParams_(s.params),i.call(this,e,s)};return t.inherits(n,i),t.extend(n.prototype,e),n.prototype.getEndpointUrl_=function(){var t=e.getEndpointUrl_.call(this);return this.id&&(t+=this.id),t},n.prototype.testFilter=function(t){return!0},n.prototype.testFilterCollection=function(e){return e.reduce(function(e,i){var r=t.isNull(e),n=this.testFilter(i.id),s=n&&e,o=n||e;return r?n:i.isAnd()?s:o},null,this)},n.prototype.parse=function(e){var i;return i=t.isArray(e)?e[0]:e.response?t.isArray(e.response)?e.response[0]:e.response:e,i||{}},t.expose(n,"aeris.api.models.AerisApiModel")}),r("aeris/api/models/pointdata",["aeris/util","aeris/errors/validationerror","aeris/errors/apiresponseerror","aeris/api/models/aerisapimodel"],function(t,e,i,r){var n=function(e,i){var n=t.extend({validate:!0},i);r.call(this,e,n)};return t.inherits(n,r),n}),r("aeris/api/collections/pointdatacollection",["aeris/util","aeris/api/collections/aerisapicollection","aeris/api/models/pointdata"],function(t,e,i){var r=function(r,n){var s=t.extend({validate:!0,model:i,params:{}},n);t.defaults(s.params,{limit:100,p:":auto",radius:"3000mi"}),e.call(this,r,s)};return t.inherits(r,e),r}),r("aeris/subsetcollection",["aeris/util","aeris/collection","aeris/promise","aeris/errors/invalidargumenterror"],function(t,e,i,r){var n=function(i,r){var n=t.defaults(r||{},{limit:null,filter:null});this.sourceCollection_=this.normalizeSourceCollection_(i),this.limit_=n.limit,this.filter_=n.filter,e.call(this,this.getFilteredSourceModels_(),n),this.bindToSourceCollection_(),this.proxyRequestEvents_()};return t.inherits(n,e),n.prototype.normalizeSourceCollection_=function(i){if(i instanceof e)return i;if(t.isArray(i))return new e(i);throw new r(i+" is not a valid source collection")},n.prototype.proxyRequestEvents_=function(){this.listenTo(this.sourceCollection_,{request:function(t,e){this.trigger("request",t,e)},sync:function(t,e){this.trigger("sync",t,e)},error:function(t,e){this.trigger("error",t,e)}})},n.prototype.bindToSourceCollection_=function(){this.listenTo(this.sourceCollection_,{"reset change sort":this.resetToSourceModel_,remove:function(e,i,r){var n;this.contains(e)&&(this.remove(e),this.limit_&&this.isUnderLimit()&&(n=this.getFilteredSourceModels_(),this.add(t.last(n))))},add:function(e,i,r){var n,s,o=t.isNull(this.filter_)||this.filter_(e);o&&(n=t.isUndefined(r.at),n&&this.isUnderLimit()?this.add(e):(s=this.getFilteredSourceModels_(),t.contains(s,e)&&(this.add(e,{at:s.indexOf(e)}),this.isOverLimit()&&this.pop())))}})},n.prototype.resetToSourceModel_=function(){this.set(this.getFilteredSourceModels_())},n.prototype.getFilteredSourceModels_=function(){var e=t.isNull(this.filter_)?this.sourceCollection_.models:this.sourceCollection_.filter(this.filter_),i=t.isNull(this.limit_)?e.length:this.limit_,r=e.slice(0,i);return r},n.prototype.getSourceCollection=function(){return this.sourceCollection_},n.prototype.setFilter=function(e,i){this.filter_=e,i&&!t.isNull(e)&&(this.filter_=t.bind(this.filter_,i)),this.resetToSourceModel_()},n.prototype.removeFilter=function(){this.setFilter(null),this.resetToSourceModel_()},n.prototype.setLimit=function(t){this.limit_=t,this.resetToSourceModel_()},n.prototype.removeLimit=function(){this.limit_=null,this.resetToSourceModel_()},n.prototype.isUnderLimit=function(){return t.isNull(this.limit_)||this.length<this.limit_},n.prototype.isOverLimit=function(){var t=this.length===this.sourceCollection_.length;return!this.isUnderLimit()&&!t},n.prototype.fetch=function(t){return this.sourceCollection_.fetch(t)},n}),r("aeris/api/collections/aerisapiclientcollection",["aeris/util","aeris/subsetcollection","aeris/api/collections/aerisapicollection"],function(t,e,i){var r=function(r,n){var s=t.defaults(n||{},{SourceCollectionType:i,clientLimit:null,clientFilter:t.constant(!0)}),o=t.pick(s,["params","endpoint","action","model","server","SourceCollectionType"]),a=this.createSourceCollection_(r,o),l={limit:s.clientLimit,filter:s.clientFilter};e.call(this,a,l),this.bindClientFilters_(),this.updateClientFilters_()};t.inherits(r,e),r.prototype.createSourceCollection_=function(e,i){return new i.SourceCollectionType(e,t.pick(i||{},["params","endpoint","action","model","server"]))},r.prototype.bindClientFilters_=function(){this.listenTo(this.getApiFilters_(),{"add remove reset change":this.updateClientFilters_})},r.prototype.updateClientFilters_=function(){this.getApiFilters_().length?this.applyClientFilters_(this.getApiFilters_()):this.removeClientFilter()},r.prototype.applyClientFilters_=function(t){this.setClientFilter(function(e){return e.testFilterCollection(t)},this)},r.prototype.getApiFilters_=function(){return this.sourceCollection_.getParams().get("filter")},r.prototype.setClientFilter=function(t,i){e.prototype.setFilter.call(this,t,i)},r.prototype.removeClientFilter=function(){e.prototype.removeFilter.call(this)},r.prototype.setClientLimit=function(t){e.prototype.setLimit.call(this,t)},r.prototype.removeClientLimit=function(){e.prototype.removeLimit.call(this)};var n=["getParams","setParams","setFrom","setTo","setBounds","addFilter","removeFilter","resetFilter","addQuery","removeQuery","resetQuery","getQuery","setAction","getAction"];return t.each(n,function(t){r.prototype[t]=function(){return this.sourceCollection_[t].apply(this.sourceCollection_,arguments)}},this),r}),r("aeris/api/models/earthquake",["aeris/util","aeris/api/models/pointdata","aeris/errors/apiresponseerror"],function(t,e,i){var r=function(t,i){e.call(this,t,i)};return t.inherits(r,e),r.prototype.parse=function(t){var r=e.prototype.parse.apply(this,arguments);if(!t.report||!t.report.id)throw new i("Missing earthquake id");return r.id=t.report.id,r},r.prototype.testFilter=function(t){return"shallow"===t?this.isShallow():t===this.getAtPath("report.type")},r.prototype.isShallow=function(){return this.getAtPath("report.depthKM")<70},t.expose(r,"aeris.api.models.Earthquake")}),r("aeris/datehelper",["aeris/util"],function(t){var e=1,i=1e3*e,r=60*i,n=60*r,s=24*n,o=7*s,a=function(t){this.date_=t||new Date};return a.prototype.addMilliseconds=function(t){return this.date_.setTime(this.date_.getTime()+t),this},a.prototype.addSeconds=function(t){return this.addMilliseconds(t*i)},a.prototype.addMinutes=function(t){return this.addMilliseconds(t*r)},a.prototype.addHours=function(t){return this.addMilliseconds(t*n)},a.prototype.addDays=function(t){return this.addMilliseconds(t*s)},a.prototype.addWeeks=function(t){return this.addMilliseconds(t*o)},a.prototype.addTime=function(e,i,r,n){var s=t.isUndefined(i)?0:i,o=t.isUndefined(r)?0:r,a=t.isUndefined(n)?0:n;return this.addHours(e).addMinutes(s).addSeconds(o).addMilliseconds(a)},a.prototype.getDate=function(){return this.date_},a.prototype.getTime=function(){return this.date_.getTime()},a.prototype.setDate=function(t){return this.date_=t||new Date,this},t.expose(a,"aeris.DateHelper")}),r("aeris/api/collections/earthquakes",["aeris/util","aeris/api/collections/pointdatacollection","aeris/api/collections/aerisapiclientcollection","aeris/api/models/earthquake","aeris/datehelper"],function(t,e,i,r,n){var s=function(s,o){var a=t.defaults(o||{},{params:{},model:r,endpoint:"earthquakes",action:"within",SourceCollectionType:e});t.defaults(a.params,{from:(new n).addWeeks(-7).getDate(),to:new Date,radius:"3000miles"}),i.call(this,s,a)};return t.inherits(s,i),t.expose(s,"aeris.api.collections.Earthquakes")}),r("aeris/maps/markers/pointdatamarker",["aeris/util","aeris/maps/markers/marker","aeris/config"],function(t,e,i){var r=function(i,r){var n=t.defaults(i||{},{offsetX:12,offsetY:12}),s=t.defaults(r||{},{iconPath:"{name}",iconLookup:{},typeAttribute:""});s.attributeTransforms=t.defaults(s.attributeTransforms||{},{url:this.lookupUrl_,selectedUrl:this.lookupSelectedUrl_,title:this.lookupTitle_,position:this.lookupPosition_,type:this.lookupType_,offsetX:this.lookupOffsetX_,offsetY:this.lookupOffsetY_}),this.iconPath_=s.iconPath,this.selectedIconPath_=s.selectedIconPath||s.iconPath,this.iconLookup_=s.iconLookup,this.typeAttribute_=s.typeAttribute,e.call(this,n,s)};return t.inherits(r,e),r.prototype.getType=function(){return this.get("type")},r.prototype.lookupType_=function(){var e,i=this.getDataAttribute(this.typeAttribute_);return t.isArray(i)?(t.each(i,function(i){t.has(this.iconLookup_,i)&&(e=i)},this),e||this.get("type")):i||this.get("type")},r.prototype.lookupUrl_=function(){var t=this.getIconConfig_();return t?this.iconPath_.replace(/\{name\}/,t.url):this.get("url")},r.prototype.lookupSelectedUrl_=function(){var t,e=this.getIconConfig_();return e?(t=e.selectedUrl||e.url,this.selectedIconPath_.replace(/\{name\}/,t)):this.get("selectedUrl")},r.prototype.lookupOffsetX_=function(){var t=this.getIconConfig_();return t?t.offsetX:this.get("offsetX")},r.prototype.lookupOffsetY_=function(){var t=this.getIconConfig_();return t?t.offsetY:this.get("offsetY")},r.prototype.getIconConfig_=function(){var t=this.lookupType_();return this.iconLookup_[t]},r.prototype.lookupTitle_=function(){return""},r.prototype.lookupPosition_=function(){var t=this.getDataAttribute("loc");return t?[t.lat,t["long"]]:this.get("position")},r}),r("aeris/maps/markers/earthquakemarker",["aeris/util","aeris/config","aeris/maps/markers/pointdatamarker","aeris/maps/markers/config/iconlookup"],function(t,e,i,r){var n=function(n,s){var o=t.extend({url:e.get("assetPath")+"quake_minor.png"},n),a=t.extend({iconLookup:r.earthquake,typeAttribute:"report.type"},s);i.call(this,o,a)};return t.inherits(n,i),n.prototype.lookupTitle_=function(){var e=this.getDataAttribute("report.mag");return t.isUndefined(e)?"Earthquake":"Magnitute "+e.toFixed(1)+" Earthquake."},t.expose(n,"aeris.maps.markers.EarthquakeMarker")}),r("aeris/maps/markercollections/earthquakemarkers",["aeris/util","aeris/maps/markercollections/pointdatamarkers","aeris/api/collections/earthquakes","aeris/maps/markers/earthquakemarker","aeris/maps/markercollections/config/clusterstyles"],function(t,e,i,r,n){var s=function(s,o){var a=t.extend({data:new i,model:r,clusterStyles:n.earthquake},o);e.call(this,s,a)};return t.inherits(s,e),t.expose(s,"aeris.maps.markercollections.EarthquakeMarkers")}),r("aeris/maps/markers/firemarker",["aeris/util","aeris/config","aeris/maps/markers/pointdatamarker","aeris/maps/markers/config/iconlookup"],function(t,e,i,r){var n=function(e,n){var s=t.extend({url:r.fire.defaultStyles.url,offsetX:r.fire.defaultStyles.offsetX,offsetY:r.fire.defaultStyles.offsetY},e);i.call(this,s,n)};return t.inherits(n,i),n.prototype.lookupTitle_=function(){var t=this.getDataAttribute("report.cause");return t?"Fire caused by "+t:"Fire"},t.expose(n,"aeris.maps.markers.FireMarker")}),r("aeris/api/models/fire",["aeris/util","aeris/api/models/pointdata","aeris/errors/apiresponseerror"],function(t,e,i){var r=function(i,r){var n=t.defaults(r||{},{params:{from:"today"}});e.call(this,i,n)};return t.inherits(r,e),r.prototype.parse=function(t){var r=e.prototype.parse.apply(this,arguments);if(!t.report||!t.report.id)throw new i("Missing fire report id");return r.id=t.report.id,r},t.expose(r,"aeris.api.models.Fire")}),r("aeris/api/collections/fires",["aeris/util","aeris/api/collections/pointdatacollection","aeris/api/collections/aerisapiclientcollection","aeris/api/models/fire"],function(t,e,i,r){var n=function(n,s){var o=t.defaults(s||{},{params:{limit:500,query:[{property:"type",value:"L"}]},model:r,endpoint:"fires",action:"search",SourceCollectionType:e});i.call(this,n,o)};return t.inherits(n,i),t.expose(n,"aeris.api.collections.Fires")}),r("aeris/maps/markercollections/firemarkers",["aeris/util","aeris/maps/markercollections/pointdatamarkers","aeris/maps/markers/firemarker","aeris/api/collections/fires","aeris/maps/markercollections/config/clusterstyles"],function(t,e,i,r,n){var s=function(s,o){var a=t.extend({model:i,data:new r,clusterStyles:n.fire},o);e.call(this,s,a)};return t.inherits(s,e),t.expose(s,"aeris.maps.markercollections.FireMarkers")}),r("aeris/api/models/lightning",["aeris/util","aeris/api/models/pointdata","aeris/errors/apiresponseerror"],function(t,e,i){var r=function(t,i){e.call(this,t,i)};return t.inherits(r,e),r.prototype.parse=function(t){try{t.id=""+t.loc.lat+t.loc["long"]+t.obTimestamp}catch(e){throw e instanceof ReferenceError?new i("Unable to determine Lightning id: "+e.message):e}return t},t.expose(r,"aeris.api.models.Lightning")}),r("aeris/api/collections/lightning",["aeris/util","aeris/api/collections/pointdatacollection","aeris/api/collections/aerisapiclientcollection","aeris/api/models/lightning"],function(t,e,i,r){var n=function(n,s){var o=t.defaults(s||{},{params:{},model:r,endpoint:"lightning",action:"within",SourceCollectionType:e});t.defaults(o.params,{limit:250,sort:"dt:-1"}),i.call(this,n,o)};return t.inherits(n,i),t.expose(n,"aeris.api.collections.Lightning")}),r("aeris/maps/markers/lightningmarker",["aeris/util","aeris/config","aeris/maps/markers/pointdatamarker","aeris/maps/markers/config/iconlookup","aeris/util/findclosest"],function(t,e,i,r,n){var s=r.lightning,o=function(e,r){var n=t.defaults(r||{},{iconLookup:s});i.call(this,e,n)};return t.inherits(o,i),o.prototype.lookupType_=function(){var e,i,r;if(e=Object.keys(this.iconLookup_).sort(),!this.getDataAttribute("obTimestamp"))return t.last(e);i=Date.now()-1e3*this.getDataAttribute("obTimestamp"),r=i/6e4;var n=e.reduceRight(function(t,e){return e=parseInt(e),e>=r?e:t},e[0]);return parseInt(n)},o.prototype.lookupTitle_=function(){return"Lightning"},t.expose(o,"aeris.maps.markers.LightningMarker")}),r("aeris/maps/markercollections/lightningmarkers",["aeris/util","aeris/maps/markercollections/pointdatamarkers","aeris/api/collections/lightning","aeris/maps/markers/lightningmarker","aeris/maps/markercollections/config/clusterstyles"],function(t,e,i,r,n){var s=function(s,o){var a=t.extend({data:new i,model:r,clusterStyles:n.lightning},o);e.call(this,s,a)};return t.inherits(s,e),t.expose(s,"aeris.maps.markercollections.LightningMarkers")}),r("aeris/api/models/stormreport",["aeris/util","aeris/api/models/pointdata"],function(t,e){var i=function(t,i){e.call(this,t,i),this.listenTo(this,{"change:report":function(){var t=res.report.type.split(" ");this.set("stormtypes",t)}})};return t.inherits(i,e),i.prototype.parse=function(t){var i=e.prototype.parse.apply(this,arguments);return i.id=t.id,i.stormtypes=t.report.type.split(" "),i},i.prototype.testFilter=function(e){return t.contains(this.get("stormtypes"),e)},t.expose(i,"aeris.api.models.StormReport")}),r("aeris/api/collections/stormreports",["aeris/util","aeris/api/collections/pointdatacollection","aeris/api/collections/aerisapiclientcollection","aeris/api/models/stormreport","aeris/datehelper"],function(t,e,i,r,n){var s=function(s,o){var a=t.defaults(o||{},{params:{from:(new n).addDays(-2).getDate(),to:new Date,limit:100},endpoint:"stormreports",action:"within",model:r,SourceCollectionType:e});i.call(this,s,a)};return t.inherits(s,i),t.expose(s,"aeris.api.collections.StormReports")}),r("aeris/maps/markers/stormreportmarker",["aeris/util","aeris/config","aeris/maps/markers/pointdatamarker","aeris/maps/markers/config/iconlookup"],function(t,e,i,r){var n=function(n,s){var o=t.extend({url:e.get("assetPath")+"marker_yellow.png"},n),a=t.extend({iconLookup:r.stormReport,typeAttribute:"stormtypes"},s);i.call(this,o,a)};return t.inherits(n,i),n.prototype.lookupTitle_=function(){var t=this.getDataAttribute("report.type"),e=this.getDataAttribute("report.name");return t&&e?(t=t.charAt(0).toUpperCase()+t.slice(1),t&&e?t+": "+e:"Storm report"):this.get("title")},t.expose(n,"aeris.maps.markers.StormReportMarker")}),r("aeris/maps/markercollections/stormreportmarkers",["aeris/util","aeris/maps/markercollections/pointdatamarkers","aeris/api/collections/stormreports","aeris/maps/markers/stormreportmarker","aeris/maps/markercollections/config/clusterstyles"],function(t,e,i,r,n){var s=function(s,o){var a=t.extend({data:new i,model:r,clusterStyles:n.stormReport},o);e.call(this,s,a)};return t.inherits(s,e),t.expose(s,"aeris.maps.markercollections.StormReportMarkers")}),r("aeris/maps/strategy/markers/stormcells",["aeris/util","aeris/maps/abstractstrategy","leaflet","aeris/maps/strategy/util"],function(t,e,i,r){var n=function(t){e.call(this,t)};return t.inherits(n,e),n.prototype.createView_=function(){return new i.geoJson(this.object_.toGeoJson(),{pointToLayer:function(t,e){return new i.CircleMarker(e)}.bind(this),onEachFeature:this.initializeFeature_.bind(this)})},n.prototype.setMap=function(t){e.prototype.setMap.call(this,t),this.view_.addTo(this.mapView_)},n.prototype.beforeRemove_=function(){this.mapView_.removeLayer(this.view_)},n.prototype.initializeFeature_=function(t,e){var n=function(t){return function(e){this.object_.trigger(t,r.toAerisLatLon(e.latlng),this.object_)}},s=this.object_.getStyle(t.properties);this.setLayerStyle(e,s),e.on({click:n("click").bind(this),mouseover:n("mouseover").bind(this),mouseout:n("mouseout").bind(this)}),e.on({mouseover:function(t){this.setLayerStyle(e,{cell:s.cell.hover,cone:s.cone.hover,line:s.line.hover}),i.Browser.ie||i.Browser.opera||e.bringToFront()}.bind(this),mouseout:function(t){this.setLayerStyle(e,s)}.bind(this)})},n.prototype.setLayerStyle=function(t,e){t.getLayers().forEach(function(t){t instanceof i.CircleMarker?t.setStyle(e.cell):t instanceof i.Polygon?t.setStyle(e.cone):t instanceof i.Polyline&&t.setStyle(e.line)},this)},n}),r("aeris/maps/markers/stormcellmarker",["aeris/util","aeris/maps/extensions/mapextensionobject","aeris/maps/strategy/markers/stormcells"],function(t,e,i){var r=function(r,n){var s=t.defaults(n||{},{strategy:i,style:this.getStyleDefault_.bind(this)});this.getStyle=t.isFunction(s.style)?s.style:t.constant(s.style),e.call(this,r,s)};return t.inherits(r,e),r.prototype.toGeoJson=function(){return this.getData().toJSON()},r.prototype.getStyleDefault_=function(e){var i={cell:{radius:4,fillColor:"#3bca24",color:"#000",weight:1,opacity:1,fillOpacity:.8,hover:{radius:7,fillOpacity:1}},cone:{stroke:!0,color:"#030303",weight:1,opacity:.8,fillColor:"#f66",fillOpacity:.2,hover:{weight:2,fillOpacity:.8,fillColor:"#f66"}},line:{stroke:!0,color:"#030303",weight:1,opacity:.8,hover:{}}},r={tornado:{radius:5,fillColor:"red"},hail:{radius:5,fillColor:"yellow"},rotating:{radius:5,fillColor:"orange"}},n=t.path("traits.type",e);return r[n]&&t.extend(i.cell,r[n]),i},r}),r("aeris/api/models/geojsonfeature",["aeris/util","aeris/api/models/aerisapimodel"],function(t,e){var i=function(t,i){e.call(this,t,i)};return t.inherits(i,e),i.prototype.parse=function(t){return t.id=t.properties.id,t},i}),r("aeris/api/collections/geojsonfeaturecollection",["aeris/util","aeris/api/collections/aerisapicollection","aeris/api/models/geojsonfeature","aeris/promise","jquery"],function(t,e,i,r,n){var s=function(r,n){var s=r?this.parse(r):null,o=t.defaults(n||{},{model:i});o.params=t.extend({},o.params||{},{format:"geojson"}),e.call(this,s,o)};return t.inherits(s,e),s.prototype.parse=function(t){var i=t.features;return e.prototype.parse.call(this,i)},s.prototype.toGeoJson=function(){return{type:"FeatureCollection",features:this.toJSON()}},s.prototype.isSuccessResponse_=function(t){return!t.error},t.expose(s,"aeris.api.collections.GeoJsonFeatureCollection")}),r("aeris/maps/markercollections/stormcellmarkers",["aeris/util","aeris/maps/markercollections/pointdatamarkers","aeris/maps/markers/stormcellmarker","aeris/api/collections/geojsonfeaturecollection"],function(t,e,i,r){var n=function(n,s){var o=t.defaults(s||{},{data:new r(null,{endpoint:"stormcells",action:"within",params:{p:":auto",radius:"3000mi",limit:1e3,fields:["id","place","loc","ob","forecast","traits"],sort:"tor:-1,mda:-1,hail:-1"}}),model:i,strategy:t.noop,clusterStrategy:null,cluster:!1});e.call(this,n,o)};return t.inherits(n,e),n.prototype.toGeoJson=function(){return this.data_.toGeoJson()},n.prototype.startClustering=function(){throw new Error("StormCellMarkers do not currently support clustering")},n}),r("aeris/packages/markers",["aeris/maps/markers/marker","aeris/maps/markercollections/earthquakemarkers","aeris/maps/markercollections/firemarkers","aeris/maps/markercollections/lightningmarkers","aeris/maps/markercollections/stormreportmarkers","aeris/maps/markercollections/stormcellmarkers"],function(){}),r("aeris/errors/missingapikeyerror",["aeris/errors/errortypefactory"],function(t){return new t({name:"MissingApiKeyError"})}),r("aeris/errors/timeouterror",["aeris/errors/errortypefactory"],function(t){return new t({name:"TimeoutError"})}),r("aeris/errors/unsupportedfeatureerror",["aeris/errors/errortypefactory"],function(t){return new t({name:"UnsupportedFeatureError"})}),r("aeris/api/getjson",["underscore","aeris/promise"],function(t,e){return function(i){var r=new e,n=new XMLHttpRequest;return n.open("GET",i,!0),n.onload=function(){if(n.status>=200&&n.status<400){try{var e=JSON.parse(n.responseText)}catch(s){return r.reject(s)}return r.resolve(e)}var s=t.extend(new Error("Request to "+i+" returned an HTTP error code"),{xhr:n});return r.reject(s)},n.onerror=r.reject,n.send(),r}}),r("aeris/maps/layers/config/zindex",{Radar:70,SatelliteGlobal:60,SatelliteVisible:60,Satellite:60,Advisories:45,Temps:40,WindChill:40,Winds:40,HeatIndex:40,Humidity:40,DewPoints:40,SnowDepth:30,Chlorophyll:10,SeaSurfaceTemps:10}),r("aeris/maps/strategy/layers/aeristile",["aeris/util","aeris/maps/strategy/layers/tile"],function(t,e){var i=function(t){e.call(this,t)};return t.inherits(i,e),i.prototype.getTileUrl_=function(){var t=e.prototype.getTileUrl_.call(this);return t.replace("{t}",this.object_.getAerisTimeString())},i}),r("aeris/util/timestring",[],function(){return{fromDate:function(e){return[e.getFullYear()].concat([e.getUTCMonth()+1,e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds()].map(function(e){return t(e,2)})).join("")}}}),r("aeris/maps/layers/aeristile",["aeris/util","aeris/config","aeris/promise","aeris/errors/validationerror","aeris/errors/missingapikeyerror","aeris/errors/timeouterror","aeris/errors/unsupportedfeatureerror","aeris/maps/layers/abstracttile","aeris/api/getjson","aeris/maps/layers/config/zindex","aeris/maps/strategy/layers/aeristile","aeris/util/timestring"],function(t,e,i,r,n,s,o,a,l,u,c,p){var h=function(i,r){var n=t.extend({strategy:c,validate:!0},r),s=t.defaults(i||{},{subdomains:["1","2","3","4"],server:"//maps{d}.aerisapi.com",maxZoom:27,minZoom:1,time:new Date(0),tileType:"",timeIndex:0,animationStep:1,autoUpdateInterval:h.updateIntervals.CURRENT,autoUpdate:!0,apiId:e.get("apiId"),apiSecret:e.get("apiSecret")});t.defaults(s,{zIndex:u[s.name]||1,futureTileType:s.tileType}),this.autoUpdateIntervalTimer_,this.loaded_=!1,a.call(this,s,n),this.bindToApiKeys_()};return t.inherits(h,a),h.prototype.initialize=function(){var t=function(){this.get("autoUpdate")?this.startAutoUpdate_():this.stopAutoUpdate_()}.bind(this);t(),this.on({"change:autoUpdate":t,"change:autoUpdateInterval":function(){this.stopAutoUpdate_(),this.startAutoUpdate_()}},this),a.prototype.initialize.apply(this,arguments)},h.prototype.bindToApiKeys_=function(){this.listenTo(e,"change:apiId change:apiSecret",function(){this.set({apiId:this.get("apiId")||e.get("apiId"),apiSecret:this.get("apiSecret")||e.get("apiSecret")})})},h.prototype.startAutoUpdate_=function(){this.autoUpdateIntervalTimer_=window.setInterval(function(){this.set("time",new Date(0)),this.trigger("autoUpdate")}.bind(this),this.get("autoUpdateInterval"))},h.prototype.stopAutoUpdate_=function(){this.autoUpdateIntervalTimer_&&window.clearInterval(this.autoUpdateIntervalTimer_)},h.prototype.validate=function(e){var i;return t.isString(e.tileType)?t.isNumber(e.autoUpdateInterval)?e.minZoom<1?new r("minZoom for Aeris Interactive tiles must be more than 0"):(i=e.time>new Date,i&&e.autoUpdate?new o("Auto update is not currently supported by for future tiles. Turn off auto update (tile.set('autoUpdate', false) before using future tiles."):a.prototype.validate.apply(this,arguments)):new r("autoUpdateInterval","not a valid number"):new r("tileType","not a valid string")},h.updateIntervals={RADAR:36e4,CURRENT:36e5,MODIS:864e5,SATELLITE:18e5,ADVISORIES:18e4},h.prototype.getUrl=function(){return this.ensureApiKeys_(),this.get("server")+"/"+this.get("apiId")+"_"+this.get("apiSecret")+"/"+this.getTileTypeEndpoint_()+"/{z}/{x}/{y}/{t}.png"},h.prototype.ensureApiKeys_=function(){if(this.set({apiId:this.get("apiId")||e.get("apiId"),apiSecret:this.get("apiSecret")||e.get("apiSecret")}),!this.get("apiId")||!this.get("apiSecret"))throw new n("Aeris API id and secret required to render interactive tiles.")},h.prototype.getTimestamp=function(){return this.get("time").getTime()},h.prototype.getAerisTimeString=function(){var t=this.get("time");return t.getTime()<=0?t.getTime():p.fromDate(t)},h.prototype.loadTileTimes=function(){var t=new i,e=this.get("tileType"),r=this.get("futureTileType"),n=e!==r,s=[];return s.push(this.loadTileTimesForEndpoint_(e)),n&&s.push(this.loadTileTimesForEndpoint_(r)),i.when(s).done(function(e,i){var r=e[0],n=(i?i[0]:[]).filter(function(t){return t>Date.now()});t.resolve(r.concat(n))}).fail(t.reject.bind(t)),t},h.prototype.loadTileTimesForEndpoint_=function(t){var e=new i,r=this.createTileTimesUrlForEndpoint_(t);return this.ensureApiKeys_(),l(r).done(function(t){var i;t.files||e.reject(new Error("Failed to load tile times: no time data was returned.")),i=this.parseTileTimes_(t),e.resolve(i)}.bind(this)).fail(function(i){return i.xhr&&401===i.xhr.status?(console.warn("Client does not have access to tile times for "+t),e.resolve([])):void e.reject(i)}),e},h.prototype.rejectAfterTimeout_=function(e,i,r){t.delay(function(){"pending"===e.getState()&&e.reject(new s(r))}.bind(this),i)},h.prototype.createTileTimesUrl_=function(){var t=this.get("tileType");return this.createTileTimesUrlForEndpoint_(t)},h.prototype.createFutureTileTimesUrl_=function(){var t=this.get("futureTileType");return this.createTileTimesUrlForEndpoint_(t)},h.prototype.createTileTimesUrlForEndpoint_=function(t){var e="{server}/{client_id}_{client_secret}/{tileType}.json",i=this.get("server").replace("{d}","");return e.replace("{server}",i).replace("{client_id}",this.get("apiId")).replace("{client_secret}",this.get("apiSecret")).replace("{tileType}",t)},h.prototype.parseTileTimes_=function(t){return t.files.map(function(t){return 1e3*t.timestamp})},h.prototype.getTileTypeEndpoint_=function(){var t=this.get("time")>new Date;return t?this.get("futureTileType"):this.get("tileType")},t.expose(h,"aeris.maps.layers.AerisTile")}),r("aeris/maps/layers/advisories",["aeris/util","aeris/maps/layers/aeristile"],function(t,e){var i=function(i,r){var n=t.extend({name:"Advisories",tileType:"alerts",autoUpdateInterval:e.updateIntervals.ADVISORIES},i);e.call(this,n,r)};return t.inherits(i,e),t.expose(i,"aeris.maps.layers.Advisories")}),r("aeris/maps/layers/chlorophyll",["aeris/util","aeris/maps/layers/aeristile"],function(t,e){var i=function(i,r){var n=t.extend({name:"Chlorophyll",tileType:"modis-chlo"},i);e.call(this,n,r)};return t.inherits(i,e),t.expose(i,"aeris.maps.layers.Chlorophyll")}),r("aeris/maps/layers/dewpoints",["aeris/util","aeris/maps/layers/aeristile"],function(t,e){var i=function(i,r){var n=t.extend({name:"DewPoints",tileType:"dew-points",autoUpdateInterval:e.updateIntervals.CURRENT},i);e.call(this,n,r)};return t.inherits(i,e),t.expose(i,"aeris.maps.layers.DewPoints")}),r("aeris/maps/layers/heatindex",["aeris/util","aeris/maps/layers/aeristile"],function(t,e){var i=function(i,r){var n=t.extend({name:"HeatIndex",tileType:"heat-index",autoUpdateInterval:e.updateIntervals.CURRENT},i);e.call(this,n,r)};return t.inherits(i,e),t.expose(i,"aeris.maps.layers.HeatIndex")}),r("aeris/maps/layers/humidity",["aeris/util","aeris/maps/layers/aeristile"],function(t,e){var i=function(i,r){var n=t.extend({name:"Humidity",tileType:"humidity",autoUpdateInterval:e.updateIntervals.CURRENT},i);e.call(this,n,r)};return t.inherits(i,e),t.expose(i,"aeris.maps.layers.Humidity")}),r("aeris/maps/layers/lightningstrikedensity",["aeris/util","aeris/maps/layers/aeristile"],function(t,e){var i=function(i,r){var n=t.extend({name:"Lightning Strike Density",tileType:"lightning-strike-density",autoUpdateInterval:e.updateIntervals.SATELLITE},i);e.call(this,n,r)};return t.inherits(i,e),t.expose(i,"aeris.maps.layers.LightningStrikeDensity")}),r("aeris/maps/layers/precip",["aeris/util","aeris/maps/layers/aeristile"],function(t,e){var i=function(i,r){var n=t.defaults(i||{},{name:"Precip",tileType:"precip",futureTileType:"frain",autoUpdateInterval:e.updateIntervals.CURRENT});e.call(this,n,r)};return t.inherits(i,e),t.expose(i,"aeris.maps.layers.Precip")}),r("aeris/maps/layers/qpf",["aeris/util","aeris/maps/layers/aeristile"],function(t,e){var i=function(i,r){var n=t.extend({name:"QPF",tileType:"fqpf",futureTileType:"fqpf",autoUpdateInterval:216e5},i);e.call(this,n,r)};return t.inherits(i,e),t.expose(i,"aeris.maps.layers.QPF")}),r("aeris/maps/layers/radar",["aeris/util","aeris/maps/layers/aeristile"],function(t,e){var i=function(i,r){var n=t.extend({name:"Radar",tileType:"radar",futureTileType:"frad",autoUpdateInterval:e.updateIntervals.RADAR},i);e.call(this,n,r)};return t.inherits(i,e),t.expose(i,"aeris.maps.layers.Radar")}),r("aeris/maps/layers/satellite",["aeris/util","aeris/maps/layers/aeristile"],function(t,e){var i=function(i,r){var n=t.extend({name:"Satellite",tileType:"satellite",futureTileType:"fsat",autoUpdateInterval:e.updateIntervals.SATELLITE
},i);e.call(this,n,r)};return t.inherits(i,e),t.expose(i,"aeris.maps.layers.Satellite")}),r("aeris/maps/layers/satelliteglobal",["aeris/util","aeris/maps/layers/aeristile"],function(t,e){var i=function(i,r){var n=t.extend({name:"SatelliteGlobal",tileType:"sat-global",futureTileType:"fsat",autoUpdateInterval:e.updateIntervals.SATELLITE},i);e.call(this,n,r)};return t.inherits(i,e),t.expose(i,"aeris.maps.layers.SatelliteGlobal")}),r("aeris/maps/layers/satellitevisible",["aeris/util","aeris/maps/layers/aeristile"],function(t,e){var i=function(i,r){var n=t.extend({name:"SatelliteVisible",tileType:"sat-vis-hires",autoUpdateInterval:e.updateIntervals.SATELLITE},i);e.call(this,n,r)};return t.inherits(i,e),t.expose(i,"aeris.maps.layers.SatelliteVisible")}),r("aeris/maps/layers/seasurfacetemps",["aeris/util","aeris/maps/layers/aeristile"],function(t,e){var i=function(i,r){var n=t.extend({name:"SeaSurfaceTemps",tileType:"modis-sst"},i);e.call(this,n,r)};return t.inherits(i,e),t.expose(i,"aeris.maps.layers.SeaSurfaceTemps")}),r("aeris/maps/layers/snowdepth",["aeris/util","aeris/maps/layers/aeristile"],function(t,e){var i=function(i,r){var n=t.extend({name:"SnowDepth",tileType:"snowdepth",autoUpdateInterval:e.updateIntervals.MODIS},i);e.call(this,n,r)};return t.inherits(i,e),t.expose(i,"aeris.maps.layers.SnowDepth")}),r("aeris/maps/layers/snowfallaccum",["aeris/util","aeris/maps/layers/aeristile"],function(t,e){var i=function(i,r){var n=t.extend({name:"SnowFallAccum",tileType:"fsnow",futureTileType:"fsnow",autoUpdateInterval:e.updateIntervals.MODIS},i);e.call(this,n,r)};return t.inherits(i,e),t.expose(i,"aeris.maps.layers.SnowFallAccum")}),r("aeris/maps/layers/temps",["aeris/util","aeris/maps/layers/aeristile"],function(t,e){var i=function(i,r){var n=t.extend({name:"Temps",tileType:"temperatures",futureTileType:"ftemps",autoUpdateInterval:e.updateIntervals.CURRENT},i);e.call(this,n,r)};return t.inherits(i,e),t.expose(i,"aeris.maps.layers.Temps")}),r("aeris/maps/layers/windchill",["aeris/util","aeris/maps/layers/aeristile"],function(t,e){var i=function(i,r){var n=t.extend({name:"WindChill",tileType:"windchill",autoUpdateInterval:e.updateIntervals.CURRENT},i);e.call(this,n,r)};return t.inherits(i,e),t.expose(i,"aeris.maps.layers.WindChill")}),r("aeris/maps/layers/winds",["aeris/util","aeris/maps/layers/aeristile"],function(t,e){var i=function(i,r){var n=t.extend({name:"Winds",tileType:"winds",futureTileType:"fwinds",autoUpdateInterval:e.updateIntervals.CURRENT},i);e.call(this,n,r)};return t.inherits(i,e),t.expose(i,"aeris.maps.layers.Winds")}),r("aeris/packages/layers/tilelayers",["aeris/maps/layers/advisories","aeris/maps/layers/chlorophyll","aeris/maps/layers/dewpoints","aeris/maps/layers/heatindex","aeris/maps/layers/humidity","aeris/maps/layers/lightningstrikedensity","aeris/maps/layers/precip","aeris/maps/layers/qpf","aeris/maps/layers/radar","aeris/maps/layers/satellite","aeris/maps/layers/satelliteglobal","aeris/maps/layers/satellitevisible","aeris/maps/layers/seasurfacetemps","aeris/maps/layers/snowdepth","aeris/maps/layers/snowfallaccum","aeris/maps/layers/temps","aeris/maps/layers/windchill","aeris/maps/layers/winds","aeris/maps/layers/osm"],function(){}),r("mapbox",["leaflet"],function(t){return t.mapbox}),r("aeris/maps/strategy/layers/mapbox",["aeris/util","aeris/maps/abstractstrategy","leaflet","mapbox"],function(t,e,i){var r=function(t,i){this.validateMapBoxDependencyExists_(),e.call(this,t,i)};return t.inherits(r,e),r.prototype.createView_=function(){var t=this.object_.get("mapBoxId");return new i.mapbox.TileLayer(t)},r.prototype.validateMapBoxDependencyExists_=function(){if(!i.mapbox)throw new Error("Aeris.js requires MapBox.js in order to use aeris.maps.layers.MapBox layers. See https://www.mapbox.com/mapbox.js.")},r.prototype.setMap=function(t){e.prototype.setMap.call(this,t),this.view_.addTo(t.getView())},r.prototype.beforeRemove_=function(){this.mapView_.removeLayer(this.view_)},r}),r("aeris/maps/layers/mapbox",["aeris/util","aeris/maps/layers/layer","aeris/maps/strategy/layers/mapbox"],function(t,e,i){var r=function(r,n){var s=t.defaults(n||{},{strategy:i});e.call(this,r,s)};return t.inherits(r,e),t.expose(r,"aeris.maps.layers.MapBox")}),r("aeris/packages/leaflet",["aeris/maps/map","aeris/packages/animations","aeris/packages/markers","aeris/packages/layers/tilelayers","aeris/maps/layers/mapbox","aeris/maps/strategy/map","aeris/maps/strategy/layers/aeristile","aeris/maps/strategy/layers/osm","aeris/maps/strategy/layers/mapbox","aeris/maps/strategy/markers/marker","aeris/maps/strategy/markers/markercluster"],function(){}),r("aeris/api/models/advisory",["aeris/util","aeris/api/models/aerisapimodel"],function(t,e){var i=function(i,r){var n=t.defaults(r||{},{endpoint:"advisories"});e.call(this,i,n)};return t.inherits(i,e),t.expose(i,"aeris.api.models.Advisory")}),r("aeris/api/collections/advisories",["aeris/util","aeris/api/collections/aerisapiclientcollection","aeris/api/models/advisory"],function(t,e,i){var r=function(r,n){var s=t.defaults(n||{},{endpoint:"advisories",action:"closest",model:i,params:{}});t.defaults(s.params,{p:":auto",limit:100,radius:"1000mi"}),e.call(this,r,s)};return t.inherits(r,e),t.expose(r,"aeris.api.collections.Advisories")}),r("aeris/api/models/normal",["aeris/util","aeris/api/models/aerisapimodel"],function(t,e){var i=function(i,r){var n=t.defaults(r||{},{endpoint:"normals",params:{}});t.defaults(n.params,{p:":auto"}),e.call(this,i,n)};return t.inherits(i,e),t.expose(i,"aeris.api.models.Normal")}),r("aeris/api/collections/normals",["aeris/util","aeris/api/collections/aerisapiclientcollection","aeris/api/models/normal"],function(t,e,i){var r=function(r,n){var s=t.defaults(n||{},{endpoint:"normals",action:"closest",model:i,params:{}});t.defaults(s.params,{p:":auto",limit:100,radius:"100mi"}),e.call(this,r,s)};return t.inherits(r,e),t.expose(r,"aeris.api.collections.Normals")}),r("aeris/api/models/observation",["aeris/util","aeris/api/models/aerisapimodel"],function(t,e){var i=function(i,r){var n=t.defaults(r||{},{endpoint:"observations"});e.call(this,i,n)};return t.inherits(i,e),t.expose(i,"aeris.api.models.Observation")}),r("aeris/api/collections/observations",["aeris/util","aeris/api/collections/aerisapiclientcollection","aeris/api/models/observation"],function(t,e,i){var r=function(r,n){var s=t.defaults(n||{},{endpoint:"observations",action:"closest",model:i,params:{}});t.defaults(s.params,{p:":auto",limit:100,radius:"1000mi"}),e.call(this,r,s)};return t.inherits(r,e),t.expose(r,"aeris.api.collections.Observations")}),r("aeris/api/models/place",["aeris/util","aeris/api/models/aerisapimodel"],function(t,e){var i=function(i,r){var n=t.defaults(r||{},{endpoint:"places"});e.call(this,i,n)};return t.inherits(i,e),t.expose(i,"aeris.api.models.Place")}),r("aeris/api/collections/places",["aeris/util","aeris/api/collections/aerisapiclientcollection","aeris/api/models/place"],function(t,e,i){var r=function(r,n){var s=t.defaults(n||{},{endpoint:"places",action:"closest",model:i,params:{}});t.defaults(s.params,{p:":auto",limit:100}),e.call(this,r,s)};return t.inherits(r,e),t.expose(r,"aeris.api.collections.Places")}),r("aeris/api/models/record",["aeris/util","aeris/api/models/aerisapimodel","aeris/datehelper"],function(t,e,i){var r=function(r,n){var s=t.defaults(n||{},{endpoint:"records",params:{}});t.defaults(s.params,{p:":auto",limit:100,radius:"100mi",from:(new i).addDays(-60).getDate()}),e.call(this,r,s)};return t.inherits(r,e),t.expose(r,"aeris.api.models.Record")}),r("aeris/api/collections/records",["aeris/util","aeris/api/collections/aerisapiclientcollection","aeris/api/models/record","aeris/datehelper"],function(t,e,i,r){var n=function(n,s){var o=t.defaults(s||{},{endpoint:"records",action:"closest",model:i,params:{}});t.defaults(o.params,{p:":auto",limit:100,radius:"100mi",from:(new r).addDays(-60).getDate()}),e.call(this,n,o)};return t.inherits(n,e),t.expose(n,"aeris.api.collections.Records")}),r("aeris/api/models/stormcell",["aeris/util","aeris/api/models/aerisapimodel"],function(t,e){var i=function(i,r){var n=t.defaults(r||{},{endpoint:"stormcells",params:{}});t.defaults(n.params,{p:":auto",limit:100,radius:"100mi"}),e.call(this,i,n)};return t.inherits(i,e),t.expose(i,"aeris.api.models.StormCell")}),r("aeris/api/collections/stormcells",["aeris/util","aeris/api/collections/aerisapiclientcollection","aeris/api/models/stormcell"],function(t,e,i){var r=function(r,n){var s=t.defaults(n||{},{endpoint:"stormcells",action:"closest",model:i,params:{}});t.defaults(s.params,{p:":auto",limit:100,radius:"3000mi"}),e.call(this,r,s)};return t.inherits(r,e),t.expose(r,"aeris.api.collections.StormCells")}),r("aeris/api/models/tide",["aeris/util","aeris/api/models/aerisapimodel"],function(t,e){var i=function(i,r){var n=t.defaults(r||{},{endpoint:"tides",params:{}});t.defaults(n.params,{p:":auto",limit:100,radius:"100mi"}),e.call(this,i,n)};return t.inherits(i,e),t.expose(i,"aeris.api.models.Tide")}),r("aeris/api/collections/tides",["aeris/util","aeris/api/collections/aerisapiclientcollection","aeris/api/models/tide"],function(t,e,i){var r=function(r,n){var s=t.defaults(n||{},{endpoint:"tides",action:"closest",model:i,params:{}});t.defaults(s.params,{p:":auto",limit:100,radius:"100mi"}),e.call(this,r,s)};return t.inherits(r,e),t.expose(r,"aeris.api.collections.Tides")}),r("aeris/api/models/aerisbatchmodel",["aeris/util","aeris/api/models/aerisapimodel","aeris/errors/apiresponseerror"],function(t,e,i){var r=function(t,i){this.modelsInOrder_=[],e.call(this,t,i)};return t.inherits(r,e),r.prototype.getEndpointUrl_=function(){return t.compact([this.server_,"batch",this.id]).join("/")},r.prototype.serializeParams_=function(e){return this.modelsInOrder_=this.getNestedModels_(),t.extend(e.toJSON(),{requests:this.getEncodedEndpoints_(this.modelsInOrder_)},this.getApiKeyParams_())},r.prototype.getNestedModels_=function(){return this.values().filter(this.isModel_.bind(this))},r.prototype.isModel_=function(t){return t instanceof e},r.prototype.getEncodedEndpoints_=function(t){var e=t.map(function(t){var e="/"+t.getEndpoint();return[e,this.encodeModelParams_(t)].join(encodeURIComponent("?"))},this);return e.join(",")},r.prototype.encodeModelParams_=function(e){var i,r=e.getParams().toJSON();return this.removeApiKeysFromParams_(r),i=t.map(r,function(t,e){return e+"="+t}).join("&"),this.encodeParamsString_(i)},r.prototype.encodeParamsString_=function(t){return t.replace("?","%3F").replace("&","%26")},r.prototype.removeApiKeysFromParams_=function(t){delete t.client_id,delete t.client_secret},r.prototype.getApiKeyParams_=function(){var t={};return this.modelsInOrder_.some(function(e){return t=e.getParams().pick("client_id","client_secret"),t.client_id&&t.client_secret},this),t},r.prototype.isSuccessResponse_=function(t){var e=!!t&&t.success;return e?t.response.responses.every(function(t){return!!t&&t.success}):!1},r.prototype.createErrorFromResponse_=function(t){var i=!!t.error;return i?e.prototype.createErrorFromResponse_.call(this,t):t.response.responses.reduce(function(t,i){var r;return t||!i.error?t:(r=e.prototype.createErrorFromResponse_.call(this,i),"The requested location was not found."===i.error.description&&(r.code="invalid_location"),r)},void 0)},r.prototype.parse=function(t){try{var e=t.response.responses;this.modelsInOrder_.forEach(function(t,i){this.updateModelWithResponseData_(t,e[i])},this)}catch(r){throw new i("Unable to parse batch response data: "+r.message)}return this.attributes},r.prototype.updateModelWithResponseData_=function(t,e){var i=t.parse(e);t.set(i)},r.prototype.toJSON=function(){var i=e.prototype.toJSON.call(this);return t.each(i,function(t,r){t instanceof e&&(i[r]=t.toJSON())}),i},r.prototype.clear=function(){this.keys().forEach(function(t){var e=this.get(t);this.isModel_(e)?e.clear():this.unset(t)},this)},r}),r("aeris/api/models/forecast",["aeris/util","aeris/api/models/aerisapimodel"],function(t,e){var i=function(i,r){var n=t.defaults(r||{},{endpoint:"forecasts"});e.call(this,i,n)};return t.inherits(i,e),t.expose(i,"aeris.api.models.Forecast")}),r("aeris/api/models/sunmoon",["aeris/util","aeris/api/models/aerisapimodel"],function(t,e){var i=function(i,r){var n=t.defaults(r||{},{endpoint:"sunmoon",params:{}});t.defaults(n.params,{p:":auto"}),e.call(this,i,n)};return t.inherits(i,e),t.expose(i,"aeris.api.models.Sunmoon")}),r("aeris/packages/api",["aeris/api/collections/advisories","aeris/api/collections/earthquakes","aeris/api/collections/fires","aeris/api/collections/geojsonfeaturecollection","aeris/api/collections/lightning","aeris/api/collections/normals","aeris/api/collections/observations","aeris/api/collections/places","aeris/api/collections/records","aeris/api/collections/stormcells","aeris/api/collections/stormreports","aeris/api/collections/tides","aeris/api/models/advisory","aeris/api/models/aerisbatchmodel","aeris/api/models/earthquake","aeris/api/models/fire","aeris/api/models/forecast","aeris/api/models/geojsonfeature","aeris/api/models/lightning","aeris/api/models/normal","aeris/api/models/observation","aeris/api/models/place","aeris/api/models/record","aeris/api/models/stormreport","aeris/api/models/sunmoon","aeris/api/models/tide"],function(){}),r("aeris/geolocate/options/geolocateserviceoptions",["aeris/util"],function(t){var e=function(e){var i=t.defaults(e||{},this.getDefaultOptions());this.enableHighAccuracy=i.enableHighAccuracy,this.maximumAge=i.maximumAge,this.timeout=i.timeout};return e.prototype.getDefaultOptions=function(){return t.clone(e.DEFAULT_OPTIONS)},e.DEFAULT_OPTIONS={enableHighAccuracy:!1,maximumAge:3e4,timeout:1e4},e}),r("aeris/geolocate/options/freegeoipserviceoptions",["aeris/util","aeris/geolocate/options/geolocateserviceoptions","aeris/jsonp"],function(t,e,i){var r=function(i){var r=t.defaults(i||{},this.getDefaultOptions());this.jsonp=r.jsonp,this.ip_address=r.ip_address,e.call(this,r)};return t.inherits(r,e),r.prototype.getDefaultOptions=function(){return t.clone(r.DEFAULT_OPTIONS)},r.DEFAULT_OPTIONS=t.extend({},e.DEFAULT_OPTIONS,{ip_address:"",jsonp:i}),r}),r("aeris/geolocate/results/geolocateposition",["aeris/util"],function(t){var e=function(e){return t.defaults(e,{latLon:null,altitude:null,altitudeAccuracy:null,accuracy:null,heading:null,speed:null,timestamp:null}),e};return e}),r("aeris/geolocate/errors/geolocateserviceerror",["aeris/errors/errortypefactory"],function(t){var e=function(i){var r=new t({name:"GeolocateServiceError"}),n=new r(i.message);return n.code=i.code,n.PERMISSION_DENIED=e.PERMISSION_DENIED,n.POSITION_UNAVAILABLE=e.POSITION_UNAVAILABLE,n.TIMEOUT=e.TIMEOUT,n};return e.PERMISSION_DENIED=1,e.POSITION_UNAVAILABLE=2,e.TIMEOUT=3,e}),r("aeris/geolocate/freegeoipgeolocateservice",["aeris/util","aeris/promise","aeris/geolocate/options/freegeoipserviceoptions","aeris/geolocate/results/geolocateposition","aeris/geolocate/errors/geolocateserviceerror"],function(t,e,i,r,n){var s=function(t){var e=new i(t);this.url_="//freegeoip.net/json/"+e.ip_address,this.jsonp_=e.jsonp,this.watchId_=null,this.lastPosition_};return s.prototype.getCurrentPosition=function(){var i=new e;return this.jsonp_.get(this.url_,{},t.bind(this.resolve_,this,i)),i},s.prototype.watchPosition=function(e,i,r){var n=t.defaults(r||{},{interval:3e3}),s=function(){};e||(e=s),i||(i=s);var o=function(){this.getCurrentPosition().done(function(i){var r=!this.lastPosition_||!t.isEqual(i,this.lastPosition_);r&&(this.lastPosition_=i,e(i))}).fail(i)}.bind(this);this.watchId_=window.setInterval(o,n.interval),o()},s.prototype.clearWatch=function(){t.isNull(this.watchId_)||(window.clearInterval(this.watchId_),this.lastPosition_=null)},s.isSupported=function(){return!0},s.prototype.resolve_=function(e,i){var s=!i||!t.isNumber(i.latitude)||!t.isNumber(i.longitude);s?e.reject(new n({code:n.POSITION_UNAVAILABLE,message:"FreeGeoIP returned unexpected data."})):e.resolve(new r({latLon:[i.latitude,i.longitude]}))},t.expose(s,"aeris.geolocate.FreeGeoIPGeolocateService")}),r("aeris/geolocate/options/html5serviceoptions",["aeris/util","aeris/geolocate/options/geolocateserviceoptions"],function(t,e){var i=this,r=function(i){var r=t.defaults(i||{},this.getDefaultOptions());this.navigator=r.navigator,e.call(this,r)};return t.inherits(r,e),r.prototype.getDefaultOptions=function(){return t.clone(r.DEFAULT_OPTIONS)},r.DEFAULT_OPTIONS=t.extend({},e.DEFAULT_OPTIONS,{navigator:i.navigator}),r}),r("aeris/geolocate/html5geolocateservice",["aeris/util","aeris/promise","aeris/geolocate/options/html5serviceoptions","aeris/geolocate/results/geolocateposition","aeris/geolocate/errors/geolocateserviceerror"],function(t,e,i,r,n){var s=this,o=function(e){var r=new i(e);this.navigatorOptions_=t.pick(r,"enableHighAccuracy","maximumAge","timeout"),this.navigator_=r.navigator,this.watchId_=null};return o.prototype.getCurrentPosition=function(){var i=new e,r=t.bind(function(t){i.resolve(this.createPosition_(t))},this),n=t.bind(function(t){i.reject(this.createGeolocateError_(t))},this);return o.isSupported(this.navigator_)?this.navigator_.geolocation.getCurrentPosition(r,n,this.navigatorOptions_):i.reject(this.createServiceUnavailableError_()),i},o.prototype.watchPosition=function(t,e,i){var r=this;o.isSupported(this.navigator_)?this.watchId_=this.navigator_.geolocation.watchPosition(function(e){t(r.createPosition_(e))},function(t){e(r.createGeolocateError_(t))},this.navigatorOptions_):e(this.createServiceUnavailableError_())},o.prototype.createServiceUnavailableError_=function(){return this.createGeolocateError_({message:"HTML5 Geolocation is not available.",code:n.POSITION_UNAVAILABLE})},o.prototype.clearWatch=function(){t.isNull(this.watchId_)||(this.navigator_.geolocation.clearWatch(this.watchId_),this.watchId_=null)},o.isSupported=function(t){var e=arguments.length?t:s.navigator;return!(!e||!e.geolocation)},o.prototype.createPosition_=function(e){return new r(t.extend({latLon:[e.coords.latitude,e.coords.longitude],timestamp:e.timestamp||null},t.pick(e.coords,"altitude","altitudeAccuracy","accuracy","heading","speed")))},o.prototype.createGeolocateError_=function(t){return new n(t)},o.prototype.setNavigator=function(t){this.navigator_=t},t.expose(o,"aeris.geolocate.HTML5GeolocateService")}),r("aeris/geocode/config",["aeris/util","aeris/model","module"],function(t,e,i){return new e(i.config())}),r("aeris/errors/invalidconfigerror",["aeris/errors/errortypefactory"],function(t){return new t({name:"InvalidConfigError"})}),r("aeris/geocode/geocodeserviceresponse",[],function(){var t=function(t){return t};return t}),r("aeris/geocode/geocodeservicestatus",["aeris/util"],function(t){return t.expose({OK:"OK",API_ERROR:"API_ERROR",INVALID_REQUEST:"INVALID_REQUEST",NO_RESULTS:"NO_RESULTS"},"aeris.geocode.GeocodeServiceStatus")}),r("aeris/geocode/mapquestgeocodeservice",["aeris/util","aeris/promise","aeris/jsonp","aeris/geocode/config","aeris/errors/invalidconfigerror","aeris/geocode/geocodeserviceresponse","aeris/geocode/geocodeservicestatus"],function(t,e,i,r,n,s,o){var a=function(e){var n=t.defaults(e||{},{apiId:r.get("apiId")});this.apiId_=n.apiId,this.serviceUrl_="//open.mapquestapi.com/geocoding/v1/address",this.jsonp_=i};return a.prototype.geocode=function(i){var r=new e,n=this.getMapQuestUri_(),s={location:i};return this.jsonp_.get(n,s,t.bind(function(e){e&&e.info&&!t.isUndefined(e.info.statuscode)?this.isStatusCodeErrorResponse_(e)?r.reject(this.createStatusCodeError_(e)):this.isNoResultsErrorResponse_(e)?r.reject(this.createNoResultsError_(e)):r.resolve(this.createGeocodeResponse_(e)):r.reject(this.createUnexpectedResultsError_(e))},this)),r},a.prototype.getMapQuestUri_=function(){return this.ensureApiId_(),this.serviceUrl_+"?key="+this.apiId_},a.prototype.ensureApiId_=function(){if(this.apiId_=this.apiId_||r.get("apiId"),!this.apiId_)throw new n("The MapQuestGeocodeService requires an apiId")},a.prototype.isStatusCodeErrorResponse_=function(e){var i=e&&e.info,r=i?parseInt(e.info.statuscode):null;return!t.isNumeric(r)||r>=400},a.prototype.isNoResultsErrorResponse_=function(t){var e=t&&t.results;return e&&(!t.results.length||!t.results[0].locations||!t.results[0].locations.length)},a.prototype.createUnexpectedResultsError_=function(t){return new s({latLon:[],status:{code:o.API_ERROR,apiCode:"",message:"The MapQuest Geolocation API returned an unexpected response."}})},a.prototype.createStatusCodeError_=function(t){var e={0:o.OK,400:o.INVALID_REQUEST,403:o.API_ERROR,500:o.API_ERROR};return new s({latLon:[],status:{code:e[t.info.statuscode]||o.API_ERROR,apiCode:t.info.statuscode,message:t.info.messages.join("; ")}})},a.prototype.createNoResultsError_=function(t){return new s({latLon:[],status:{code:o.NO_RESULTS,apiCode:t.info.statuscode,message:t.info.messages.join("; ")}})},a.prototype.createGeocodeResponse_=function(t){var e=t.results[0].locations[0];return new s({latLon:[parseFloat(e.latLng.lat),parseFloat(e.latLng.lng)],status:{code:o.OK,apiCode:t.info.statuscode,message:t.info.messages.join("; ")}})},a.prototype.setJSONP=function(t){this.jsonp_=t},t.expose(a,"aeris.geocode.MapQuestGeocodeService")}),i("aeris/packages/leaflet"),i("aeris/packages/api"),i("aeris/geolocate/freegeoipgeolocateservice"),i("aeris/geolocate/html5geolocateservice"),i("aeris/geocode/mapquestgeocodeservice")});