!function(t,e){t.aeris=e()}(this,function(){function t(e,i){e.getMarkerClusterer().extend(t,google.maps.OverlayView),this.cluster_=e,this.className_=e.getMarkerClusterer().getClusterClass(),this.styles_=i,this.center_=null,this.div_=null,this.sums_=null,this.visible_=!1,this.setMap(e.getMap())}function e(e){this.markerClusterer_=e,this.map_=e.getMap(),this.gridSize_=e.getGridSize(),this.minClusterSize_=e.getMinimumClusterSize(),this.averageCenter_=e.getAverageCenter(),this.markers_=[],this.center_=null,this.bounds_=null,this.clusterIcon_=new t(this,e.getStyles())}function i(t,e,r){this.extend(i,google.maps.OverlayView),e=e||[],r=r||{},this.markers_=[],this.clusters_=[],this.listeners_=[],this.activeMap_=null,this.ready_=!1,this.gridSize_=r.gridSize||60,this.minClusterSize_=r.minimumClusterSize||2,this.maxZoom_=r.maxZoom||null,this.styles_=r.styles||[],this.title_=r.title||"",this.zoomOnClick_=!0,void 0!==r.zoomOnClick&&(this.zoomOnClick_=r.zoomOnClick),this.averageCenter_=!1,void 0!==r.averageCenter&&(this.averageCenter_=r.averageCenter),this.ignoreHidden_=!1,void 0!==r.ignoreHidden&&(this.ignoreHidden_=r.ignoreHidden),this.enableRetinaIcons_=!1,void 0!==r.enableRetinaIcons&&(this.enableRetinaIcons_=r.enableRetinaIcons),this.imagePath_=r.imagePath||i.IMAGE_PATH,this.imageExtension_=r.imageExtension||i.IMAGE_EXTENSION,this.imageSizes_=r.imageSizes||i.IMAGE_SIZES,this.calculator_=r.calculator||i.CALCULATOR,this.batchSize_=r.batchSize||i.BATCH_SIZE,this.batchSizeIE_=r.batchSizeIE||i.BATCH_SIZE_IE,this.clusterClass_=r.clusterClass||"cluster",-1!==navigator.userAgent.toLowerCase().indexOf("msie")&&(this.batchSize_=this.batchSizeIE_),this.setupStyles_(),this.addMarkers(e,!0),this.setMap(t)}var r,s,n;return function(t){function e(t,e){return b.call(t,e)}function i(t,e){var i,r,s,n,o,a,l,p,u,c,h,d=e&&e.split("/"),f=_.map,m=f&&f["*"]||{};if(t&&"."===t.charAt(0))if(e){for(d=d.slice(0,d.length-1),t=t.split("/"),o=t.length-1,_.nodeIdCompat&&T.test(t[o])&&(t[o]=t[o].replace(T,"")),t=d.concat(t),u=0;u<t.length;u+=1)if(h=t[u],"."===h)t.splice(u,1),u-=1;else if(".."===h){if(1===u&&(".."===t[2]||".."===t[0]))break;u>0&&(t.splice(u-1,2),u-=2)}t=t.join("/")}else 0===t.indexOf("./")&&(t=t.substring(2));if((d||m)&&f){for(i=t.split("/"),u=i.length;u>0;u-=1){if(r=i.slice(0,u).join("/"),d)for(c=d.length;c>0;c-=1)if(s=f[d.slice(0,c).join("/")],s&&(s=s[r])){n=s,a=u;break}if(n)break;!l&&m&&m[r]&&(l=m[r],p=u)}!n&&l&&(n=l,a=p),n&&(i.splice(0,a,n),t=i.join("/"))}return t}function o(e,i){return function(){return d.apply(t,w.call(arguments,0).concat([e,i]))}}function a(t){return function(e){return i(e,t)}}function l(t){return function(e){g[t]=e}}function p(i){if(e(y,i)){var r=y[i];delete y[i],v[i]=!0,h.apply(t,r)}if(!e(g,i)&&!e(v,i))throw new Error("No "+i);return g[i]}function u(t){var e,i=t?t.indexOf("!"):-1;return i>-1&&(e=t.substring(0,i),t=t.substring(i+1,t.length)),[e,t]}function c(t){return function(){return _&&_.config&&_.config[t]||{}}}var h,d,f,m,g={},y={},_={},v={},b=Object.prototype.hasOwnProperty,w=[].slice,T=/\.js$/;f=function(t,e){var r,s=u(t),n=s[0];return t=s[1],n&&(n=i(n,e),r=p(n)),n?t=r&&r.normalize?r.normalize(t,a(e)):i(t,e):(t=i(t,e),s=u(t),n=s[0],t=s[1],n&&(r=p(n))),{f:n?n+"!"+t:t,n:t,pr:n,p:r}},m={require:function(t){return o(t)},exports:function(t){var e=g[t];return"undefined"!=typeof e?e:g[t]={}},module:function(t){return{id:t,uri:"",exports:g[t],config:c(t)}}},h=function(i,r,s,n){var a,u,c,h,d,_,b=[],w=typeof s;if(n=n||i,"undefined"===w||"function"===w){for(r=!r.length&&s.length?["require","exports","module"]:r,d=0;d<r.length;d+=1)if(h=f(r[d],n),u=h.f,"require"===u)b[d]=m.require(i);else if("exports"===u)b[d]=m.exports(i),_=!0;else if("module"===u)a=b[d]=m.module(i);else if(e(g,u)||e(y,u)||e(v,u))b[d]=p(u);else{if(!h.p)throw new Error(i+" missing "+u);h.p.load(h.n,o(n,!0),l(u),{}),b[d]=g[u]}c=s?s.apply(g[i],b):void 0,i&&(a&&a.exports!==t&&a.exports!==g[i]?g[i]=a.exports:c===t&&_||(g[i]=c))}else i&&(g[i]=s)},r=s=d=function(e,i,r,s,n){if("string"==typeof e)return m[e]?m[e](i):p(f(e,i).f);if(!e.splice){if(_=e,_.deps&&d(_.deps,_.callback),!i)return;i.splice?(e=i,i=r,r=null):e=t}return i=i||function(){},"function"==typeof r&&(r=s,s=n),s?h(t,e,i,r):setTimeout(function(){h(t,e,i,r)},4),d},d.config=function(t){return d(t)},r._defined=g,n=function(t,i,r){i.splice||(r=i,i=[]),e(g,t)||e(y,t)||(y[t]=[t,i,r])},n.amd={jQuery:!0}}(),n("bower_components/almond/almond",function(){}),function(){var t=this,e=t._,i={},r=Array.prototype,s=Object.prototype,o=Function.prototype,a=r.push,l=r.slice,p=r.concat,u=s.toString,c=s.hasOwnProperty,h=r.forEach,d=r.map,f=r.reduce,m=r.reduceRight,g=r.filter,y=r.every,_=r.some,v=r.indexOf,b=r.lastIndexOf,w=Array.isArray,T=Object.keys,k=o.bind,x=function(t){return t instanceof x?t:this instanceof x?void(this._wrapped=t):new x(t)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=x),exports._=x):t._=x,x.VERSION="1.6.0";var S=x.each=x.forEach=function(t,e,r){if(null==t)return t;if(h&&t.forEach===h)t.forEach(e,r);else if(t.length===+t.length){for(var s=0,n=t.length;n>s;s++)if(e.call(r,t[s],s,t)===i)return}else for(var o=x.keys(t),s=0,n=o.length;n>s;s++)if(e.call(r,t[o[s]],o[s],t)===i)return;return t};x.map=x.collect=function(t,e,i){var r=[];return null==t?r:d&&t.map===d?t.map(e,i):(S(t,function(t,s,n){r.push(e.call(i,t,s,n))}),r)};var I="Reduce of empty array with no initial value";x.reduce=x.foldl=x.inject=function(t,e,i,r){var s=arguments.length>2;if(null==t&&(t=[]),f&&t.reduce===f)return r&&(e=x.bind(e,r)),s?t.reduce(e,i):t.reduce(e);if(S(t,function(t,n,o){s?i=e.call(r,i,t,n,o):(i=t,s=!0)}),!s)throw new TypeError(I);return i},x.reduceRight=x.foldr=function(t,e,i,r){var s=arguments.length>2;if(null==t&&(t=[]),m&&t.reduceRight===m)return r&&(e=x.bind(e,r)),s?t.reduceRight(e,i):t.reduceRight(e);var n=t.length;if(n!==+n){var o=x.keys(t);n=o.length}if(S(t,function(a,l,p){l=o?o[--n]:--n,s?i=e.call(r,i,t[l],l,p):(i=t[l],s=!0)}),!s)throw new TypeError(I);return i},x.find=x.detect=function(t,e,i){var r;return M(t,function(t,s,n){return e.call(i,t,s,n)?(r=t,!0):void 0}),r},x.filter=x.select=function(t,e,i){var r=[];return null==t?r:g&&t.filter===g?t.filter(e,i):(S(t,function(t,s,n){e.call(i,t,s,n)&&r.push(t)}),r)},x.reject=function(t,e,i){return x.filter(t,function(t,r,s){return!e.call(i,t,r,s)},i)},x.every=x.all=function(t,e,r){e||(e=x.identity);var s=!0;return null==t?s:y&&t.every===y?t.every(e,r):(S(t,function(t,n,o){return(s=s&&e.call(r,t,n,o))?void 0:i}),!!s)};var M=x.some=x.any=function(t,e,r){e||(e=x.identity);var s=!1;return null==t?s:_&&t.some===_?t.some(e,r):(S(t,function(t,n,o){return s||(s=e.call(r,t,n,o))?i:void 0}),!!s)};x.contains=x.include=function(t,e){return null==t?!1:v&&t.indexOf===v?-1!=t.indexOf(e):M(t,function(t){return t===e})},x.invoke=function(t,e){var i=l.call(arguments,2),r=x.isFunction(e);return x.map(t,function(t){return(r?e:t[e]).apply(t,i)})},x.pluck=function(t,e){return x.map(t,x.property(e))},x.where=function(t,e){return x.filter(t,x.matches(e))},x.findWhere=function(t,e){return x.find(t,x.matches(e))},x.max=function(t,e,i){if(!e&&x.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.max.apply(Math,t);var r=-1/0,s=-1/0;return S(t,function(t,n,o){var a=e?e.call(i,t,n,o):t;a>s&&(r=t,s=a)}),r},x.min=function(t,e,i){if(!e&&x.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.min.apply(Math,t);var r=1/0,s=1/0;return S(t,function(t,n,o){var a=e?e.call(i,t,n,o):t;s>a&&(r=t,s=a)}),r},x.shuffle=function(t){var e,i=0,r=[];return S(t,function(t){e=x.random(i++),r[i-1]=r[e],r[e]=t}),r},x.sample=function(t,e,i){return null==e||i?(t.length!==+t.length&&(t=x.values(t)),t[x.random(t.length-1)]):x.shuffle(t).slice(0,Math.max(0,e))};var E=function(t){return null==t?x.identity:x.isFunction(t)?t:x.property(t)};x.sortBy=function(t,e,i){return e=E(e),x.pluck(x.map(t,function(t,r,s){return{value:t,index:r,criteria:e.call(i,t,r,s)}}).sort(function(t,e){var i=t.criteria,r=e.criteria;if(i!==r){if(i>r||void 0===i)return 1;if(r>i||void 0===r)return-1}return t.index-e.index}),"value")};var L=function(t){return function(e,i,r){var s={};return i=E(i),S(e,function(n,o){var a=i.call(r,n,o,e);t(s,a,n)}),s}};x.groupBy=L(function(t,e,i){x.has(t,e)?t[e].push(i):t[e]=[i]}),x.indexBy=L(function(t,e,i){t[e]=i}),x.countBy=L(function(t,e){x.has(t,e)?t[e]++:t[e]=1}),x.sortedIndex=function(t,e,i,r){i=E(i);for(var s=i.call(r,e),n=0,o=t.length;o>n;){var a=n+o>>>1;i.call(r,t[a])<s?n=a+1:o=a}return n},x.toArray=function(t){return t?x.isArray(t)?l.call(t):t.length===+t.length?x.map(t,x.identity):x.values(t):[]},x.size=function(t){return null==t?0:t.length===+t.length?t.length:x.keys(t).length},x.first=x.head=x.take=function(t,e,i){return null==t?void 0:null==e||i?t[0]:0>e?[]:l.call(t,0,e)},x.initial=function(t,e,i){return l.call(t,0,t.length-(null==e||i?1:e))},x.last=function(t,e,i){return null==t?void 0:null==e||i?t[t.length-1]:l.call(t,Math.max(t.length-e,0))},x.rest=x.tail=x.drop=function(t,e,i){return l.call(t,null==e||i?1:e)},x.compact=function(t){return x.filter(t,x.identity)};var A=function(t,e,i){return e&&x.every(t,x.isArray)?p.apply(i,t):(S(t,function(t){x.isArray(t)||x.isArguments(t)?e?a.apply(i,t):A(t,e,i):i.push(t)}),i)};x.flatten=function(t,e){return A(t,e,[])},x.without=function(t){return x.difference(t,l.call(arguments,1))},x.partition=function(t,e){var i=[],r=[];return S(t,function(t){(e(t)?i:r).push(t)}),[i,r]},x.uniq=x.unique=function(t,e,i,r){x.isFunction(e)&&(r=i,i=e,e=!1);var s=i?x.map(t,i,r):t,n=[],o=[];return S(s,function(i,r){(e?r&&o[o.length-1]===i:x.contains(o,i))||(o.push(i),n.push(t[r]))}),n},x.union=function(){return x.uniq(x.flatten(arguments,!0))},x.intersection=function(t){var e=l.call(arguments,1);return x.filter(x.uniq(t),function(t){return x.every(e,function(e){return x.contains(e,t)})})},x.difference=function(t){var e=p.apply(r,l.call(arguments,1));return x.filter(t,function(t){return!x.contains(e,t)})},x.zip=function(){for(var t=x.max(x.pluck(arguments,"length").concat(0)),e=new Array(t),i=0;t>i;i++)e[i]=x.pluck(arguments,""+i);return e},x.object=function(t,e){if(null==t)return{};for(var i={},r=0,s=t.length;s>r;r++)e?i[t[r]]=e[r]:i[t[r][0]]=t[r][1];return i},x.indexOf=function(t,e,i){if(null==t)return-1;var r=0,s=t.length;if(i){if("number"!=typeof i)return r=x.sortedIndex(t,e),t[r]===e?r:-1;r=0>i?Math.max(0,s+i):i}if(v&&t.indexOf===v)return t.indexOf(e,i);for(;s>r;r++)if(t[r]===e)return r;return-1},x.lastIndexOf=function(t,e,i){if(null==t)return-1;var r=null!=i;if(b&&t.lastIndexOf===b)return r?t.lastIndexOf(e,i):t.lastIndexOf(e);for(var s=r?i:t.length;s--;)if(t[s]===e)return s;return-1},x.range=function(t,e,i){arguments.length<=1&&(e=t||0,t=0),i=arguments[2]||1;for(var r=Math.max(Math.ceil((e-t)/i),0),s=0,n=new Array(r);r>s;)n[s++]=t,t+=i;return n};var C=function(){};x.bind=function(t,e){var i,r;if(k&&t.bind===k)return k.apply(t,l.call(arguments,1));if(!x.isFunction(t))throw new TypeError;return i=l.call(arguments,2),r=function(){if(!(this instanceof r))return t.apply(e,i.concat(l.call(arguments)));C.prototype=t.prototype;var s=new C;C.prototype=null;var n=t.apply(s,i.concat(l.call(arguments)));return Object(n)===n?n:s}},x.partial=function(t){var e=l.call(arguments,1);return function(){for(var i=0,r=e.slice(),s=0,n=r.length;n>s;s++)r[s]===x&&(r[s]=arguments[i++]);for(;i<arguments.length;)r.push(arguments[i++]);return t.apply(this,r)}},x.bindAll=function(t){var e=l.call(arguments,1);if(0===e.length)throw new Error("bindAll must be passed function names");return S(e,function(e){t[e]=x.bind(t[e],t)}),t},x.memoize=function(t,e){var i={};return e||(e=x.identity),function(){var r=e.apply(this,arguments);return x.has(i,r)?i[r]:i[r]=t.apply(this,arguments)}},x.delay=function(t,e){var i=l.call(arguments,2);return setTimeout(function(){return t.apply(null,i)},e)},x.defer=function(t){return x.delay.apply(x,[t,1].concat(l.call(arguments,1)))},x.throttle=function(t,e,i){var r,s,n,o=null,a=0;i||(i={});var l=function(){a=i.leading===!1?0:x.now(),o=null,n=t.apply(r,s),r=s=null};return function(){var p=x.now();a||i.leading!==!1||(a=p);var u=e-(p-a);return r=this,s=arguments,0>=u?(clearTimeout(o),o=null,a=p,n=t.apply(r,s),r=s=null):o||i.trailing===!1||(o=setTimeout(l,u)),n}},x.debounce=function(t,e,i){var r,s,n,o,a,l=function(){var p=x.now()-o;e>p?r=setTimeout(l,e-p):(r=null,i||(a=t.apply(n,s),n=s=null))};return function(){n=this,s=arguments,o=x.now();var p=i&&!r;return r||(r=setTimeout(l,e)),p&&(a=t.apply(n,s),n=s=null),a}},x.once=function(t){var e,i=!1;return function(){return i?e:(i=!0,e=t.apply(this,arguments),t=null,e)}},x.wrap=function(t,e){return x.partial(e,t)},x.compose=function(){var t=arguments;return function(){for(var e=arguments,i=t.length-1;i>=0;i--)e=[t[i].apply(this,e)];return e[0]}},x.after=function(t,e){return function(){return--t<1?e.apply(this,arguments):void 0}},x.keys=function(t){if(!x.isObject(t))return[];if(T)return T(t);var e=[];for(var i in t)x.has(t,i)&&e.push(i);return e},x.values=function(t){for(var e=x.keys(t),i=e.length,r=new Array(i),s=0;i>s;s++)r[s]=t[e[s]];return r},x.pairs=function(t){for(var e=x.keys(t),i=e.length,r=new Array(i),s=0;i>s;s++)r[s]=[e[s],t[e[s]]];return r},x.invert=function(t){for(var e={},i=x.keys(t),r=0,s=i.length;s>r;r++)e[t[i[r]]]=i[r];return e},x.functions=x.methods=function(t){var e=[];for(var i in t)x.isFunction(t[i])&&e.push(i);return e.sort()},x.extend=function(t){return S(l.call(arguments,1),function(e){if(e)for(var i in e)t[i]=e[i]}),t},x.pick=function(t){var e={},i=p.apply(r,l.call(arguments,1));return S(i,function(i){i in t&&(e[i]=t[i])}),e},x.omit=function(t){var e={},i=p.apply(r,l.call(arguments,1));for(var s in t)x.contains(i,s)||(e[s]=t[s]);return e},x.defaults=function(t){return S(l.call(arguments,1),function(e){if(e)for(var i in e)void 0===t[i]&&(t[i]=e[i])}),t},x.clone=function(t){return x.isObject(t)?x.isArray(t)?t.slice():x.extend({},t):t},x.tap=function(t,e){return e(t),t};var O=function(t,e,i,r){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return t===e;t instanceof x&&(t=t._wrapped),e instanceof x&&(e=e._wrapped);var s=u.call(t);if(s!=u.call(e))return!1;switch(s){case"[object String]":return t==String(e);case"[object Number]":return t!=+t?e!=+e:0==t?1/t==1/e:t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object RegExp]":return t.source==e.source&&t.global==e.global&&t.multiline==e.multiline&&t.ignoreCase==e.ignoreCase}if("object"!=typeof t||"object"!=typeof e)return!1;for(var n=i.length;n--;)if(i[n]==t)return r[n]==e;var o=t.constructor,a=e.constructor;if(o!==a&&!(x.isFunction(o)&&o instanceof o&&x.isFunction(a)&&a instanceof a)&&"constructor"in t&&"constructor"in e)return!1;i.push(t),r.push(e);var l=0,p=!0;if("[object Array]"==s){if(l=t.length,p=l==e.length)for(;l--&&(p=O(t[l],e[l],i,r)););}else{for(var c in t)if(x.has(t,c)&&(l++,!(p=x.has(e,c)&&O(t[c],e[c],i,r))))break;if(p){for(c in e)if(x.has(e,c)&&!l--)break;p=!l}}return i.pop(),r.pop(),p};x.isEqual=function(t,e){return O(t,e,[],[])},x.isEmpty=function(t){if(null==t)return!0;if(x.isArray(t)||x.isString(t))return 0===t.length;for(var e in t)if(x.has(t,e))return!1;return!0},x.isElement=function(t){return!(!t||1!==t.nodeType)},x.isArray=w||function(t){return"[object Array]"==u.call(t)},x.isObject=function(t){return t===Object(t)},S(["Arguments","Function","String","Number","Date","RegExp"],function(t){x["is"+t]=function(e){return u.call(e)=="[object "+t+"]"}}),x.isArguments(arguments)||(x.isArguments=function(t){return!(!t||!x.has(t,"callee"))}),"function"!=typeof/./&&(x.isFunction=function(t){return"function"==typeof t}),x.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},x.isNaN=function(t){return x.isNumber(t)&&t!=+t},x.isBoolean=function(t){return t===!0||t===!1||"[object Boolean]"==u.call(t)},x.isNull=function(t){return null===t},x.isUndefined=function(t){return void 0===t},x.has=function(t,e){return c.call(t,e)},x.noConflict=function(){return t._=e,this},x.identity=function(t){return t},x.constant=function(t){return function(){return t}},x.property=function(t){return function(e){return e[t]}},x.matches=function(t){return function(e){if(e===t)return!0;for(var i in t)if(t[i]!==e[i])return!1;return!0}},x.times=function(t,e,i){for(var r=Array(Math.max(0,t)),s=0;t>s;s++)r[s]=e.call(i,s);return r},x.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},x.now=Date.now||function(){return(new Date).getTime()};var j={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};j.unescape=x.invert(j.escape);var P={escape:new RegExp("["+x.keys(j.escape).join("")+"]","g"),unescape:new RegExp("("+x.keys(j.unescape).join("|")+")","g")};x.each(["escape","unescape"],function(t){x[t]=function(e){return null==e?"":(""+e).replace(P[t],function(e){return j[t][e]})}}),x.result=function(t,e){if(null==t)return void 0;var i=t[e];return x.isFunction(i)?i.call(t):i},x.mixin=function(t){S(x.functions(t),function(e){var i=x[e]=t[e];x.prototype[e]=function(){var t=[this._wrapped];return a.apply(t,arguments),z.call(this,i.apply(x,t))}})};var U=0;x.uniqueId=function(t){var e=++U+"";return t?t+e:e},x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var R=/(.)^/,N={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},V=/\\|'|\r|\n|\t|\u2028|\u2029/g;x.template=function(t,e,i){var r;i=x.defaults({},i,x.templateSettings);var s=new RegExp([(i.escape||R).source,(i.interpolate||R).source,(i.evaluate||R).source].join("|")+"|$","g"),n=0,o="__p+='";t.replace(s,function(e,i,r,s,a){return o+=t.slice(n,a).replace(V,function(t){return"\\"+N[t]}),i&&(o+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'"),r&&(o+="'+\n((__t=("+r+"))==null?'':__t)+\n'"),s&&(o+="';\n"+s+"\n__p+='"),n=a+e.length,e}),o+="';\n",i.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{r=new Function(i.variable||"obj","_",o)}catch(a){throw a.source=o,a}if(e)return r(e,x);var l=function(t){return r.call(this,t,x)};return l.source="function("+(i.variable||"obj")+"){\n"+o+"}",l},x.chain=function(t){return x(t).chain()};var z=function(t){return this._chain?x(t).chain():t};x.mixin(x),S(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=r[t];x.prototype[t]=function(){var i=this._wrapped;return e.apply(i,arguments),"shift"!=t&&"splice"!=t||0!==i.length||delete i[0],z.call(this,i)}}),S(["concat","join","slice"],function(t){var e=r[t];x.prototype[t]=function(){return z.call(this,e.apply(this._wrapped,arguments))}}),x.extend(x.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}}),"function"==typeof n&&n.amd&&n("underscore",[],function(){return x})}.call(this),n("aeris/util",["underscore"],function(t){var e={abstractMethod:function(){},inherits:function(t,e){function i(){this.__Parent=e}i.prototype=e.prototype,t.prototype=new i,t.prototype.constructor=t},expose:function(e,i){var r=i.split("."),s=r.length,n=window;return t.each(r,function(t,i){var r=i===s-1,o=n[t]||{};n[t]=r?e:o,n=n[t]},this),e},provide:function(t){return this.expose({},t,!1)},average:function(i){var r=t.isArray(i)?i:e.argsToArray(arguments),s=r.reduce(function(t,e){return t+e},0);return s/r.length},interval:function(e,i,r){var s=Array.prototype.slice.call(arguments,3);return r&&(e=t.bind.apply(t,[e,r].concat(s))),window.setInterval(e,i)},argsToArray:function(t){return Array.prototype.slice.call(t,0)},path:function(e,i){var r,s;return t.isString(e)&&e.length?(r=e.split("."),s=t.isUndefined(i)?window:i,t.reduce(r,function(e,i){return t.isUndefined(e)?void 0:e[i]},s)):void 0},isNumeric:function(e){return!t.isObject(e)&&!isNaN(parseFloat(e))&&isFinite(e)},isInteger:function(e){return t.isNumeric(e)&&e%1===0},isPlainObject:function(e){var i=!t.isFunction(e)&&!t.isArray(e);return t.isObject(e)&&i},throwUncatchable:function(e){t.defer(function(){throw e})}};return t.templateSettings={interpolate:/\{(.+?)\}/g},t.mixin(e),t}),n("jquery",{}),function(t,e){if("function"==typeof n&&n.amd)n("backbone",["underscore","jquery","exports"],function(i,r,s){t.Backbone=e(t,s,i,r)});else if("undefined"!=typeof exports){var i=s("underscore");e(t,exports,i)}else t.Backbone=e(t,{},t._,t.jQuery||t.Zepto||t.ender||t.$)}(this,function(t,e,i,r){{var s=t.Backbone,n=[],o=(n.push,n.slice);n.splice}e.VERSION="1.1.2",e.$=r,e.noConflict=function(){return t.Backbone=s,this},e.emulateHTTP=!1,e.emulateJSON=!1;var a=e.Events={on:function(t,e,i){if(!p(this,"on",t,[e,i])||!e)return this;this._events||(this._events={});var r=this._events[t]||(this._events[t]=[]);return r.push({callback:e,context:i,ctx:i||this}),this},once:function(t,e,r){if(!p(this,"once",t,[e,r])||!e)return this;var s=this,n=i.once(function(){s.off(t,n),e.apply(this,arguments)});return n._callback=e,this.on(t,n,r)},off:function(t,e,r){var s,n,o,a,l,u,c,h;if(!this._events||!p(this,"off",t,[e,r]))return this;if(!t&&!e&&!r)return this._events=void 0,this;for(a=t?[t]:i.keys(this._events),l=0,u=a.length;u>l;l++)if(t=a[l],o=this._events[t]){if(this._events[t]=s=[],e||r)for(c=0,h=o.length;h>c;c++)n=o[c],(e&&e!==n.callback&&e!==n.callback._callback||r&&r!==n.context)&&s.push(n);s.length||delete this._events[t]}return this},trigger:function(t){if(!this._events)return this;var e=o.call(arguments,1);if(!p(this,"trigger",t,e))return this;var i=this._events[t],r=this._events.all;return i&&u(i,e),r&&u(r,arguments),this},stopListening:function(t,e,r){var s=this._listeningTo;if(!s)return this;var n=!e&&!r;r||"object"!=typeof e||(r=this),t&&((s={})[t._listenId]=t);for(var o in s)t=s[o],t.off(e,r,this),(n||i.isEmpty(t._events))&&delete this._listeningTo[o];return this}},l=/\s+/,p=function(t,e,i,r){if(!i)return!0;if("object"==typeof i){for(var s in i)t[e].apply(t,[s,i[s]].concat(r));return!1}if(l.test(i)){for(var n=i.split(l),o=0,a=n.length;a>o;o++)t[e].apply(t,[n[o]].concat(r));return!1}return!0},u=function(t,e){var i,r=-1,s=t.length,n=e[0],o=e[1],a=e[2];switch(e.length){case 0:for(;++r<s;)(i=t[r]).callback.call(i.ctx);return;case 1:for(;++r<s;)(i=t[r]).callback.call(i.ctx,n);return;case 2:for(;++r<s;)(i=t[r]).callback.call(i.ctx,n,o);return;case 3:for(;++r<s;)(i=t[r]).callback.call(i.ctx,n,o,a);return;default:for(;++r<s;)(i=t[r]).callback.apply(i.ctx,e);return}},c={listenTo:"on",listenToOnce:"once"};i.each(c,function(t,e){a[e]=function(e,r,s){var n=this._listeningTo||(this._listeningTo={}),o=e._listenId||(e._listenId=i.uniqueId("l"));return n[o]=e,s||"object"!=typeof r||(s=this),e[t](r,s,this),this}}),a.bind=a.on,a.unbind=a.off,i.extend(e,a);var h=e.Model=function(t,e){var r=t||{};e||(e={}),this.cid=i.uniqueId("c"),this.attributes={},e.collection&&(this.collection=e.collection),e.parse&&(r=this.parse(r,e)||{}),r=i.defaults({},r,i.result(this,"defaults")),this.set(r,e),this.changed={},this.initialize.apply(this,arguments)};i.extend(h.prototype,a,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(){return i.clone(this.attributes)},sync:function(){return e.sync.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(t){return i.escape(this.get(t))},has:function(t){return null!=this.get(t)},set:function(t,e,r){var s,n,o,a,l,p,u,c;if(null==t)return this;if("object"==typeof t?(n=t,r=e):(n={})[t]=e,r||(r={}),!this._validate(n,r))return!1;o=r.unset,l=r.silent,a=[],p=this._changing,this._changing=!0,p||(this._previousAttributes=i.clone(this.attributes),this.changed={}),c=this.attributes,u=this._previousAttributes,this.idAttribute in n&&(this.id=n[this.idAttribute]);for(s in n)e=n[s],i.isEqual(c[s],e)||a.push(s),i.isEqual(u[s],e)?delete this.changed[s]:this.changed[s]=e,o?delete c[s]:c[s]=e;if(!l){a.length&&(this._pending=r);for(var h=0,d=a.length;d>h;h++)this.trigger("change:"+a[h],this,c[a[h]],r)}if(p)return this;if(!l)for(;this._pending;)r=this._pending,this._pending=!1,this.trigger("change",this,r);return this._pending=!1,this._changing=!1,this},unset:function(t,e){return this.set(t,void 0,i.extend({},e,{unset:!0}))},clear:function(t){var e={};for(var r in this.attributes)e[r]=void 0;return this.set(e,i.extend({},t,{unset:!0}))},hasChanged:function(t){return null==t?!i.isEmpty(this.changed):i.has(this.changed,t)},changedAttributes:function(t){if(!t)return this.hasChanged()?i.clone(this.changed):!1;var e,r=!1,s=this._changing?this._previousAttributes:this.attributes;for(var n in t)i.isEqual(s[n],e=t[n])||((r||(r={}))[n]=e);return r},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return i.clone(this._previousAttributes)},fetch:function(t){t=t?i.clone(t):{},void 0===t.parse&&(t.parse=!0);var e=this,r=t.success;return t.success=function(i){return e.set(e.parse(i,t),t)?(r&&r(e,i,t),void e.trigger("sync",e,i,t)):!1},N(this,t),this.sync("read",this,t)},save:function(t,e,r){var s,n,o,a=this.attributes;if(null==t||"object"==typeof t?(s=t,r=e):(s={})[t]=e,r=i.extend({validate:!0},r),s&&!r.wait){if(!this.set(s,r))return!1}else if(!this._validate(s,r))return!1;s&&r.wait&&(this.attributes=i.extend({},a,s)),void 0===r.parse&&(r.parse=!0);var l=this,p=r.success;return r.success=function(t){l.attributes=a;var e=l.parse(t,r);return r.wait&&(e=i.extend(s||{},e)),i.isObject(e)&&!l.set(e,r)?!1:(p&&p(l,t,r),void l.trigger("sync",l,t,r))},N(this,r),n=this.isNew()?"create":r.patch?"patch":"update","patch"===n&&(r.attrs=s),o=this.sync(n,this,r),s&&r.wait&&(this.attributes=a),o},destroy:function(t){t=t?i.clone(t):{};var e=this,r=t.success,s=function(){e.trigger("destroy",e,e.collection,t)};if(t.success=function(i){(t.wait||e.isNew())&&s(),r&&r(e,i,t),e.isNew()||e.trigger("sync",e,i,t)},this.isNew())return t.success(),!1;N(this,t);var n=this.sync("delete",this,t);return t.wait||s(),n},url:function(){var t=i.result(this,"urlRoot")||i.result(this.collection,"url")||R();return this.isNew()?t:t.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},parse:function(t){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(t){return this._validate({},i.extend(t||{},{validate:!0}))},_validate:function(t,e){if(!e.validate||!this.validate)return!0;t=i.extend({},this.attributes,t);var r=this.validationError=this.validate(t,e)||null;return r?(this.trigger("invalid",this,r,i.extend(e,{validationError:r})),!1):!0}});var d=["keys","values","pairs","invert","pick","omit"];i.each(d,function(t){h.prototype[t]=function(){var e=o.call(arguments);return e.unshift(this.attributes),i[t].apply(i,e)}});var f=e.Collection=function(t,e){e||(e={}),e.model&&(this.model=e.model),void 0!==e.comparator&&(this.comparator=e.comparator),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,i.extend({silent:!0},e))},m={add:!0,remove:!0,merge:!0},g={add:!0,remove:!1};i.extend(f.prototype,a,{model:h,initialize:function(){},toJSON:function(t){return this.map(function(e){return e.toJSON(t)})},sync:function(){return e.sync.apply(this,arguments)},add:function(t,e){return this.set(t,i.extend({merge:!1},e,g))},remove:function(t,e){var r=!i.isArray(t);t=r?[t]:i.clone(t),e||(e={});var s,n,o,a;for(s=0,n=t.length;n>s;s++)a=t[s]=this.get(t[s]),a&&(delete this._byId[a.id],delete this._byId[a.cid],o=this.indexOf(a),this.models.splice(o,1),this.length--,e.silent||(e.index=o,a.trigger("remove",a,this,e)),this._removeReference(a,e));return r?t[0]:t},set:function(t,e){e=i.defaults({},e,m),e.parse&&(t=this.parse(t,e));var r=!i.isArray(t);t=r?t?[t]:[]:i.clone(t);var s,n,o,a,l,p,u,c=e.at,d=this.model,f=this.comparator&&null==c&&e.sort!==!1,g=i.isString(this.comparator)?this.comparator:null,y=[],_=[],v={},b=e.add,w=e.merge,T=e.remove,k=!f&&b&&T?[]:!1;for(s=0,n=t.length;n>s;s++){if(l=t[s]||{},o=l instanceof h?a=l:l[d.prototype.idAttribute||"id"],p=this.get(o))T&&(v[p.cid]=!0),w&&(l=l===a?a.attributes:l,e.parse&&(l=p.parse(l,e)),p.set(l,e),f&&!u&&p.hasChanged(g)&&(u=!0)),t[s]=p;else if(b){if(a=t[s]=this._prepareModel(l,e),!a)continue;y.push(a),this._addReference(a,e)}a=p||a,!k||!a.isNew()&&v[a.id]||k.push(a),v[a.id]=!0}if(T){for(s=0,n=this.length;n>s;++s)v[(a=this.models[s]).cid]||_.push(a);_.length&&this.remove(_,e)}if(y.length||k&&k.length)if(f&&(u=!0),this.length+=y.length,null!=c)for(s=0,n=y.length;n>s;s++)this.models.splice(c+s,0,y[s]);else{k&&(this.models.length=0);var x=k||y;for(s=0,n=x.length;n>s;s++)this.models.push(x[s])}if(u&&this.sort({silent:!0}),!e.silent){for(s=0,n=y.length;n>s;s++)(a=y[s]).trigger("add",a,this,e);(u||k&&k.length)&&this.trigger("sort",this,e)}return r?t[0]:t},reset:function(t,e){e||(e={});for(var r=0,s=this.models.length;s>r;r++)this._removeReference(this.models[r],e);return e.previousModels=this.models,this._reset(),t=this.add(t,i.extend({silent:!0},e)),e.silent||this.trigger("reset",this,e),t},push:function(t,e){return this.add(t,i.extend({at:this.length},e))},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t),e},unshift:function(t,e){return this.add(t,i.extend({at:0},e))},shift:function(t){var e=this.at(0);return this.remove(e,t),e},slice:function(){return o.apply(this.models,arguments)},get:function(t){return null==t?void 0:this._byId[t]||this._byId[t.id]||this._byId[t.cid]},at:function(t){return this.models[t]},where:function(t,e){return i.isEmpty(t)?e?void 0:[]:this[e?"find":"filter"](function(e){for(var i in t)if(t[i]!==e.get(i))return!1;return!0})},findWhere:function(t){return this.where(t,!0)},sort:function(t){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return t||(t={}),i.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(i.bind(this.comparator,this)),t.silent||this.trigger("sort",this,t),this},pluck:function(t){return i.invoke(this.models,"get",t)},fetch:function(t){t=t?i.clone(t):{},void 0===t.parse&&(t.parse=!0);var e=t.success,r=this;return t.success=function(i){var s=t.reset?"reset":"set";r[s](i,t),e&&e(r,i,t),r.trigger("sync",r,i,t)},N(this,t),this.sync("read",this,t)},create:function(t,e){if(e=e?i.clone(e):{},!(t=this._prepareModel(t,e)))return!1;e.wait||this.add(t,e);var r=this,s=e.success;return e.success=function(t,i){e.wait&&r.add(t,e),s&&s(t,i,e)},t.save(null,e),t},parse:function(t){return t},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(t,e){if(t instanceof h)return t;e=e?i.clone(e):{},e.collection=this;var r=new this.model(t,e);return r.validationError?(this.trigger("invalid",this,r.validationError,e),!1):r},_addReference:function(t){this._byId[t.cid]=t,null!=t.id&&(this._byId[t.id]=t),t.collection||(t.collection=this),t.on("all",this._onModelEvent,this)},_removeReference:function(t){this===t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,i,r){("add"!==t&&"remove"!==t||i===this)&&("destroy"===t&&this.remove(e,r),e&&t==="change:"+e.idAttribute&&(delete this._byId[e.previous(e.idAttribute)],null!=e.id&&(this._byId[e.id]=e)),this.trigger.apply(this,arguments))}});var y=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain","sample"];i.each(y,function(t){f.prototype[t]=function(){var e=o.call(arguments);return e.unshift(this.models),i[t].apply(i,e)}});var _=["groupBy","countBy","sortBy","indexBy"];i.each(_,function(t){f.prototype[t]=function(e,r){var s=i.isFunction(e)?e:function(t){return t.get(e)};return i[t](this.models,s,r)}});var v=e.View=function(t){this.cid=i.uniqueId("view"),t||(t={}),i.extend(this,i.pick(t,w)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()
},b=/^(\S+)\s*(.*)$/,w=["model","collection","el","id","attributes","className","tagName","events"];i.extend(v.prototype,a,{tagName:"div",$:function(t){return this.$el.find(t)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(t,i){return this.$el&&this.undelegateEvents(),this.$el=t instanceof e.$?t:e.$(t),this.el=this.$el[0],i!==!1&&this.delegateEvents(),this},delegateEvents:function(t){if(!t&&!(t=i.result(this,"events")))return this;this.undelegateEvents();for(var e in t){var r=t[e];if(i.isFunction(r)||(r=this[t[e]]),r){var s=e.match(b),n=s[1],o=s[2];r=i.bind(r,this),n+=".delegateEvents"+this.cid,""===o?this.$el.on(n,r):this.$el.on(n,o,r)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(this.el)this.setElement(i.result(this,"el"),!1);else{var t=i.extend({},i.result(this,"attributes"));this.id&&(t.id=i.result(this,"id")),this.className&&(t["class"]=i.result(this,"className"));var r=e.$("<"+i.result(this,"tagName")+">").attr(t);this.setElement(r,!1)}}}),e.sync=function(t,r,s){var n=k[t];i.defaults(s||(s={}),{emulateHTTP:e.emulateHTTP,emulateJSON:e.emulateJSON});var o={type:n,dataType:"json"};if(s.url||(o.url=i.result(r,"url")||R()),null!=s.data||!r||"create"!==t&&"update"!==t&&"patch"!==t||(o.contentType="application/json",o.data=JSON.stringify(s.attrs||r.toJSON(s))),s.emulateJSON&&(o.contentType="application/x-www-form-urlencoded",o.data=o.data?{model:o.data}:{}),s.emulateHTTP&&("PUT"===n||"DELETE"===n||"PATCH"===n)){o.type="POST",s.emulateJSON&&(o.data._method=n);var a=s.beforeSend;s.beforeSend=function(t){return t.setRequestHeader("X-HTTP-Method-Override",n),a?a.apply(this,arguments):void 0}}"GET"===o.type||s.emulateJSON||(o.processData=!1),"PATCH"===o.type&&T&&(o.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var l=s.xhr=e.ajax(i.extend(o,s));return r.trigger("request",r,l,s),l};var T=!("undefined"==typeof window||!window.ActiveXObject||window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent),k={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};e.ajax=function(){return e.$.ajax.apply(e.$,arguments)};var x=e.Router=function(t){t||(t={}),t.routes&&(this.routes=t.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},S=/\((.*?)\)/g,I=/(\(\?)?:\w+/g,M=/\*\w+/g,E=/[\-{}\[\]+?.,\\\^$|#\s]/g;i.extend(x.prototype,a,{initialize:function(){},route:function(t,r,s){i.isRegExp(t)||(t=this._routeToRegExp(t)),i.isFunction(r)&&(s=r,r=""),s||(s=this[r]);var n=this;return e.history.route(t,function(i){var o=n._extractParameters(t,i);n.execute(s,o),n.trigger.apply(n,["route:"+r].concat(o)),n.trigger("route",r,o),e.history.trigger("route",n,r,o)}),this},execute:function(t,e){t&&t.apply(this,e)},navigate:function(t,i){return e.history.navigate(t,i),this},_bindRoutes:function(){if(this.routes){this.routes=i.result(this,"routes");for(var t,e=i.keys(this.routes);null!=(t=e.pop());)this.route(t,this.routes[t])}},_routeToRegExp:function(t){return t=t.replace(E,"\\$&").replace(S,"(?:$1)?").replace(I,function(t,e){return e?t:"([^/?]+)"}).replace(M,"([^?]*?)"),new RegExp("^"+t+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(t,e){var r=t.exec(e).slice(1);return i.map(r,function(t,e){return e===r.length-1?t||null:t?decodeURIComponent(t):null})}});var L=e.History=function(){this.handlers=[],i.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},A=/^[#\/]|\s+$/g,C=/^\/+|\/+$/g,O=/msie [\w.]+/,j=/\/$/,P=/#.*$/;L.started=!1,i.extend(L.prototype,a,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root},getHash:function(t){var e=(t||this).location.href.match(/#(.*)$/);return e?e[1]:""},getFragment:function(t,e){if(null==t)if(this._hasPushState||!this._wantsHashChange||e){t=decodeURI(this.location.pathname+this.location.search);var i=this.root.replace(j,"");t.indexOf(i)||(t=t.slice(i.length))}else t=this.getHash();return t.replace(A,"")},start:function(t){if(L.started)throw new Error("Backbone.history has already been started");L.started=!0,this.options=i.extend({root:"/"},this.options,t),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var r=this.getFragment(),s=document.documentMode,n=O.exec(navigator.userAgent.toLowerCase())&&(!s||7>=s);if(this.root=("/"+this.root+"/").replace(C,"/"),n&&this._wantsHashChange){var o=e.$('<iframe src="javascript:0" tabindex="-1">');this.iframe=o.hide().appendTo("body")[0].contentWindow,this.navigate(r)}this._hasPushState?e.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!n?e.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=r;var a=this.location;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot())return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+"#"+this.fragment),!0;this._hasPushState&&this.atRoot()&&a.hash&&(this.fragment=this.getHash().replace(A,""),this.history.replaceState({},document.title,this.root+this.fragment))}return this.options.silent?void 0:this.loadUrl()},stop:function(){e.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),L.started=!1},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(){var t=this.getFragment();return t===this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe))),t===this.fragment?!1:(this.iframe&&this.navigate(t),void this.loadUrl())},loadUrl:function(t){return t=this.fragment=this.getFragment(t),i.any(this.handlers,function(e){return e.route.test(t)?(e.callback(t),!0):void 0})},navigate:function(t,e){if(!L.started)return!1;e&&e!==!0||(e={trigger:!!e});var i=this.root+(t=this.getFragment(t||""));if(t=t.replace(P,""),this.fragment!==t){if(this.fragment=t,""===t&&"/"!==i&&(i=i.slice(0,-1)),this._hasPushState)this.history[e.replace?"replaceState":"pushState"]({},document.title,i);else{if(!this._wantsHashChange)return this.location.assign(i);this._updateHash(this.location,t,e.replace),this.iframe&&t!==this.getFragment(this.getHash(this.iframe))&&(e.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,t,e.replace))}return e.trigger?this.loadUrl(t):void 0}},_updateHash:function(t,e,i){if(i){var r=t.href.replace(/(javascript:|#).*$/,"");t.replace(r+"#"+e)}else t.hash="#"+e}}),e.history=new L;var U=function(t,e){var r,s=this;r=t&&i.has(t,"constructor")?t.constructor:function(){return s.apply(this,arguments)},i.extend(r,s,e);var n=function(){this.constructor=r};return n.prototype=s.prototype,r.prototype=new n,t&&i.extend(r.prototype,t),r.__super__=s.prototype,r};h.extend=f.extend=x.extend=v.extend=L.extend=U;var R=function(){throw new Error('A "url" property or function must be specified')},N=function(t,e){var i=e.error;e.error=function(r){i&&i(t,r,e),t.trigger("error",t,r,e)}};return e}),n("aeris/events",["aeris/util","backbone"],function(t,e){var i=function(){};return t.extend(i.prototype,e.Events),i.prototype.eachEventHash_=function(e,i,r){r||(r=this),t.each(e,function(e,s){e=t.isArray(e)?e:[e],t.each(e,function(e){e=t.isFunction(this[e])?this[e]:e,i.call(r,s,e)},this)},this)},i.prototype.on=function(i,r){t.isObject(i)?this.eachEventHash_(i,function(t,i){e.Events.on.call(this,t,i,r)},this):e.Events.on.apply(this,arguments)},i.prototype.off=function(i,r,s){return t.isObject(i)?(s=arguments[1],this.eachEventHash_(i,function(t,i){e.Events.off.call(this,t,i,s)},this)):e.Events.off.apply(this,arguments),i&&this._events&&this._events[i]?this:0},i.prototype.proxyEvents=function(t,e,i){var r=t.trigger,s=e||function(t,e){return{topic:t,args:e}},n=i||this;t.trigger=function(e){var i=Array.prototype.slice.call(arguments,1),o=s.call(n,e,i),a=[o.topic].concat(o.args);r.apply(t,arguments),this.trigger.apply(n,a)},t.trigger=t.trigger.bind(this)},i.prototype.removeProxy=function(){this.trigger=function(){i.prototype.trigger.apply(this,arguments)},this.trigger=this.trigger.bind(this)},i.hub=new i,i.publish=function(){i.hub.trigger.apply(i.hub,arguments)},i.subscribe=function(){i.hub.on.apply(i.hub,arguments)},i.unsubscribe=function(){i.hub.off.apply(i.hub,arguments)},t.expose(i,"aeris.Events")}),n("aeris/errors/abstracterror",["aeris/util"],function(t){AbstractError=function(){try{window.Error.call(this),Error.captureStackTrace(this,AbstractError)}catch(t){}this.name=this.setName(),this.message=this.setMessage.apply(this,arguments)};try{t.inherits(AbstractError,window.Error)}catch(e){}return AbstractError.prototype.setName=function(){throw"UnimplementedMethodError: Classes extending from AbstractError must implement setName method"},AbstractError.prototype.setMessage=function(t){return t},AbstractError.prototype.toString=function(){return this.name+":"+this.message},t.expose(AbstractError,"aeris.errors.AbstractError")}),n("aeris/errors/errortypefactory",["aeris/util","aeris/errors/abstracterror"],function(t,e){var i=function(i){var r;return t.defaults(i,{type:e}),this.ParentType_=i.type,r=this.initializeType_(),r.prototype.setName=function(){return i.name},r.prototype.setMessage=function(){var t=i.message||function(t){return t};return t.apply(this,arguments)},r};return i.prototype.initializeType_=function(){var e=this.ParentType_,i=function(){e.apply(this,arguments)};return t.inherits(i,e),i},i}),n("aeris/errors/validationerror",["aeris/errors/errortypefactory"],function(t){return new t({name:"ValidationError",message:function(t,e){return e?"Invalid model attribute '"+t+"': "+e+".":"Model failed to pass validation: "+t}})}),n("aeris/model",["aeris/util","backbone","aeris/events","aeris/errors/validationerror"],function(t,e,i,r){var s=function(r,s){var n=t.defaults(s||{},{validate:!1}),o=t.omit(n,"validate");this.idAttribute=n.idAttribute||"id",this.defaults=this.defaults||n.defaults,this.options_=s||{},e.Model.call(this,r,o),i.call(this),this.on("invalid",this.onValidationError_,this),n.validate&&this.isValid()};return t.inherits(s,e.Model),t.extend(s.prototype,i.prototype),s.prototype.onValidationError_=function(t,e){throw e=e instanceof Error?e:new r(e)},s.prototype.set=function(i,r,s){var n;if(t.isString(i)?(n={})[i]=r:(n=i,s=r),n=this.normalize_(n),!n)throw Error("Invalid model attributes. Make sure that Model#normalize_ is returning an object.");e.Model.prototype.set.call(this,n,s)},s.prototype.normalize_=function(t){return t},s.prototype.getAtPath=function(e){var i=e.split("."),r=i.splice(0,1)[0],s=this.get(r);return i.length?t.path(i.join("."),s):s},s.prototype.clone=function(e,i){var r=t.extend({},this.attributes,e),s=t.extend({},this.options_,i);return new this.constructor(r,s)},s}),n("aeris/errors/invalidargumenterror",["aeris/errors/errortypefactory"],function(t){return new t({name:"InvalidArgumentError"})}),n("aeris/viewmodel",["aeris/util","aeris/model","aeris/errors/invalidargumenterror"],function(t,e,i){var r=function(i,r){var s=t.defaults(r||{},{data:new e,attributeTransforms:this.attributeTransforms});this.data_=s.data,this.attributeTransforms_=s.attributeTransforms,e.call(this,i,s),this.listenTo(this.data_,{change:this.syncToModel}),this.syncToModel()};return t.inherits(r,e),r.prototype.syncToModel=function(){t.each(this.attributeTransforms_,function(t,e){this.set(e,t.call(this),{validate:!0})},this)},r.prototype.getData=function(){return this.data_},r.prototype.getDataAttribute=function(e){var r,s,n;if(t.isUndefined(e))throw new i("Unable to get data attribute "+e);return r=e.split("."),s=this.data_.get(r[0]),n=r.slice(1).join("."),n?t.path(n,s):s},r.prototype.fetchData=function(t){return this.data_.fetch(t)},r.prototype.destroy=function(){this.stopListening(this.data_)},r}),n("aeris/promise",["aeris/util","aeris/errors/invalidargumenterror"],function(t,e){var i=function(){this.state="pending",this.arguments_=null,this.deferred_={resolved:[],rejected:[]}};return i.prototype.done=function(t,e){return this.bindCallbackToState_("resolved",t,e),this},i.prototype.fail=function(t,e){return this.bindCallbackToState_("rejected",t,e),this},i.prototype.always=function(t,e){return this.done(t,e),this.fail(t,e),this},i.prototype.bindCallbackToState_=function(i,r,s){if(!t.isFunction(r))throw new e("Invalid '"+i+"' state callback.");this.state===i?r.apply(s,this.arguments_):this.deferred_[i].push([r,s])},i.prototype.resolve=function(){this.adoptState_("resolved",arguments)},i.prototype.reject=function(){this.adoptState_("rejected",arguments)},i.prototype.adoptState_=function(t,e){var i,r;if("rejected"!==t&&"resolved"!==t)throw new Error("Invalid promise state: '"+t+"'. +Valid states are 'resolved' and 'rejected'");if("pending"===this.state){this.state=t,this.arguments_=e,r=this.deferred_[this.state],i=r.length;for(var s=0;i>s;s++){var n=r[s][0],o=r[s][1];n.apply(o,this.arguments_)}for(var a in this.deferred_)this.deferred_.hasOwnProperty(a)&&(this.deferred_[a]=[])}},i.prototype.getState=function(){return this.state},i.when=function(){var r,s=Array.prototype.slice.call(arguments),n=new i,o=[];1===s.length&&s[0]instanceof Array&&(s=s[0]),r=s.length;var a=0;return t.each(s,function(t){if(!(t instanceof i))throw new e("Unable to create master promise: "+t.toString()+" is not a valid Promise object");t.fail(function(){n.reject.apply(n,arguments)}),t.done(function(){var t=Array.prototype.slice.call(arguments);o.push(t),a++,a>=r&&n.resolve.apply(n,o)})},this),0===s.length&&n.resolve(),n},t.expose(i,"aeris.Promise")}),n("aeris/maps/extensions/strategyobject",["aeris/util","aeris/events","aeris/promise","aeris/errors/invalidargumenterror"],function(t,e,i,r){var n=function(i){var r=t.defaults(i||{},{strategy:null});this.strategy_=null,e.call(this),t.isString(r.strategy)?this.loadStrategy_(r.strategy).fail(function(e){t.defer(function(){throw e})}):t.isNull(r.strategy)||this.setStrategy_(r.strategy)};return t.extend(n.prototype,e.prototype),n.prototype.setStrategy_=function(e){if(this.strategy_&&this.removeStrategy(),!t.isFunction(e))throw new r("Unable to set StrategyObject strategy: invalid strategy constructor.");this.strategy_=this.createStrategy_(e),this.trigger("strategy:set",this.strategy_)},n.prototype.createStrategy_=function(t){return new t(this)},n.prototype.loadStrategy_=function(e){var n=new i;return s(["aeris/maps/strategy/"+e],t.bind(function(t){this.setStrategy_(t),n.resolve()},this),function(t){n.reject(new r("Unable to load Strategy module: "+t.message))}),n},n.prototype.removeStrategy=function(){this.strategy_&&(this.strategy_.destroy(),this.strategy_=null)},n}),n("aeris/maps/extensions/mapextensionobject",["aeris/util","aeris/errors/validationerror","aeris/viewmodel","aeris/maps/extensions/strategyobject","aeris/promise"],function(t,e,i,r,s){var n=function(e,s){var n=t.defaults(e||{},{map:null});i.call(this,n,s),r.call(this,t.pick(s||{},"strategy")),this.listenTo(this,{"change:map":function(t,e,i){var r=this.hasMap()?"map:set":"map:remove";this.trigger(r,t,e,i)}})};return t.inherits(n,i),t.extend(n.prototype,r.prototype),n.prototype.validate=function(t){return null===t.map||t.map instanceof aeris.maps.Map?void 0:new e("Aeris Map","Invalid map object")},n.prototype.setMap=function(e,i){var r=t.defaults(i||{},{validate:!0});this.set("map",e,r)},n.prototype.getMap=function(){return this.get("map")},n.prototype.hasMap=function(){return this.has("map")},n.prototype.getView=function(){if(!this.strategy_)throw new Error("Unable to get MapExtensionObject view: no strategy is available for this object.");return this.strategy_.getView()},n.prototype.requestView=function(){var t=new s;return this.strategy_?(t.resolve(this.getView()),t):(this.once("strategy:set",function(){t.resolve(this.getView())},this),t)},n.prototype.destroy=function(){this.stopListening(),this.removeStrategy()},n}),n("async",[],function(){function t(t){var e,i;e=document.createElement("script"),e.type="text/javascript",e.async=!0,e.src=t,i=document.getElementsByTagName("script")[0],i.parentNode.insertBefore(e,i)}function e(t,e){var i=/!(.+)/,s=t.replace(i,""),n=i.test(t)?t.replace(/.+!/,""):r;return s+=s.indexOf("?")<0?"?":"&",s+n+"="+e}function i(){return s+=1,"__async_req_"+s+"__"}var r="callback",s=0;return{load:function(r,s,n,o){if(o.isBuild)n(null);else{var a=i();window[a]=n,t(e(r,a))}}}}),n("googlemaps",["async"],function(t){function e(){}var i=this,r={load:function(t,e,i,r){var n,o=r||{};return o.isBuild?void i(null):(n=new s(e,i,o.googlemaps||{}),void n.load())}},s=function(i,r,n){this.require_=i,this.onload_=r||e,this.baseUrl_=n.url||s.DEFAULT_BASE_URL,this.async_=n.async||t,this.params_=this.normalizeParams_(n.params)};return s.prototype.load=function(){this.isGoogleMapsLoaded_()?this.resolveWith_(this.getGlobalGoogleMaps_()):this.loadGoogleMaps_()},s.prototype.loadGoogleMaps_=function(){var t=this,e=function(){t.resolveWithGoogleMaps_(t)};e.onerror=this.onload_.onerror,this.async_.load(this.getGoogleUrl_(),this.require_,e,{})},s.prototype.getGoogleUrl_=function(){return this.baseUrl_+"?"+this.serializeParams_()},s.prototype.resolveWithGoogleMaps_=function(){return this.isGoogleMapsLoaded_()?void this.resolveWith_(this.getGlobalGoogleMaps_()):void this.reject_()},s.prototype.serializeParams_=function(){var t=[];for(var e in this.params_)if(this.params_.hasOwnProperty(e)){var i=this.params_[e],r="object"==typeof i,s=encodeURIComponent(e)+"="+encodeURIComponent(i),n=r?this.serializeParams_(i,e):s;t.push(n)}return t.join("&")},s.prototype.normalizeParams_=function(t){var e={sensor:!1};return t||(t={}),t.sensor=void 0==t.sensor?e.sensor:t.sensor,t},s.prototype.isGoogleMapsLoaded_=function(){return i.google&&i.google.maps},s.prototype.getGlobalGoogleMaps_=function(){return i.google?i.google.maps:void 0},s.prototype.resolveWith_=function(){this.onload_.apply(i,arguments)},s.prototype.reject_=function(t){var e=t||new Error("Failed to load Google Maps library.");if(!this.onload_.onerror)throw e;this.onload_.onerror.call(i,e)},s.DEFAULT_BASE_URL="https://maps.googleapis.com/maps/api/js",r}),n("aeris/util/gmaps",["aeris/util","aeris/errors/invalidargumenterror","googlemaps!"],function(t,e,i){return{arrayToLatLng:function(e){return t.isArray(e)&&(e=new i.LatLng(e[0],e[1])),e},latLngToArray:function(t){if(t.lat&&t.lng)return[t.lat(),t.lng()];throw new e("Expecting google.maps.LatLng object. Instead got: "+t)},pathToLatLng:function(t){for(var e=[],r=0;r<t.length;r++)e.push(new i.LatLng(t[r][0],t[r][1]));return e},latLngToPath:function(t){path=[];for(var e=0;e<t.length;e++)path.push([t[e].lat(),t[e].lng()]);return path},boundsToArray:function(t){var e=this.latLngToArray(t.getSouthWest()),i=this.latLngToArray(t.getNorthEast());return[e,i]},arrayToBounds:function(t){return new i.LatLngBounds(this.arrayToLatLng(t[0]),this.arrayToLatLng(t[1]))}}}),n("aeris/maps/abstractstrategy",["aeris/util","aeris/events"],function(t,e){var i=function(i){this.object_=i,this.mapView_,this.objectEvents_=t.extend({},this.objectEvents_,{"map:set":function(t,e){this.setMap(e)},"map:remove":this.remove}),e.call(this),this.view_=this.createView_(),this.listenTo(this.object_,this.objectEvents_),this.object_.hasMap()&&this.setMap(this.object_.getMap())};return t.extend(i.prototype,e.prototype),i.prototype.setMap=function(t){this.mapView_&&this.remove(),this.mapView_=t.getView()},i.prototype.remove=function(){this.mapView_&&(this.beforeRemove_(),this.mapView_=null,this.afterRemove_())},i.prototype.destroy=function(){this.stopListening()},i.prototype.beforeRemove_=t.abstractMethod,i.prototype.afterRemove_=function(){},i.prototype.createView_=t.abstractMethod,i.prototype.getView=function(){return this.view_},i}),n("aeris/maps/strategy/events",["aeris/util","googlemaps!"],function(t,e){var i=function(){this.listeners_=[]};return i.prototype.listenTo=function(i,r,s,n){var o,a,l=[];t.isObject(r)?(o=r,a=s):((o={})[r]=s,a=n),t.each(o,function(r,s){r=a?t.bind(r,a):r,l.push({obj:i,topic:s,ref:e.event.addListener(i,s,r)})},this),this.listeners_=this.listeners_.concat(l)},i.prototype.stopListening=function(i){var r=this.listeners_;i&&(r=t.where(r,{obj:i})),t.each(r,function(t){e.event.removeListener(t.ref)},this),this.listeners_=t.difference(this.listeners_,r)},i}),n("aeris/maps/strategy/abstractstrategy",["aeris/util","aeris/maps/abstractstrategy","aeris/maps/strategy/events"],function(t,e,i){var r=function(r,s){var n=t.defaults(s||{},{googleEvents:new i});this.googleEvents_=n.googleEvents,e.apply(this,arguments)};return t.inherits(r,e),r.prototype.destroy=function(){e.prototype.destroy.apply(this,arguments),this.googleEvents_.stopListening()},r}),n("aeris/errors/unimplementedpropertyerror",["aeris/errors/errortypefactory"],function(t){return new t({name:"UnimplementedPropertyError",message:function(t){return t?"Abstract property "+t+" has not been implemented":"Abstract property has not been implemented"}})}),n("aeris/maps/layers/layer",["aeris/util","aeris/maps/extensions/mapextensionobject"],function(t,e){var i=function(){e.apply(this,arguments)};return t.inherits(i,e),i}),n("aeris/maps/layers/googlemaptype",["aeris/util","aeris/errors/unimplementedpropertyerror","aeris/maps/layers/layer"],function(t,e,i){var r=function(e,r){var s=t.extend({strategy:"layers/googlemaptype"},r);i.call(this,e,s)};return t.inherits(r,i),r.prototype.validate=function(e){return t.isUndefined(e.mapTypeId)?"mapTypeId | MapTypeId must be defined":i.prototype.validate.apply(this,arguments)},t.expose(r,"aeris.maps.layers.GoogleMapType")}),n("aeris/maps/layers/googleroadmap",["aeris/util","aeris/maps/layers/googlemaptype"],function(t,e){var i=function(i,r){var s=t.extend({mapTypeId:"ROADMAP",name:"GoogleRoadMap"},i);e.call(this,s,r)};return t.inherits(i,e),t.expose(i,"aeris.maps.layers.GoogleRoadMap")}),n("aeris/maps/strategy/map",["aeris/util","aeris/util/gmaps","aeris/maps/strategy/abstractstrategy","aeris/maps/layers/googleroadmap","googlemaps!"],function(t,e,i,r,s){var n=function(){i.apply(this,arguments),this.bindMapEvents_(),this.listenTo(this.object_,{"change:center":this.setCenter_,"change:zoom":this.setZoom_},this),this.object_.on=function(e){(t.isString(e)&&"dblclick"===e||t.isObject(e)&&t.has(e,"dblclick"))&&this.getView().set("disableDoubleClickZoom",!0),aeris.maps.Map.prototype.on.apply(this,arguments)}};return t.inherits(n,i),n.prototype.createView_=function(){var t,i=this.object_.getElement();return i instanceof s.Map?i:(s.visualRefresh=!0,t=new s.Map(i,{center:e.arrayToLatLng(this.object_.get("center")),zoom:this.object_.get("zoom")}))},n.prototype.bindMapEvents_=function(){this.googleEvents_.listenTo(this.getView(),{click:t.bind(this.triggerMouseEvent_,this,"click"),dblclick:t.bind(this.triggerMouseEvent_,this,"dblclick"),tilesloaded:t.bind(this.object_.trigger,this.object_,"load"),center_changed:function(){var t=e.latLngToArray(this.getView().getCenter());this.object_.set("center",t,{validate:!0})},idle:function(){var t,i=this.getView().getBounds();i&&(t=e.boundsToArray(i),this.object_.set("bounds",t,{validate:!0}))},zoom_changed:function(){var t=this.getView().getZoom();this.object_.set("zoom",t,{validate:!0})}},this)},n.prototype.triggerMouseEvent_=function(t,i){var r=e.latLngToArray(i.latLng);this.object_.trigger(t,r)},n.prototype.setCenter_=function(){var t=e.arrayToLatLng(this.object_.get("center"));this.getView().setCenter(t)},n.prototype.setZoom_=function(){var t=this.object_.get("zoom");this.getView().setZoom(t)},n.prototype.fitToBounds=function(t){var i=e.arrayToBounds(t);this.view_.fitBounds(i)},n}),n("aeris/maps/map",["aeris/util","aeris/events","aeris/errors/validationerror","aeris/maps/extensions/mapextensionobject","aeris/maps/strategy/map"],function(t,e,i,r,s){var n=function(i,n,o){var a=t.extend({center:[45,-90],bounds:[[22.43,-135.52],[52.37,-55.016]],zoom:4},n),l=t.extend({strategy:s,validate:!0},o);this.mapEl_=this.normalizeElement_(i),this.validateElementExists_(this.mapEl_),e.call(this),r.call(this,a,l)};return t.inherits(n,r),t.extend(n.prototype,e.prototype),n.prototype.validate=function(e){return t.isArray(e.center)?t.isNumber(e.zoom)?void 0:new i("zoom",e.zoom+" is not a valid zoom level"):new i("center",e.center+" is not a valid coordinate")},n.prototype.setBounds=function(t){this.set("bounds",t,{validate:!0})},n.prototype.getBounds=function(){return this.get("bounds")},n.prototype.getView=function(){return this.strategy_.getView()},n.prototype.setCenter=function(t){this.set("center",t,{validate:!0})},n.prototype.getCenter=function(){return this.get("center")},n.prototype.setZoom=function(t){this.set("zoom",t,{validate:!0})},n.prototype.getZoom=function(){return this.get("zoom")},n.prototype.fitToBounds=function(t){if(!this.strategy_||!this.strategy_.fitToBounds)throw Error("Unable to fit to bounds: no fitToBounds strategy has been implemented");this.strategy_.fitToBounds(t)},n.prototype.normalizeElement_=function(e){return t.isString(e)?document.getElementById(e):e},n.prototype.validateElementExists_=function(t){if(!t)throw new i("el",t+" is not a valid map canvas element or id")},n.prototype.getElement=function(){return this.mapEl_},t.expose(n,"aeris.maps.Map")}),n("aeris/maps/animations/animationinterface",["aeris/util","aeris/events"],function(t,e){var i=function(){e.call(this)};return t.extend(i.prototype,e.prototype),i.prototype.start=t.abstractMethod,i.prototype.pause=t.abstractMethod,i.prototype.stop=t.abstractMethod,i.prototype.previous=t.abstractMethod,i.prototype.next=t.abstractMethod,i.prototype.goToTime=t.abstractMethod,i}),n("aeris/maps/animations/abstractanimation",["aeris/util","aeris/maps/animations/animationinterface"],function(t,e){var i=function(i){var r=t.defaults(i||{},{from:0,to:(new Date).getTime(),speed:180,timestep:6e4,opacity:1,endDelay:1e3});this.speed_=r.speed,this.timestep_=r.timestep,this.endDelay_=r.endDelay,this.from_=r.from,this.to_=r.to,this.limit_=r.limit,this.normalizeTimeBounds_(),this.currentTime_=null,this.animationClock_=null,this.opacity_=r.opacity,e.call(this)};return t.inherits(i,e),i.prototype.start=function(){var e=25,i=e/1e3,r=this.timestep_*this.speed_*i;this.isAnimating()||(this.currentTime_===this.to_&&this.goToTime(this.from_),this.animationClock_=t.interval(function(){var t=this.currentTime_+r;t>this.to_?this.restart_():this.goToTime(t)},e,this))},i.prototype.restart_=function(){this.pause(),t.delay(function(){this.goToTime(this.from_),this.start()}.bind(this),this.endDelay_)},i.prototype.normalizeTimeBounds_=function(){t.isDate(this.from_)&&(this.from_=this.from_.getTime()),t.isDate(this.to_)&&(this.to_=this.to_.getTime())},i.prototype.goToTime=function(t){this.currentTime_=t},i.prototype.stop=function(){this.pause(),t.isNull(this.to_)||this.goToTime(this.to_)},i.prototype.pause=function(){window.clearInterval(this.animationClock_),this.animationClock_=null},i.prototype.setSpeed=function(t){this.speed_=t,this.isAnimating()&&(this.pause(),this.start())},i.prototype.setTimestep=function(t){this.timestep_=t,this.isAnimating()&&(this.pause(),this.start())},i.prototype.isAnimating=function(){return t.isNumber(this.animationClock_)},i}),n("aeris/maps/animations/helpers/timelayersfactory",["aeris/util"],function(t){var e=function(e,i,r){var s=t.defaults(r||{},{from:null,to:null,limit:null});this.from_=s.from,this.to_=s.to,this.limit_=s.limit,this.baseLayer_=e,this.isSorted_=!1,this.times_,this.setTimes(i)};return e.prototype.setTimes=function(e){this.times_=t.clone(e)},e.prototype.getOrderedTimes=function(){return t.sortBy(this.times_,t.identity)},e.prototype.createTimeLayers=function(){var e={};return this.prepareTimes_(),this.shuffleTimes_(),t.each(this.times_,function(t){var i=this.createLayerForTime_(t);e[t]=i},this),e},e.prototype.prepareTimes_=function(){this.ensureTimeBoundsOptions_(),this.constrainTimes_(this.from_,this.to_,!0),this.limit_&&this.thinTimes_(this.limit_)},e.prototype.createLayerForTime_=function(t){return this.baseLayer_.clone({time:new Date(t)})},e.prototype.ensureTimeBoundsOptions_=function(){this.from_||(this.from_=Math.min.apply(null,this.times_)),this.to_||(this.to_=Math.max.apply(null,this.times_))},e.prototype.constrainTimes_=function(e,i){this.times_=t.reject(this.times_,function(t){return e>t||t>i},this)},e.prototype.thinTimes_=function(t){var e,i=this.times_.length-t;if(!(0>=i)){e=this.times_.length/Math.floor(this.times_.length-this.limit_),this.sortTimes_();for(var r=this.times_.length-1;r>=0;r-=e)this.limit_<this.times_.length&&this.times_.splice(r,1)}},e.prototype.shuffleTimes_=function(){this.times_=t.sample(this.times_,this.times_.length),this.isSorted_=!1},e.prototype.sortTimes_=function(){this.isSorted_||(this.times_=t.sortBy(this.times_,function(t){return t}),this.isSorted_=!0)},e}),n("aeris/maps/animations/helpers/animationlayerloader",["aeris/util","aeris/events","aeris/maps/animations/helpers/timelayersfactory","aeris/promise"],function(t,e,i,r){var s=function(t,r){var s=r||{};this.baseLayer_=t,this.timeLayersFactory_=s.timeLayersFactory||new i(t,null,s),this.timeLayers_={},e.call(this)};return t.extend(s.prototype,e.prototype),s.prototype.load=function(){var t=new r;return this.baseLayer_.loadTileTimes().done(function(e){this.timeLayers_=this.createLayersFromTimes_(e),this.bindLayerLoadEvents_(),this.trigger("load:times",e,this.timeLayers_),this.once("load:complete",function(){t.resolve(this.timeLayers_)},this)},this).fail(function(t){this.trigger("load:error",t)},this).fail(t.reject,t),t},s.prototype.createLayersFromTimes_=function(t){return this.timeLayersFactory_.setTimes(t),this.timeLayersFactory_.createTimeLayers()},s.prototype.bindLayerLoadEvents_=function(){var e=t.debounce(function(){this.trigger("load:reset",this.getLoadProgress())},15);t.each(this.timeLayers_,function(t){this.listenTo(t,{load:function(){var t=this.getLoadProgress();1===t&&this.trigger("load:complete",t),this.trigger("load:progress",t)},"load:reset":e})},this)},s.prototype.getLoadProgress=function(){var e=t.keys(this.timeLayers_).length,i=0;return e?(t.each(this.timeLayers_,function(t){t.isLoaded()&&i++},0),Math.min(i/e,1)):0},s}),n("aeris/maps/animations/tileanimation",["aeris/util","aeris/maps/animations/abstractanimation","aeris/maps/animations/helpers/animationlayerloader","aeris/errors/invalidargumenterror"],function(t,e,i,r){var s=function(r,s){var n=t.defaults(s||{},{from:0,to:(new Date).getTime(),limit:10});e.call(this,n),this.baseLayer_=r,this.timeLayers_={},this.times_=[],this.animationLayerLoader_=n.animationLayerLoader||new i(this.baseLayer_,{from:this.from_,to:this.to_,limit:this.limit_}),this.loadAnimationLayers()};return t.inherits(s,e),s.prototype.loadAnimationLayers=function(){return this.baseLayer_.set({autoUpdate:!1,opacity:0}),this.bindLoadEvents_(),this.animationLayerLoader_.once("load:times",function(t,e){this.setTimeLayers_(e),this.updateTimeBounds_(),this.goToTime(this.to_),this.trigger("load:times",t,e)},this),this.animationLayerLoader_.load()},s.prototype.next=function(){var t=this.getNextTime_();t&&this.goToTime(t)},s.prototype.previous=function(){var t=this.getPreviousTime_();t&&this.goToTime(t)},s.prototype.goToTime=function(e){var i;if(e=t.isDate(e)?e.getTime():e,!t.isNumeric(e))throw new r("Invalid animation time: time must be a Date or a timestamp (number).");i=this.getLayerForTime_(e),i&&i.isLoaded()&&this.transition_(this.getCurrentLayer(),i),this.currentTime_=e,this.trigger("change:time",new Date(this.currentTime_))},s.prototype.getCurrentTime=function(){return this.currentTime_},s.prototype.getLoadProgress=function(){return this.animationLayerLoader_.getLoadProgress()},s.prototype.remove=function(){this.stop(),t.invoke(this.timeLayers_,"setOpacity",0)},s.prototype.setOpacity=function(t){var e=this.getCurrentLayer();
this.opacity_=t,e&&e.setOpacity(this.opacity_)},s.prototype.getTimes=function(){return t.clone(this.times_)},s.prototype.bindLoadEvents_=function(){var e=t.partial(this.proxyEvent_,this.animationLayerLoader_);t.each(["load:progress","load:complete","load:error","load:reset"],e,this)},s.prototype.setTimeLayers_=function(t){this.timeLayers_=t,this.times_=this.getOrderedTimesFromLayers_(t)},s.prototype.updateTimeBounds_=function(){this.from_=Math.min.apply(null,this.times_),this.to_=Math.max.apply(null,this.times_),this.limit_=this.times_.length},s.prototype.getOrderedTimesFromLayers_=function(e){var i=t.map(t.keys(e),function(t){return parseInt(t)});return t.sortBy(i,t.identity)},s.prototype.proxyEvent_=function(e,i){this.listenTo(e,i,function(){var e=t.argsToArray(arguments);this.trigger.apply(this,[i].concat(e))})},s.prototype.getLayerForTime_=function(t){return this.timeLayers_[this.getClosestTime_(t)]},s.prototype.getClosestTime_=function(e){var i=this.times_[0],r=Math.abs(e-i);return t.each(this.times_,function(t){var s=Math.abs(e-t);r>s&&(r=s,i=t)},this),i},s.prototype.transition_=function(t,e){this.hideAllLayersExcept_(e),e.setOpacity(this.opacity_)},s.prototype.hideAllLayersExcept_=function(e){t.each(this.timeLayers_,function(t){t.cid!==e.cid&&t.stop().hide()},this)},s.prototype.getCurrentLayer=function(){return this.getLayerForTime_(this.currentTime_)},s.prototype.getNextTime_=function(){return this.isCurrentLayerLast_()?this.times_[0]:this.times_[this.getLayerIndex_()+1]},s.prototype.getPreviousTime_=function(){var e=t.last(this.times_);return this.isCurrentLayerFirst_()?e:this.times_[this.getLayerIndex_()-1]},s.prototype.isCurrentLayerFirst_=function(){return 0===this.getLayerIndex_()},s.prototype.isCurrentLayerLast_=function(){return this.getLayerIndex_()===this.times_.length-1},s.prototype.getLayerIndex_=function(){var t=this.getClosestTime_(this.currentTime_);return this.times_.indexOf(t)},t.expose(s,"aeris.maps.animations.TileAnimation")}),n("aeris/maps/layers/animationlayer",["aeris/util","aeris/maps/layers/layer"],function(t,e){var i=function(i,r){var s=t.extend({autoUpdateInterval:6e4},i);e.call(this,s,r)};return t.inherits(i,e),i.prototype.fadeTo=function(e,i){var r=this.get("opacity")>e?-1:1,s=Math.abs(this.get("opacity")-e),n=13,o=i/n,a=s/o;this.stop(),this.animationClock_=window.setInterval(t.bind(function(){var t=this.get("opacity")+a*r;return 0>t||t>1?(this.setOpacity(e),void window.clearInterval(this.animationClock_)):(this.setOpacity(t),void((-1===r&&this.get("opacity")<=e||1===r&&this.get("opacity")>=e)&&window.clearInterval(this.animationClock_)))},this),n)},i.prototype.fadeOut=function(t){this.fadeTo(0,t)},i.prototype.fadeIn=function(t){this.fadeTo(1,t)},i.prototype.stop=function(){return this.animationClock_&&window.clearInterval(this.animationClock_),this},i.prototype.show=function(){this.setOpacity(1)},i.prototype.hide=function(){this.setOpacity(0)},i}),n("aeris/maps/animations/animationsync",["aeris/util","aeris/maps/animations/abstractanimation","aeris/maps/layers/animationlayer","aeris/maps/animations/tileanimation"],function(t,e,i,r){var s=function(i,s){var n=t.defaults(s||{},{AnimationType:r});e.call(this,s),this.options_={to:this.to_,from:this.from_},this.animations_=[],this.AnimationType_=n.AnimationType,this.add(i||[])};return t.inherits(s,e),s.prototype.add=function(e){var r;e=t.isArray(e)?e:[e],r=e.map(function(t){var e=t instanceof i;return e?new this.AnimationType_(t):t},this),t.each(r,this.addOne_,this)},s.prototype.addOne_=function(t){t.stop(),this.animations_.push(t),this.listenTo(t,{"load:times":function(){this.updateTimeBounds_(),this.trigger("load:times",this.getTimes())},"load:progress load:complete":this.triggerLoadProgress_,"load:error":function(t){this.trigger("load:error",t)},"load:reset":function(t){this.trigger("load:reset",t)}}),this.triggerLoadProgress_()},s.prototype.updateTimeBounds_=function(){var t=this.getTimes(),e=Math.min.apply(null,t),i=Math.max.apply(null,t);this.from_=Math.max(this.options_.from,e),this.to_=Math.min(this.options_.to,i),this.currentTime_=Math.max(this.from_,this.currentTime_),this.currentTime_=Math.min(this.to_,this.currentTime_)},s.prototype.remove=function(e){e=t.isArray(e)?e:[e],t.each(e,this.removeOne_,this)},s.prototype.removeOne_=function(e){this.stopListening(e),this.animations_=t.without(this.animations_,e),e.stop(),e.remove()},s.prototype.triggerLoadProgress_=function(){var t=this.getLoadProgress();return t>=1&&this.trigger("load:complete"),this.trigger("load:progress",t),t},s.prototype.getLoadProgress=function(){var e,i=[];return t.each(this.animations_,function(t){i.push(t.getLoadProgress())},this),e=t.average(i),e>=1&&this.trigger("load:complete"),this.trigger("load:progress",e),e},s.prototype.next=function(t){var e=t||this.timestep_,i=this.getNextTime_(this.currentTime_,e);this.goToTime(i)},s.prototype.getNextTime_=function(t,e){var i=t+e;return t>=this.to_?i=this.from_:i>=this.to_&&(i=this.to_),i},s.prototype.previous=function(t){var e=t||this.timestep_,i=this.getPrevTime_(this.currentTime_,e);this.goToTime(i)},s.prototype.getPrevTime_=function(t,e){var i=t-e;return t<=this.from_?i=this.to_:i<=this.from_&&(i=this.from_),i},s.prototype.goToTime=function(e){this.currentTime_=e,t.each(this.animations_,function(t){t.goToTime(this.currentTime_)},this),this.trigger("change:time",new Date(this.currentTime_))},s.prototype.getTimes=function(){var e=[];return t.each(this.animations_,function(t){e=e.concat(t.getTimes())}),t.sortBy(e,function(t){return t})},s.prototype.setOpacity=function(e){t.each(this.animations_,function(t){t.setOpacity(e)},this)},t.expose(s,"aeris.maps.animations.AnimationSync")}),n("aeris/packages/animations",["aeris/maps/animations/tileanimation","aeris/maps/animations/animationsync"],function(){}),n("aeris/maps/infobox",["aeris/util","aeris/events","aeris/maps/extensions/mapextensionobject","aeris/errors/validationerror"],function(t,e,i,r){var s=function(r,s){var n=t.extend({strategy:"infobox"},s),o=t.extend({position:[45,-90],content:""},r);i.call(this,o,n),e.call(this)};return t.inherits(s,i),t.extend(s.prototype,e.prototype),s.prototype.validate=function(e){return t.isArray(e.position)?i.prototype.validate.apply(this,arguments):new r(e.position+" is not a valid lat/lon coordinate")},s.prototype.setPosition=function(t){this.set("position",t,{validate:!0})},s.prototype.setContent=function(t){this.set("content",t,{validate:!0})},t.expose(s,"aeris.maps.InfoBox")}),n("aeris/packages/infobox",["aeris/maps/infobox"],function(){}),n("aeris/config",["module","backbone","aeris/util"],function(t,e,i){var r=function(t,r){var n=i.defaults(t||{},{assetPath:"//cdn.aerisjs.com/assets/"});e.Model.call(this,n,r),this.on("change:strategy",function(){s.config({map:{"*":{"aeris/maps/strategy":this.get("strategy")}}})},this)};return i.inherits(r,e.Model),r.prototype.validate=function(t){if(t.strategy&&-1===["gmaps","openlayers"].indexOf(t.strategy))throw new Error("Invalid map type strategy. Valid strategies are  'gmaps' or 'openlayers'")},r.prototype.setStrategy_=function(t){if(!t)throw new Error("Unable to set map type strategy: no strategy defined");this.set("strategy",t,{validate:!0})},r.prototype.setApiId=function(t){this.set("apiId",t,{validate:!0})},r.prototype.setApiSecret=function(t){this.set("apiSecret",t,{validate:!0})},i.expose(new r(t.config()),"aeris.config")}),n("aeris/errors/missingapikeyerror",["aeris/errors/errortypefactory"],function(t){return new t({name:"MissingApiKeyError"})}),n("aeris/errors/timeouterror",["aeris/errors/errortypefactory"],function(t){return new t({name:"TimeoutError"})}),n("aeris/maps/layers/abstracttile",["aeris/util","aeris/errors/unimplementedpropertyerror","aeris/errors/validationerror","aeris/maps/layers/animationlayer"],function(t,e,i,r){var s=function(e,i){var s=t.extend({strategy:"layers/tile",validate:!0},i),n=t.extend({subdomains:[],name:void 0,server:void 0,minZoom:0,maxZoom:22,opacity:1,zIndex:1},e);this.listenTo(this,{load:function(){this.loaded_=!0},"load:reset":function(){this.loaded_=!1}}),r.call(this,n,s)};return t.inherits(s,r),s.prototype.validate=function(e){return t.isString(e.name)?t.isString(e.server)?!t.isNumber(e.opacity)||e.opacity>1||e.opacity<0?new i("opacity","must be a number between 0 and 1"):r.prototype.validate.apply(this,arguments):new i("server","not a valid string"):new i("name","not a valid string")},s.prototype.getUrl=t.abstractMethod,s.prototype.getRandomSubdomain=function(){var t=Math.floor(Math.random()*this.get("subdomains").length);return this.get("subdomains")[t]},s.prototype.zoomFactor=function(t){return t},s.prototype.setOpacity=function(t){this.set("opacity",t,{validate:!0})},s.prototype.getOpacity=function(){return this.get("opacity")},s.prototype.setZIndex=function(t){this.set("zIndex",t,{validate:!0})},s.prototype.getZIndex=function(){return this.get("zIndex")},s.prototype.isLoaded=function(){return!!this.loaded_},s}),n("aeris/jsonp",["aeris/util"],function(t){return t.provide("aeris.jsonp"),aeris.jsonp=function(){function e(t,e){var i=document.createElement("script"),r=!1;i.src=t,i.async=!0;var s=e||a.error;"function"==typeof s&&(i.onerror=function(e){s({url:t,event:e})}),i.onload=i.onreadystatechange=function(){r||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(r=!0,i.onload=i.onreadystatechange=null,i&&i.parentNode&&i.parentNode.removeChild(i))},n||(n=document.getElementsByTagName("head")[0]),n.appendChild(i)}function i(t){return encodeURIComponent(t)}function r(r,s,n,l,p){var u,c=-1===(r||"").indexOf("?")?"?":"&";p=p||a.callbackName||"callback",l=l||p+t.uniqueId("_aeris_jsonp_"),s=s||{};for(u in s)s.hasOwnProperty(u)&&(c+=i(u)+"="+i(s[u])+"&");return o[l]=function(t){n(t);try{delete o[l]}catch(e){}o[l]=null},e(r+c+p+"="+l),l}function s(t){a=t}var n,o=this,a={};return{get:r,init:s}}(),aeris.jsonp}),n("aeris/maps/layers/config/zindex",{Radar:70,SatelliteGlobal:60,SatelliteVisible:60,Satellite:60,Advisories:45,Temps:40,WindChill:40,Winds:40,HeatIndex:40,Humidity:40,DewPoints:40,SnowDepth:30,Chlorophyll:10,SeaSurfaceTemps:10}),n("aeris/maps/layers/aeristile",["aeris/util","aeris/config","aeris/promise","aeris/errors/validationerror","aeris/errors/missingapikeyerror","aeris/errors/timeouterror","aeris/maps/layers/abstracttile","aeris/jsonp","aeris/maps/layers/config/zindex"],function(t,e,i,r,s,n,o,a,l){var p=function(i,r){var s=t.extend({strategy:"layers/aeristile",validate:!0,jsonp:a},r),n=t.extend({subdomains:["1","2","3","4"],server:"http://tile{d}.aerisapi.com/",maxZoom:27,minZoom:1,time:new Date(0),tileType:void 0,timeIndex:0,animationStep:1,autoUpdateInterval:p.updateIntervals.CURRENT,autoUpdate:!0,apiId:e.get("apiId"),apiSecret:e.get("apiSecret")},i);n.zIndex=n.zIndex||l[n.name]||1,this.autoUpdateIntervalTimer_,this.loaded_=!1,this.jsonp_=s.jsonp,o.call(this,n,s),this.bindToApiKeys_()};return t.inherits(p,o),p.prototype.initialize=function(){var t=function(){var t=this.get("autoUpdate")?this.startAutoUpdate_:this.stopAutoUpdate_;t.call(this)}.bind(this);t(),this.on({"change:autoUpdate":t,"change:autoUpdateInterval":function(){this.stopAutoUpdate_(),this.startAutoUpdate_()}},this),o.prototype.initialize.apply(this,arguments)},p.prototype.bindToApiKeys_=function(){this.listenTo(e,"change:apiId change:apiSecret",function(){this.set({apiId:this.get("apiId")||e.get("apiId"),apiSecret:this.get("apiSecret")||e.get("apiSecret")})})},p.prototype.startAutoUpdate_=function(){var t=this;this.autoUpdateIntervalTimer_=window.setInterval(function(){t.set("time",new Date(0))},this.get("autoUpdateInterval"))},p.prototype.stopAutoUpdate_=function(){this.autoUpdateIntervalTimer_&&window.clearInterval(this.autoUpdateIntervalTimer_)},p.prototype.validate=function(e){return t.isString(e.tileType)?t.isNumber(e.autoUpdateInterval)?e.minZoom<1?new r("minZoom for Aeris Interactive tiles must be more than 0"):o.prototype.validate.apply(this,arguments):new r("autoUpdateInterval","not a valid number"):new r("tileType","not a valid string")},p.updateIntervals={RADAR:36e4,CURRENT:36e5,MODIS:864e5,SATELLITE:18e5,ADVISORIES:18e4},p.prototype.getTileTimesCallback=function(){return this.get("tileType")+"Times"},p.prototype.getUrl=function(){return this.ensureApiKeys_(),this.get("server")+this.get("apiId")+"_"+this.get("apiSecret")+"/"+this.get("tileType")+"/{z}/{x}/{y}/{t}.png"},p.prototype.ensureApiKeys_=function(){if(this.set({apiId:this.get("apiId")||e.get("apiId"),apiSecret:this.get("apiSecret")||e.get("apiSecret")}),!this.get("apiId")||!this.get("apiSecret"))throw new s("Aeris API id and secret required to render interactive tiles.")},p.prototype.getTimestamp=function(){return this.get("time").getTime()},p.prototype.getAerisTimeString=function(){var e,i=this.get("time");return i.getTime()<=0?i.getTime():(e=i.getFullYear().toString(),t.each([i.getUTCMonth()+1,i.getUTCDate(),i.getUTCHours(),i.getUTCMinutes(),i.getUTCSeconds()],function(t){t=t.toString(),t=2===t.length?t:"0"+t,e+=t}),e)},p.prototype.loadTileTimes=function(){var e=5e3,r=new i,s=this.createTileTimesUrl_();return this.jsonp_.get(s,{},t.bind(function(t){var e;t.files&&t.files.length||r.reject(new Error("Failed to load tile times: no time data was returned.")),e=this.parseTileTimes_(t),r.resolve(e)},this),this.getTileTimesCallback()),this.rejectAfterTimeout_(r,e,"Timeout while loading Aeris Interactive Tile times."),r},p.prototype.rejectAfterTimeout_=function(e,i,r){t.delay(function(){"pending"===e.getState()&&e.reject(new n(r))}.bind(this),i)},p.prototype.createTileTimesUrl_=function(){var t="{server}/{client_id}_{client_secret}/{tileType}.jsonp";return this.ensureApiKeys_(),t.replace("{server}","http://tile.aerisapi.com").replace("{client_id}",this.get("apiId")).replace("{client_secret}",this.get("apiSecret")).replace("{tileType}",this.get("tileType"))},p.prototype.parseTileTimes_=function(e){return t.map(e.files,function(t){return 1e3*t.timestamp})},t.expose(p,"aeris.maps.layers.AerisTile")}),n("aeris/maps/layers/advisories",["aeris/util","aeris/maps/layers/aeristile"],function(t,e){var i=function(i,r){var s=t.extend({name:"Advisories",tileType:"alerts",autoUpdateInterval:e.updateIntervals.ADVISORIES},i);e.call(this,s,r)};return t.inherits(i,e),t.expose(i,"aeris.maps.layers.Advisories")}),n("aeris/maps/layers/modistile",["aeris/util","aeris/errors/invalidargumenterror","aeris/maps/layers/aeristile"],function(t,e,i){var r=function(e,r){var s=t.extend({period:14},r),n=t.extend({autoUpdateInterval:i.updateIntervals.MODIS,modisPeriodTileTypes:{}},e);t.extend(n,{tileType:n.modisPeriodTileTypes[s.period]}),i.call(this,n,r),this.setModisPeriod(s.period)};return t.inherits(r,i),r.prototype.setModisPeriod=function(i){var r=t.keys(this.get("modisPeriodTileTypes"));if(i=parseInt(i),!i||1>i)throw new e("Invalid MODIS period: period must be a positive integer");if(!(i in this.get("modisPeriodTileTypes")))throw new e("Invalid MODIS periods: available periods are: "+r.join(","));this.set("tileType",this.get("modisPeriodTileTypes")[i],{validate:!0})},r}),n("aeris/maps/layers/chlorophyll",["aeris/util","aeris/maps/layers/modistile"],function(t,e){var i=function(i,r){var s=t.extend({name:"Chlorophyll",modisPeriodTileTypes:{1:"modis_chlo_1day",3:"modis_chlo_3day",7:"modis_chlo_7day",14:"modis_chlo_14day"}},i);e.call(this,s,r)};return t.inherits(i,e),t.expose(i,"aeris.maps.layers.Chlorophyll")}),n("aeris/maps/layers/dewpoints",["aeris/util","aeris/maps/layers/aeristile"],function(t,e){var i=function(i,r){var s=t.extend({name:"DewPoints",tileType:"current_dp",autoUpdateInterval:e.updateIntervals.CURRENT},i);e.call(this,s,r)};return t.inherits(i,e),t.expose(i,"aeris.maps.layers.DewPoints")}),n("aeris/maps/layers/heatindex",["aeris/util","aeris/maps/layers/aeristile"],function(t,e){var i=function(i,r){var s=t.extend({name:"HeatIndex",tileType:"current_heat_index",autoUpdateInterval:e.updateIntervals.CURRENT},i);e.call(this,s,r)};return t.inherits(i,e),t.expose(i,"aeris.maps.layers.HeatIndex")}),n("aeris/maps/layers/humidity",["aeris/util","aeris/maps/layers/aeristile"],function(t,e){var i=function(i,r){var s=t.extend({name:"Humidity",tileType:"current_rh",autoUpdateInterval:e.updateIntervals.CURRENT},i);e.call(this,s,r)};return t.inherits(i,e),t.expose(i,"aeris.maps.layers.Humidity")}),n("aeris/maps/layers/radar",["aeris/util","aeris/maps/layers/aeristile"],function(t,e){var i=function(i,r){var s=t.extend({name:"Radar",tileType:"radar",autoUpdateInterval:e.updateIntervals.RADAR},i);e.call(this,s,r)};return t.inherits(i,e),t.expose(i,"aeris.maps.layers.Radar")}),n("aeris/maps/layers/satellite",["aeris/util","aeris/maps/layers/aeristile"],function(t,e){var i=function(i,r){var s=t.extend({name:"Satellite",tileType:"sat",autoUpdateInterval:e.updateIntervals.SATELLITE},i);e.call(this,s,r)};return t.inherits(i,e),t.expose(i,"aeris.maps.layers.Satellite")}),n("aeris/maps/layers/satelliteglobal",["aeris/util","aeris/maps/layers/aeristile"],function(t,e){var i=function(i,r){var s=t.extend({name:"SatelliteGlobal",tileType:"globalsat",autoUpdateInterval:e.updateIntervals.SATELLITE},i);e.call(this,s,r)};return t.inherits(i,e),t.expose(i,"aeris.maps.layers.SatelliteGlobal")}),n("aeris/maps/layers/satellitevisible",["aeris/util","aeris/maps/layers/aeristile"],function(t,e){var i=function(i,r){var s=t.extend({name:"SatelliteVisible",tileType:"sat_vistrans",autoUpdateInterval:e.updateIntervals.SATELLITE},i);e.call(this,s,r)};return t.inherits(i,e),t.expose(i,"aeris.maps.layers.SatelliteVisible")}),n("aeris/maps/layers/seasurfacetemps",["aeris/util","aeris/maps/layers/modistile"],function(t,e){var i=function(i,r){var s={1:"modis_sst_1day",3:"modis_sst_3day",7:"modis_sst_7day",14:"modis_sst_14day"},n=t.extend({name:"SeaSurfaceTemps",modisPeriodTileTypes:s},i);e.call(this,n,r)};return t.inherits(i,e),t.expose(i,"aeris.maps.layers.SeaSurfaceTemps")}),n("aeris/maps/layers/snowdepth",["aeris/util","aeris/maps/layers/aeristile"],function(t,e){var i=function(i,r){var s=t.extend({name:"SnowDepth",tileType:"snowdepth_snodas",autoUpdateInterval:e.updateIntervals.MODIS},i);e.call(this,s,r)};return t.inherits(i,e),t.expose(i,"aeris.maps.layers.SnowDepth")}),n("aeris/maps/layers/temps",["aeris/util","aeris/maps/layers/aeristile"],function(t,e){var i=function(i,r){var s=t.extend({name:"Temps",tileType:"current_temps",autoUpdateInterval:e.updateIntervals.CURRENT},i);e.call(this,s,r)};return t.inherits(i,e),t.expose(i,"aeris.maps.layers.Temps")}),n("aeris/maps/layers/windchill",["aeris/util","aeris/maps/layers/aeristile"],function(t,e){var i=function(i,r){var s=t.extend({name:"WindChill",tileType:"current_windchill",autoUpdateInterval:e.updateIntervals.CURRENT},i);e.call(this,s,r)};return t.inherits(i,e),t.expose(i,"aeris.maps.layers.WindChill")}),n("aeris/maps/layers/winds",["aeris/util","aeris/maps/layers/aeristile"],function(t,e){var i=function(i,r){var s=t.extend({name:"Winds",tileType:"current_winds",autoUpdateInterval:e.updateIntervals.CURRENT},i);e.call(this,s,r)};return t.inherits(i,e),t.expose(i,"aeris.maps.layers.Winds")}),n("aeris/maps/strategy/layers/abstractmaptype",["aeris/util","aeris/maps/strategy/abstractstrategy"],function(t,e){var i=function(i){this.prevMapTypeId_,this.mapTypeId_=this.mapTypeId_||i.get("mapTypeId")||i.get("name"),this.isBaseLayer_=t.isUndefined(this.isBaseLayer_)?!1:this.isBaseLayer_,e.apply(this,arguments)};return t.inherits(i,e),i.prototype.createView_,i.prototype.setMap=function(i,r){var s=t.extend({baseLayer:this.isBaseLayer_},r);e.prototype.setMap.call(this,i,s),this.prevMapTypeId_=this.mapView_.mapTypeId,this.registerMapType_(),s.baseLayer?(this.mapView_.setMapTypeId(this.mapTypeId_),this.isBaseLayer_=!0):(this.mapView_.overlayMapTypes.push(this.getView()),this.isBaseLayer_=!1),this.delegateMapEvents_()},i.prototype.registerMapType_=function(){if(!this.mapView_)throw new InvalidArgumentError("Cannot register map type: "+this.getView()+": no map is associated with this layer view");this.mapView_.mapTypes.set(this.mapTypeId_,this.getView())},i.prototype.beforeRemove_=function(){var e;this.isBaseLayer_?this.prevMapTypeId_&&this.mapView_.setMapTypeId(this.prevMapTypeId_):(t.each(this.mapView_.overlayMapTypes.getArray(),function(t,i){t.name===this.getView().name&&(e=i)},this),this.mapView_.overlayMapTypes.removeAt(e)),this.undelegateMapEvents_()},i.prototype.delegateMapEvents_=function(){},i.prototype.undelegateMapEvents_=function(){this.googleEvents_.stopListening(this.mapView_)},i}),n("aeris/maps/strategy/layers/maptype/imagemaptypeeventhub",["aeris/events"],function(t){return new t}),n("aeris/maps/strategy/layers/maptype/imagemaptype",["aeris/util","aeris/maps/strategy/layers/maptype/imagemaptypeeventhub","googlemaps!"],function(t,e,i){var r=function(r){t.defaults(r,{zIndex:1,opacity:1,tileSize:new i.Size(256,256)}),t.extend(this,t.pick(r,["alt","maxZoom","minZoom","name","projection","radius","tileSize"])),this.getTileUrl_=r.getTileUrl,this.divs_=[],this.imgs_=[],this.loadedImgs_=[],this.zIndex_=r.zIndex,this.opacity_=r.opacity,this.document_=null,e.on("init",function(t){t!==this&&this.setParentNodeZIndex_(this.zIndex_)},this)};return r.prototype.getTile=function(i,r,s){var n,o,a;return this.document_=this.document_||s,i=this.getNormalizedCoord_(i,r),a=this.createTileContainer_(s),i&&(n=this.getTileUrl_(i,r),o=this.createTileImage_(s,n),o.onload=t.bind(function(){this.addLoadedImage_(o)},this),a.appendChild(o),this.imgs_.push(o)),this.setZIndex(this.zIndex_),this.divs_.push(a),this.getParentNode_()||e.trigger("init",this),a},r.prototype.getNormalizedCoord_=function(t,e){var i=t.y,r=t.x,s=1<<e;return 0>i||i>=s?null:((0>r||r>=s)&&(r=(r%s+s)%s),{x:r,y:i})},r.prototype.createTileContainer_=function(t){var e=t.createElement("div");return e.style.width=this.tileSize.width+"px",e.style.height=this.tileSize.height+"px",e.style.opacity=this.opacity_,e},r.prototype.createTileImage_=function(t,e){var i;if(!e)throw new Error("Unable to create tile image: "+e+" is not a valid tile image source.");return i=t.createElement("img"),i.style.width="100%",i.style.height="100%",i.setAttribute("src",e),i},r.prototype.addLoadedImage_=function(t){this.loadedImgs_.push(t),this.imgs_.length===this.loadedImgs_.length&&i.event.trigger(this,"load")},r.prototype.getParentNode_=function(){var t=this.parentNode_&&this.document_.contains(this.parentNode_);if(t)return this.parentNode_;try{this.parentNode_=this.divs_[0].parentNode.parentNode,this.setParentNodeZIndex_(this.zIndex_)}catch(e){this.parentNode_=null}return this.parentNode_},r.prototype.setZIndex=function(t){t!==this.zIndex_&&(this.zIndex_=t,this.setParentNodeZIndex_(this.zIndex_))},r.prototype.setParentNodeZIndex_=function(t){var e=this.getParentNode_(),i=e&&window.getComputedStyle(e).zIndex===this.zIndex_;e&&!i&&(e.style.zIndex=t)},r.prototype.releaseTile=function(t){var e=t.getElementsByTagName("img"),i=this.divs_.indexOf(t),r=this.imgs_.indexOf(e),s=this.loadedImgs_.indexOf(e);this.divs_.splice(i,1),this.imgs_.splice(r,1),this.loadedImgs_.splice(s,1)},r.prototype.setOpacity=function(e){this.opacity_!==e&&(this.opacity_=e,t.each(this.divs_,function(t){window.getComputedStyle(t).opacity!==this.opacity_&&(t.style.opacity=this.opacity_)},this))},r}),n("aeris/maps/strategy/layers/tile",["aeris/util","aeris/maps/strategy/layers/abstractmaptype","aeris/maps/strategy/layers/maptype/imagemaptype","googlemaps!"],function(t,e,i,r){var s=function(r,s){var n=t.extend({MapType:i},s);this.MapType_=n.MapType,e.apply(this,arguments),this.listenTo(this.object_,{"change:opacity":this.updateOpacity,"change:zIndex":this.updateZIndex_},this),this.updateOpacity()};return t.inherits(s,e),s.prototype.createView_=function(){var t=this.getMapTypeOptions_();return this.view_=new this.MapType_(t),this.proxyViewEvents_(),this.view_},s.prototype.proxyViewEvents_=function(){this.googleEvents_.listenTo(this.getView(),"load",function(){this.object_.trigger("load")},this)},s.prototype.delegateMapEvents_=function(){this.googleEvents_.listenTo(this.mapView_,"bounds_changed",function(){this.object_.trigger("load:reset")},this),this.googleEvents_.listenTo(this.mapView_,"zoom_changed",function(){this.object_.trigger("load:reset")},this),e.prototype.delegateMapEvents_.apply(this,arguments)},s.prototype.getMapTypeOptions_=function(){return{getTileUrl:t.bind(this.getUrl_,this),tileSize:new r.Size(256,256),minZoom:this.object_.get("minZoom"),maxZoom:this.object_.get("maxZoom"),name:this.object_.get("name"),opacity:this.object_.get("opacity"),zIndex:this.object_.get("zIndex")}},s.prototype.getUrl_=function(t,e){var i,r=this.object_.zoomFactor(e),s=this.object_.getRandomSubdomain();return i=this.object_.getUrl(),i=i.replace(/\{d\}/,s).replace(/\{z\}/,r).replace(/\{x\}/,t.x).replace(/\{y\}/,t.y)},s.prototype.updateOpacity=function(){var t=this.object_.get("opacity");this.getView().setOpacity(t)},s.prototype.updateZIndex_=function(){var t=this.object_.get("zIndex");this.getView().setZIndex(t)},s}),n("aeris/maps/strategy/layers/osm",["aeris/util","aeris/maps/strategy/layers/tile"],function(t,e){var i=function(){this.isBaseLayer_=!0,e.apply(this,arguments)};return t.inherits(i,e),i}),n("aeris/maps/layers/osm",["aeris/util","aeris/maps/layers/abstracttile","aeris/maps/strategy/layers/osm"],function(t,e,i){var r=function(r,s){var n=t.extend({strategy:i},s),o=t.extend({name:"OpenStreetMap",subdomains:["a","b","c"],server:"http://{d}.tile.openstreetmap.org/",maxZoom:18},r);e.call(this,o,n)};return t.inherits(r,e),r.prototype.getUrl=function(){return this.get("server")+"{z}/{x}/{y}.png"},t.expose(r,"aeris.maps.layers.OSM")}),n("aeris/packages/layers/tilelayers",["aeris/maps/layers/advisories","aeris/maps/layers/chlorophyll","aeris/maps/layers/dewpoints","aeris/maps/layers/heatindex","aeris/maps/layers/humidity","aeris/maps/layers/radar","aeris/maps/layers/satellite","aeris/maps/layers/satelliteglobal","aeris/maps/layers/satellitevisible","aeris/maps/layers/seasurfacetemps","aeris/maps/layers/snowdepth","aeris/maps/layers/temps","aeris/maps/layers/windchill","aeris/maps/layers/winds","aeris/maps/layers/osm"],function(){}),n("aeris/maps/layers/googlehybrid",["aeris/util","aeris/maps/layers/googlemaptype"],function(t,e){var i=function(i,r){var s=t.extend({mapTypeId:"HYBRID",name:"GoogleHybrid"},i);e.call(this,s,r)};return t.inherits(i,e),t.expose(i,"aeris.maps.layers.GoogleHybrid")}),n("aeris/maps/layers/googlesatellite",["aeris/util","aeris/maps/layers/googlemaptype"],function(t,e){var i=function(i,r){var s=t.extend({mapTypeId:"SATELLITE",name:"GoogleSatellite"},i);e.call(this,s,r)};return t.inherits(i,e),t.expose(i,"aeris.maps.layers.GoogleSatellite")}),n("aeris/maps/layers/googleterrain",["aeris/util","aeris/maps/layers/googlemaptype"],function(t,e){var i=function(i,r){var s=t.extend({mapTypeId:"TERRAIN",name:"GoogleTerrain"},i);e.call(this,s,r)};return t.inherits(i,e),t.expose(i,"aeris.maps.layers.GoogleTerrain")}),n("aeris/packages/layers/googlelayers",["aeris/maps/layers/googlehybrid","aeris/maps/layers/googleroadmap","aeris/maps/layers/googlesatellite","aeris/maps/layers/googleterrain"],function(){}),n("aeris/maps/layers/polygons",["aeris/util","aeris/maps/layers/layer"],function(t,e){var i=function(i,r){var s=t.extend({opacity:1},i);e.call(this,s,r)};return t.inherits(i,e),i.prototype.setOpacity=function(t){this.set("opacity",t,{validate:!0})},i}),n("aeris/maps/strategy/layers/aerispolygons",["aeris/util","aeris/maps/strategy/abstractstrategy","googlemaps!"],function(t,e,i){var r=function(){e.apply(this,arguments),this.listenTo(this.object_,{change:this.updateStyles_})};return t.inherits(r,e),r.prototype.createView_=function(){var e={};return this.object_.fetch().done(function(r){t.each(r.groups,function(r){var s,n;s=t.extend({paths:this.parseGroupPaths_(r),clickable:!1,groupValue:r.value},this.object_.get("styles")[r.value]),n=new i.Polygon(s),e[r.value]=n,this.mapView_&&this.refreshMap_()},this)},this),e},r.prototype.parseGroupPaths_=function(e){var r=[];return t.each(e.polygons,function(t){var e=i.geometry.encoding.decodePath(t.points);r.push(e)},this),r},r.prototype.refreshMap_=function(){t.each(this.getView(),function(t){t.setMap(this.mapView_)},this)},r.prototype.getUrl_=function(){return"http://gis.hamweather.net/json/"+this.object_.get("aerisPolygonType")+".json"},r.prototype.setMap=function(){e.prototype.setMap.apply(this,arguments),this.refreshMap_()},r.prototype.afterRemove_=function(){this.refreshMap_()},r.prototype.setOpacity_=function(t){t=parseFloat(this.object_.get("opacity"))},r.prototype.updateStyles_=function(){var e=this.object_.get("opacity");t.each(this.getView(),function(i,r){var s=this.object_.get("styles")[r],n=t.extend({},s,{fillColor:s.fillColor,strokeColor:s.strokeColor,fillOpacity:s.fillOpacity*e,strokeOpacity:s.strokeOpacity*e});i.setOptions(n)},this)},r}),n("aeris/maps/layers/aerispolygons",["aeris/util","aeris/promise","aeris/jsonp","aeris/maps/layers/polygons","aeris/maps/strategy/layers/aerispolygons"],function(t,e,i,r,s){var n=function(e,i){var n=t.extend({strategy:s},i),o=t.extend({aerisPolygonType:void 0,styles:{},url:"http://gis.hamweather.net/json/{type}.json"},e);r.call(this,o,n)};return t.inherits(n,r),n.prototype.getUrl_=function(e){var i=t.extend({decoded:!1},e),r=this.get("url").replace(/{type}/,this.get("aerisPolygonType"));return i.decoded&&(r=r.replace(/\.json/,"_decoded.json")),r},n.prototype.fetch=function(t){var r=new e;return i.get(this.getUrl_(t),null,function(t){r.resolve(t)},"C"),r},n}),n("aeris/maps/layers/convectivehazards",["aeris/util","aeris/maps/layers/aerispolygons"],function(t,e){var i=function(i,r){var s=t.extend({aerisPolygonType:"convective/conhazo_day1",styles:{2:{fillColor:"#afad24",fillOpacity:.5,strokeColor:"#afad24",strokeOpacity:1,strokeWeight:2},4:{fillColor:"#dd8700",fillOpacity:.5,strokeColor:"#dd8700",strokeOpacity:1,strokeWeight:2},6:{fillColor:"#d90000",fillOpacity:.5,strokeColor:"#d90000",strokeOpacity:1,strokeWeight:2},8:{fillColor:"#ff46ae",fillOpacity:.5,strokeColor:"#ff46ae",strokeOpacity:1,strokeWeight:2}}},i);e.call(this,s,r)};return t.inherits(i,e),t.expose(i,"aeris.maps.layers.ConvectiveHazards")}),n("aeris/maps/strategy/layers/kml",["aeris/util","aeris/util/gmaps","aeris/maps/strategy/abstractstrategy","googlemaps!"],function(t,e,i,r){var s=function(){i.apply(this,arguments),this.googleEvents_.listenTo(this.getView(),{click:function(i){var r=e.latLngToArray(i.latLng),s=t.extend({name:"",author:"",description:"",snipped:""},t.pick(i.featureData,["name","author","description","snippet"]));this.object_.trigger("click",r,s)}},this)};return t.inherits(s,i),s.prototype.createView_=function(){var t=this.getOptions_();return new r.KmlLayer(t)},s.prototype.getUrl_=function(){var t=new Date;return this.object_.get("url")+"?"+t.getHours().toString()+t.getMinutes().toString()},s.prototype.getOptions_=function(){return{url:this.getUrl_(),preserveViewport:!0,suppressInfoWindows:!0}},s.prototype.setMap=function(){i.prototype.setMap.apply(this,arguments),this.getView().setMap(this.mapView_)},s.prototype.beforeRemove_=function(){this.getView().setMap(null)},s}),n("aeris/maps/layers/kml",["aeris/util","aeris/maps/layers/animationlayer","aeris/maps/strategy/layers/kml"],function(t,e){var i=function(i,r){var s=t.extend({strategy:"layers/kml"},r),n=t.extend({url:void 0},i);e.call(this,n,s)};return t.inherits(i,e),i}),n("aeris/maps/layers/advisorieskml",["aeris/util","aeris/maps/layers/kml"],function(t,e){var i=function(i,r){var s=t.extend({url:"http://gis.hamweather.net/kml/hwadv_all.kml",autoUpdateInterval:18e4},i);e.call(this,s,r)};return t.inherits(i,e),t.expose(i,"aeris.maps.layers.AdvisoriesKML")}),n("aeris/packages/layers",["aeris/packages/layers/tilelayers","aeris/packages/layers/googlelayers","aeris/maps/layers/convectivehazards","aeris/maps/layers/advisorieskml"],function(){}),n("aeris/togglebehavior",["aeris/util"],function(){var t=function(){this.has("selected")||this.set("selected",!1),this.bindToggleEvents_()
};return t.prototype.bindToggleEvents_=function(){this.listenTo(this,{"change:selected":function(t,e){var i=e?"select":"deselect";this.trigger(i,t)}})},t.prototype.select=function(){this.set("selected",!0)},t.prototype.deselect=function(){this.set("selected",!1)},t.prototype.toggle=function(){this.set("selected",!this.get("selected"))},t.prototype.isSelected=function(){return this.get("selected")},t}),n("aeris/maps/strategy/markers/marker",["aeris/util","aeris/util/gmaps","aeris/maps/strategy/abstractstrategy","googlemaps!"],function(t,e,i,r){var s=function(e,s){var n=t.defaults(s||{},{googlemaps:r});this.gmaps_=n.googlemaps,this.marker_=e,i.call(this,this.marker_),this.proxyViewEvents_(),this.listenTo(this.marker_,{"change:position":this.updatePosition_,"change:title":this.updateTitle_,"change:url change:offsetX change:offsetY":this.updateIcon_,"change:selectedUrl change:selectedOffsetX change:selectedOffsetY":this.updateIcon_,"change:selected":this.updateIcon_,"change:clickable":this.updateClickable_,"change:draggable":this.updateDraggable_})};return t.inherits(s,i),s.prototype.createView_=function(){return new this.gmaps_.Marker(this.getViewOptions_())},s.prototype.setMap=function(){i.prototype.setMap.apply(this,arguments),this.getView().setMap(this.mapView_)},s.prototype.beforeRemove_=function(){this.getView().setMap(null)},s.prototype.getViewOptions_=function(){return{position:e.arrayToLatLng(this.marker_.get("position")),icon:this.createIcon_(),flat:!0,clickable:this.marker_.get("clickable"),draggable:this.marker_.get("draggable"),title:this.marker_.get("title")}},s.prototype.createIcon_=function(){return{url:this.marker_.get(this.marker_.isSelected()?"selectedUrl":"url"),anchor:this.createAnchorPoint_()}},s.prototype.createAnchorPoint_=function(){var t=this.marker_.get(this.marker_.isSelected()?"selectedOffsetX":"offsetX"),e=this.marker_.get(this.marker_.isSelected()?"selectedOffsetY":"offsetY");return new this.gmaps_.Point(t,e)},s.prototype.proxyViewEvents_=function(){this.googleEvents_.listenTo(this.getView(),{click:function(t){var i=e.latLngToArray(t.latLng);this.marker_.trigger("click",i,this.marker_)},dragend:function(t){var i=e.latLngToArray(t.latLng);this.marker_.trigger("dragend",i,this.marker_),this.marker_.setPosition(i)}},this)},s.prototype.updatePosition_=function(){var t=e.arrayToLatLng(this.marker_.get("position"));this.getView().setPosition(t)},s.prototype.updateTitle_=function(){this.getView().setTitle(this.marker_.get("title"))},s.prototype.updateIcon_=function(){var t=this.createIcon_();this.getView().setIcon(t)},s.prototype.updateClickable_=function(){this.getView().setClickable(this.marker_.get("clickable"))},s.prototype.updateDraggable_=function(){this.getView().setDraggable(this.marker_.get("draggable"))},s}),n("aeris/maps/markers/marker",["aeris/util","aeris/maps/extensions/mapextensionobject","aeris/togglebehavior","aeris/errors/validationerror","aeris/maps/strategy/markers/marker"],function(t,e,i,r,s){var n=function(r,n){var o=t.defaults(n||{},{strategy:s}),a=t.defaults(r||{},{position:[45,-90],url:"//iwx.aerisapi.com/v1.6/wnmapapp/css/assets/markers/earthquake/quake_mini.png",offsetX:9,offsetY:9,clickable:!0,draggable:!1,title:""});a.selectedUrl||(a.selectedUrl=a.url),a.selectedOffsetX||(a.selectedOffsetX=a.offsetX),a.selectedOffsetY||(a.selectedOffsetY=a.offsetY),e.call(this,a,o),i.call(this)};return t.inherits(n,e),t.extend(n.prototype,i.prototype),n.prototype.validate=function(e){return!e.position||t.isArray(e.position)&&t.isNumber(e.position[0])&&t.isNumber(e.position[1])&&2===e.position.length?t.isString(e.title)?void 0:new r(e.title+" is not a valid marker title."):new r(e.position.toString()+" is not a valid latLon position")},n.prototype.setPosition=function(t){this.set("position",t,{validate:!0})},n.prototype.getPosition=function(){return this.get("position")},n.prototype.setUrl=function(t){this.set("url",t,{validate:!0})},n.prototype.getUrl=function(){return this.get("url")},n.prototype.setSelectedUrl=function(t){this.set("selectedUrl",t,{validate:!0})},n.prototype.getSelectedUrl=function(){return this.get("selectedUrl")},n.prototype.getType=function(){return null},t.expose(n,"aeris.maps.markers.Marker")}),n("aeris/collection",["aeris/util","aeris/model","aeris/events","backbone","aeris/errors/invalidargumenterror"],function(t,e,i,r,s){var n=function(n,o){var a=t.extend({model:e,validate:!1,modelOptions:{}},o);if(n&&!t.isArray(n))throw new s(n+" is not a valid array of models.");this.modelOptions_=a.modelOptions,r.Collection.call(this,n,a),i.call(this),a.validate&&this.isValid()};return t.inherits(n,r.Collection),t.extend(n.prototype,i.prototype),n.prototype.isValid=function(){var t=!0;return this.each(function(e){e.isValid()||(t=!1)}),t},n.prototype._prepareModel=function(e,i){var s=t.defaults(i||{},this.modelOptions_);return r.Collection.prototype._prepareModel.call(this,e,s)},t.expose(n,"aeris.Collection")}),n("aeris/viewcollection",["aeris/util","aeris/collection","aeris/viewmodel"],function(t,e,i){var r=function(r,s){var n=s&&s.data,o=t.defaults(s||{},{data:new e,model:i});this.data_=o.data,this.viewModelLookup_={},e.call(this,r,o),this.bindToDataCollection_(),n&&this.updateModelsFromData_()};return t.inherits(r,e),r.prototype.bindToDataCollection_=function(){this.listenTo(this.data_,{add:this.addViewModel_,remove:this.removeViewModel_,reset:this.updateModelsFromData_}),this.proxyDataSyncEvents_()},r.prototype.proxyDataSyncEvents_=function(){this.listenTo(this.data_,{request:function(t,e){this.trigger("data:request",this,e)},sync:function(t,e){this.trigger("data:sync",this,e)}})},r.prototype.addViewModel_=function(t){var e=this.createViewModel_(t);this.viewModelLookup_[t.cid]=e,this.add(e)},r.prototype.removeViewModel_=function(t){var e=this.viewModelLookup_[t.cid];e&&(this.remove(e),delete this.viewModelLookup_[t.cid])},r.prototype.updateModelsFromData_=function(){var t=[];this.viewModelLookup_={},this.data_.each(function(e){var i=this.createViewModel_(e);this.viewModelLookup_[e.cid]=i,t.push(i)},this),this.reset(t)},r.prototype.createViewModel_=function(e){return this._prepareModel(void 0,t.defaults({},this.modelOptions_,{data:e}))},r.prototype.getData=function(){return this.data_},r.prototype.fetchData=function(t){return this.data_.fetch(t)},r}),n("aeris/maps/extensions/mapobjectcollection",["aeris/util","aeris/viewcollection"],function(t,e){var i=function(){e.apply(this,arguments),this.bindChildrenToMap_()};return t.inherits(i,e),i.prototype.bindChildrenToMap_=function(){this.listenTo(this,{add:function(t){t.setMap(this.map_)},remove:function(t){t.setMap(null)}})},i.prototype.setMap=function(t,e){var i=e||{},r=t?"map:set":"map:remove",s=t===this.map_;this.map_=t,this.invoke("setMap",t,i),s||i.silent||this.trigger(r,this,t)},i.prototype.getMap=function(){return this.map_},i.prototype.hasMap=function(){return!!this.map_},i.prototype._onModelEvent=function(t){var i="map:set"===t||"map:remove"===t;i||e.prototype._onModelEvent.apply(this,arguments)},i}),n("aeris/togglecollectionbehavior",["aeris/util"],function(){var t=function(){};return t.prototype.selectAll=function(){this.invoke("select")},t.prototype.deselectAll=function(){this.invoke("deselect")},t.prototype.toggleAll=function(){this.invoke("toggle")},t.prototype.selectOnly=function(t){this.each(function(e){e!==t&&e.deselect()}),t.select()},t.prototype.getSelected=function(){return this.filter(function(t){return t.isSelected()},this)},t.prototype.getDeselected=function(){return this.filter(function(t){return!t.isSelected()},this)},t}),n("aeris/maps/markers/config/iconlookup",{stormReport:{avalanche:"stormrep_marker_avalanche",blizzard:"stormrep_marker_snow",sleet:"stormrep_marker_ice",flood:"stormrep_marker_flood",fog:"stormrep_marker_densefog",ice:"stormrep_marker_ice",hail:"stormrep_marker_hail",lightning:"stormrep_marker_lightning",rain:"stormrep_marker_rain",snow:"stormrep_marker_snow",tides:"stormrep_marker_highsurf",spout:"stormrep_marker_tornado",tornado:"stormrep_marker_tornado",wind:"stormrep_marker_highwind",winds:"stormrep_marker_highwind"},earthquake:{mini:"quake_mini",minor:"quake_minor",light:"quake_light",moderate:"quake_moderate",strong:"quake_strong",major:"quake_major",great:"quake_great",shallow:"quake_mini"}}),n("aeris/maps/markercollections/config/clusterstyles",["aeris/util","aeris/config","aeris/maps/markers/config/iconlookup"],function(t,e,i){var r={};return t.each(i,function(i,s){r[s]={},t.each(i,function(t,i){r[s][i]=[{url:e.get("assetPath")+t+".png",width:25,height:25,textColor:"#ffffff",textSize:13,anchorText:[-14,15]}]})}),t.extend(r,{defaultStyles:t.map(["green","grey","yellow"],function(t){return{url:e.get("assetPath")+"marker_"+t+".png",width:25,height:25,textColor:"#ffffff",textSize:13,anchorText:[-14,15]}})})}),n("aeris/maps/markercollections/markercollection",["aeris/util","aeris/maps/extensions/mapobjectcollection","aeris/togglecollectionbehavior","aeris/maps/extensions/strategyobject","aeris/maps/markers/marker","aeris/maps/markercollections/config/clusterstyles"],function(t,e,i,r,s,n){var o=function(o,a){var l=t.defaults(a||{},{model:s,clusterStrategy:"markers/markercluster",clusterStyles:{},clusterOptions:{},cluster:!0,strategy:null});l.clusterStyles=t.defaults(l.clusterStyles,{defaultStyles:n.defaultStyles}),this.clusterStyles_=l.clusterStyles,this.clusterStrategy_=l.clusterStrategy,this.clusterOptions_=l.clusterOptions,this.isClustering_=!1,e.call(this,o,l),i.call(this),r.call(this,{strategy:l.strategy}),l.cluster&&this.startClustering()};return t.inherits(o,e),t.extend(o.prototype,r.prototype),t.extend(o.prototype,i.prototype),o.prototype.getClusterStyle=function(t){var e=this.clusterStyles_[t]||this.clusterStyles_.defaultStyles;return e.slice(0)},o.prototype.getClusterOptions=function(){return t.clone(this.clusterOptions_)},o.prototype.startClustering=function(){var e=function(e){t.defer(function(){throw e})};t.isString(this.clusterStrategy_)?this.loadStrategy_(this.clusterStrategy_).fail(e):this.setStrategy_(this.clusterStrategy_),this.isClustering_=!0},o.prototype.stopClustering=function(){this.isClustering_&&this.removeStrategy()},t.expose(o,"aeris.maps.markercollections.MarkerCollection")}),n("aeris/maps/markercollections/pointdatamarkers",["aeris/util","aeris/maps/markercollections/markercollection"],function(t,e){var i=function(t,i){e.call(this,t,i)};return t.inherits(i,e),t.each(["getParams","setParams","setFrom","setTo","setLimit","setBounds","addFilter","removeFilter","resetFilter","addQuery","removeQuery","resetQuery","getQuery"],function(t){i.prototype[t]=function(){return this.data_[t].apply(this.data_,arguments)}}),i}),n("aeris/api/operator",["aeris/util"],function(t){var e={AND:"AND",OR:"OR"};return t.expose(e,"aeris.api.Operator")}),n("aeris/api/params/models/filter",["aeris/util","aeris/model","aeris/errors/validationerror","aeris/api/operator"],function(t,e,i,r){var s=function(i,s){var n=t.extend({operator:r.AND},i),o=t.defaults(s||{},{idAttribute:"name"});e.call(this,n,o),this.listenTo(this,"add",function(){this.isValid()})};return t.inherits(s,e),s.prototype.validate=function(t){return-1===[r.AND,r.OR].indexOf(t.operator)?new i("Operator","Must be an aeris.api.Operator."):void 0},s.prototype.isOr=function(){return this.get("operator")===r.OR},s.prototype.isAnd=function(){return this.get("operator")===r.AND},t.expose(s,"aeris.api.params.models.Filter")}),n("aeris/api/params/collections/filtercollection",["aeris/util","aeris/collection","aeris/api/params/models/filter","aeris/api/operator"],function(t,e,i,r){var s=function(r,s){var n=t.defaults(s||{},{model:i});e.call(this,r,n)};return t.inherits(s,e),s.prototype.toString=function(){var t="";return this.each(function(e,i){var r=this.operatorToString_(e.get("operator"));return 0===i?void(t+=e.get("name")):void(t+=r+e.get("name"))},this),t},s.prototype.operatorToString_=function(t){var e={};return e[r.AND]=",",e[r.OR]=";",e[t]},s.prototype.add=function(t,e){var i=e||{};i.reset=!1,this.addFiltersByName_(t,i)},s.prototype.reset=function(t,e){var i=e||{};i.reset=!0,this.addFiltersByName_(t,i)},s.prototype.addFiltersByName_=function(i,s){var n,o=[];return s=t.extend({operator:r.AND,reset:!1},s),n=s.reset?"reset":"add",t.isArray(i)||t.isUndefined(i)||(i=[i]),i&&t.isString(i[0])?(t.each(i,function(t){o.push({name:t,operator:s.operator})},this),e.prototype[n].call(this,o,s)):e.prototype[n].call(this,i)},s.prototype.remove=function(i,r){var s=[];return t.isArray(i)||(i=[i]),t.isString(i[0])?(t.each(i,function(t){var e=this.where({name:t});s=s.concat(e)},this),e.prototype.remove.call(this,s,r)):e.prototype.remove.apply(this,arguments)},s}),n("aeris/api/params/models/query",["aeris/util","aeris/model","aeris/errors/validationerror","aeris/api/operator"],function(t,e,i,r){var s=function(i,s){var n=t.defaults(s||{},{idAttribute:"property",defaults:{}});t.defaults(n.defaults,{operator:r.AND}),e.call(this,i,n),this.isValid()};return t.inherits(s,e),s.prototype.validate=function(e){var s=[r.AND,r.OR];return t.isString(e.property)?e.value?-1===t.indexOf(s,e.operator)?new i("operator",e.operator+" is not a valid query operator. Valid operators include: '"+s.join("', '")+"'."):void 0:new i("value","Value is not defined."):new i("property",e.property+" is not a valid query property")},s.prototype.toString=function(){return this.isValid(),this.get("property")+":"+this.get("value")},s}),n("aeris/api/params/collections/chainedqueries",["aeris/util","aeris/collection","aeris/api/params/models/query","aeris/api/operator"],function(t,e,i,r){var s=function(r,s){var n=t.defaults(s||{},{model:i});e.call(this,r,n)};return t.inherits(s,e),s.prototype.toString=function(){var t={};return t[r.AND]=",",t[r.OR]=";",this.reduce(function(e,i,r){var s=t[i.get("operator")];return 0!==r&&(e+=s),e+i.toString()},"",this)},s}),n("aeris/errors/unimplementedmethoderror",["aeris/errors/errortypefactory"],function(t){return new t({name:"UnimplementedMethodError"})}),n("aeris/helpers/validator/abstractvalidator",["aeris/util","aeris/errors/unimplementedmethoderror"],function(t,e){var i=function(){this.lastError_=null};return i.prototype.isValid=function(){throw new e("ValidatorInterface#isValid")},i.prototype.getLastError=function(){return this.lastError_},i.prototype.clearLastError_=function(){this.lastError_=null},i.prototype.setLastError_=function(t){this.lastError_=t},i}),n("aeris/helpers/validator/boundsvalidator",["aeris/util","aeris/helpers/validator/abstractvalidator","aeris/errors/validationerror"],function(t,e,i){var r=function(t){this.bounds_=t,e.apply(this,arguments)};return t.inherits(r,e),r.prototype.isValid=function(){function t(t){e||(e=t)}var e=null;return this.clearLastError_(),t(this.validateArea_()),this.hasCoordinates_()||t(this.createValidationError_("Invalid bounds coordinates")),this.setLastError_(e),!e},r.prototype.createValidationError_=function(t){return new i("bounds",t)},r.prototype.hasCoordinates_=function(){return t.isArray(this.getSW_())&&t.isArray(this.getNE_())},r.prototype.validateArea_=function(){var t,e=null;try{t=this.getAreaOfBounds_()}catch(i){var r="Unable to calculate bounds area: "+i.message;e=e||this.createValidationError_(r)}return(!t||0>=t)&&(e=e||this.createValidationError_("Bounds must define an area.")),e},r.prototype.getSW_=function(){return this.bounds_[0]},r.prototype.getNE_=function(){return this.bounds_[1]},r.prototype.getAreaOfBounds_=function(){var t,e,i,r;return t=this.bounds_[0],e=this.bounds_[1],i=Math.abs(e[0]-t[0]),r=Math.abs(e[1]-t[1]),r*i},r}),n("aeris/api/params/models/params",["aeris/util","aeris/config","aeris/model","aeris/api/params/collections/filtercollection","aeris/api/params/collections/chainedqueries","aeris/errors/validationerror","aeris/helpers/validator/boundsvalidator"],function(t,e,i,r,s,n,o){var a=function(n,o){var a=t.defaults(o||{},{FilterCollectionType:r,QueryType:s,validate:!0}),l=t.defaults(n||{},{p:null,filter:[],query:[],client_id:e.get("apiId"),client_secret:e.get("apiSecret")});this.QueryType_=a.QueryType,this.FilterCollectionType_=a.FilterCollectionType,l.query instanceof this.QueryType_||(l.query=new this.QueryType_(l.query)),l.filter instanceof this.FilterCollectionType_||(l.filter=new this.FilterCollectionType_(l.filter)),i.call(this,l,a),this.proxyEventsForAttr_("query"),this.proxyEventsForAttr_("filter"),this.bindToApiKeys_()};return t.inherits(a,i),a.prototype.validate=function(t){var e=this.validatePlace_(t.p);return e?e:!t.to||t.to instanceof Date?!t.from||t.from instanceof Date?!t.query||t.query instanceof this.QueryType_?void 0:new n("query",t.query+" is not a valid Query"):new n("'from' parameter must be a Date object"):new n("'to' parameter must be a Date object")},a.prototype.bindToApiKeys_=function(){this.listenTo(e,"change:apiId change:apiSecret",function(){this.set({client_id:this.get("client_id")||e.get("apiId"),client_secret:this.get("client_secret")||e.get("apiSecret")})})},a.prototype.validatePlace_=function(e){var i,r=void 0,s=t.isString(e),n=t.isNumeric(e),o=t.isArray(e)&&t.isNumeric(e[0]);return t.isNull(e)?r:s?r:n?r:o?r:(i=this.validateBounds_(e),i?i:void 0)},a.prototype.validateBounds_=function(t){var e=new o(t);return e.isValid()?void 0:e.getLastError()},a.prototype.toJSON=function(){var e=i.prototype.toJSON.apply(this,arguments);return t.each(e,function(i,r){var s=t.isArray(i)&&!i.length;return t.isNull(i)||t.isUndefined(i)||s?void delete e[r]:void(i instanceof Date&&(e[r]=Math.ceil(i.getTime()/1e3)))}),this.get("filter")&&(e.filter=this.get("filter").toString()),this.get("query")&&(e.query=this.get("query").toString()),t.isArray(this.get("p"))&&(e.p=this.get("p").join(",")),e},a.prototype.setBounds=function(e){return t.isNull(e)?void this.unset("p"):void this.set({p:e},{validate:!0})},a.prototype.addFilter=function(t,e){this.get("filter").add(t,e)},a.prototype.removeFilter=function(t,e){this.get("filter").remove(t,e)},a.prototype.resetFilter=function(t,e){this.get("filter").reset(t,e)},a.prototype.addQuery=function(t,e){this.get("query").add(t,e)},a.prototype.removeQuery=function(t,e){this.get("query").remove(t,e)},a.prototype.resetQuery=function(t,e){this.get("query").reset(t,e)},a.prototype.getQuery=function(){return this.get("query")},a.prototype.proxyEventsForAttr_=function(t){this.get(t)&&this.get(t).on&&this.listenTo(this.get(t),"add remove change reset",function(e,i){this.trigger("change:"+t,this,this.get(t),i),this.trigger("change",this,i)})},a}),n("aeris/errors/apiresponseerror",["aeris/errors/errortypefactory"],function(t){return new t({name:"APIResponseError"})}),n("aeris/api/mixins/aerisapibehavior",["aeris/util","aeris/model","aeris/promise","aeris/api/params/models/params","aeris/errors/invalidargumenterror","aeris/errors/apiresponseerror"],function(t,e,i,r,s,n){return{createParams_:function(t){return t instanceof e?t:new r(t,{validate:!0})},getParams:function(){return this.params_},setParams:function(){var t=Array.prototype.slice.call(arguments,0);t.push({validate:!0}),this.params_.set.apply(this.params_,t)},setFrom:function(t){this.setParams("from",t)},setTo:function(t){this.setParams("to",t)},setLimit:function(t){this.setParams("limit",t)},setBounds:function(t){this.params_.setBounds(t)},addFilter:function(t,e){this.params_.addFilter(t,e)},removeFilter:function(t,e){this.params_.removeFilter(t,e)},resetFilter:function(t,e){this.params_.resetFilter(t,e)},addQuery:function(t,e){this.params_.addQuery(t,e)},removeQuery:function(t,e){this.params_.removeQuery(t,e)},resetQuery:function(t,e){this.params_.resetQuery(t,e)},getQuery:function(){return this.params_.getQuery()},sync:function(e,r,n){var o,a=function(){},l=new i,p=t.defaults(n||{},{success:a,error:a,complete:a});if("read"!==e)throw new s("Unable to send a "+e+" request to the Aeris API. The Aeris API is read-only");return this.trigger("request",this,l,p),o=this.serializeParams_(this.params_),this.jsonp_.get(this.getEndpointUrl_(),o,t.bind(function(t){t.success?(l.resolve(t),this.trigger("sync",this,t,p)):l.reject(t)},this)),l.done(p.success).fail(p.error).always(p.complete).fail(this.handleRequestError_,this)},serializeParams_:function(t){return t.toJSON()},getEndpointUrl_:function(){return t.compact([this.server_,this.endpoint_,this.action_]).join("/")+"/"},getEndpoint:function(){return this.endpoint_},getAction:function(){return this.action_},handleRequestError_:function(t){var e,i=t.error;throw e=i&&i.code&&i.description?i.description+"["+i.code+"]":"Unknown error",new n("Unable to fetch data from Aeris API: "+e)},parse:function(t){return t.response?t.response:t}}}),n("aeris/api/collections/aerisapicollection",["aeris/util","aeris/collection","aeris/api/mixins/aerisapibehavior","aeris/jsonp"],function(t,e,i,r){var s=function(i,s){var n=t.extend({endpoint:"",action:"",params:{},server:"//api.aerisapi.com",jsonp:r},s);this.endpoint_=n.endpoint,this.action_=n.action,this.server_=n.server,this.params_=this.createParams_(n.params),this.jsonp_=n.jsonp,e.call(this,i,n)};return t.inherits(s,e),t.extend(s.prototype,i),t.expose(s,"aeris.api.AerisApiCollection")}),n("aeris/api/models/aerisapimodel",["aeris/util","aeris/api/mixins/aerisapibehavior","aeris/model","aeris/jsonp"],function(t,e,i,r){var s=function(e,s){var n=t.defaults(s||{},{endpoint:"",action:"",params:{},jsonp:r,server:"//api.aerisapi.com"});this.endpoint_=n.endpoint,this.action_=n.action,this.server_=n.server,this.jsonp_=n.jsonp||r,this.params_=this.createParams_(n.params),i.call(this,e,n)};return t.inherits(s,i),t.extend(s.prototype,e),s.prototype.getEndpointUrl_=function(){var t=e.getEndpointUrl_.call(this);return this.id&&(t+=this.id),t},s.prototype.testFilter=function(){return!0},s.prototype.testFilterCollection=function(e){return e.reduce(function(e,i){var r=t.isNull(e),s=this.testFilter(i.id),n=s&&e,o=s||e;return r?s:i.isAnd()?n:o},null,this)},s.prototype.parse=function(e){return e.response?t.isArray(e.response)?e.response[0]||{}:e.response:e},t.expose(s,"aeris.api.models.AerisApiModel")}),n("aeris/api/models/pointdata",["aeris/util","aeris/errors/validationerror","aeris/errors/apiresponseerror","aeris/api/models/aerisapimodel"],function(t,e,i,r){var s=function(e,i){var s=t.extend({validate:!0},i);r.call(this,e,s)};return t.inherits(s,r),s}),n("aeris/api/collections/pointdatacollection",["aeris/util","aeris/api/collections/aerisapicollection","aeris/api/models/pointdata"],function(t,e,i){var r=function(r,s){var n=t.extend({validate:!0,model:i,params:{}},s);t.defaults(n.params,{limit:100,p:":auto",radius:"3000mi"}),e.call(this,r,n)};return t.inherits(r,e),r}),n("aeris/subsetcollection",["aeris/util","aeris/collection","aeris/promise","aeris/errors/invalidargumenterror"],function(t,e,i,r){var s=function(i,r){var n=t.defaults(r||{},{limit:null,filter:s.NON_FILTER_});this.sourceCollection_=this.normalizeSourceCollection_(i),this.limit_=n.limit,this.filter_=n.filter,e.call(this,this.getFilteredSourceModels_(),n),this.bindToSourceCollection_(),this.proxyRequestEvents_()};return t.inherits(s,e),s.prototype.normalizeSourceCollection_=function(i){if(i instanceof e)return i;if(t.isArray(i))return new e(i);throw new r(i+" is not a valid source collection")},s.prototype.proxyRequestEvents_=function(){this.listenTo(this.sourceCollection_,{request:function(t,e){this.trigger("request",t,e)},sync:function(t,e){this.trigger("sync",t,e)},error:function(t,e){this.trigger("error",t,e)}})},s.prototype.bindToSourceCollection_=function(){this.listenTo(this.sourceCollection_,{"add remove reset change sort":this.syncToSourceModel_})},s.prototype.syncToSourceModel_=function(){this.set(this.getFilteredSourceModels_())},s.prototype.getFilteredSourceModels_=function(){var e=this.sourceCollection_.filter(this.filter_),i=t.isNull(this.limit_)?e.length:this.limit_;return e.slice(0,i)},s.prototype.getSourceCollection=function(){return this.sourceCollection_},s.prototype.setFilter=function(e,i){this.filter_=e,i&&(this.filter_=t.bind(this.filter_,i)),this.syncToSourceModel_()},s.prototype.removeFilter=function(){this.filter_=s.NON_FILTER_,this.syncToSourceModel_()},s.prototype.setLimit=function(t){this.limit_=t,this.syncToSourceModel_()},s.prototype.removeLimit=function(){this.limit_=null,this.syncToSourceModel_()},s.prototype.isUnderLimit=function(){return t.isNull(this.limit_)||this.length<this.limit_},s.prototype.fetch=function(t){return this.sourceCollection_.fetch(t)},s.NON_FILTER_=t.constant(!0),s}),n("aeris/api/collections/aerisapiclientcollection",["aeris/util","aeris/subsetcollection","aeris/api/collections/aerisapicollection"],function(t,e,i){var r=function(r,s){var n=t.defaults(s||{},{SourceCollectionType:i,clientLimit:null,clientFilter:t.constant(!0)}),o=t.pick(n,["params","endpoint","action","model","server","SourceCollectionType"]),a=this.createSourceCollection_(r,o),l={limit:n.clientLimit,filter:n.clientFilter};e.call(this,a,l),this.bindClientFilters_(),this.updateClientFilters_()};t.inherits(r,e),r.prototype.createSourceCollection_=function(e,i){return new i.SourceCollectionType(e,t.pick(i||{},["params","endpoint","action","model","server"]))},r.prototype.bindClientFilters_=function(){this.listenTo(this.getApiFilters_(),{"add remove reset change":this.updateClientFilters_})},r.prototype.updateClientFilters_=function(){this.getApiFilters_().length?this.applyClientFilters_(this.getApiFilters_()):this.removeClientFilter()},r.prototype.applyClientFilters_=function(t){this.setClientFilter(function(e){return e.testFilterCollection(t)},this)},r.prototype.getApiFilters_=function(){return this.sourceCollection_.getParams().get("filter")},r.prototype.setClientFilter=function(t,i){e.prototype.setFilter.call(this,t,i)},r.prototype.removeClientFilter=function(){e.prototype.removeFilter.call(this)},r.prototype.setClientLimit=function(t){e.prototype.setLimit.call(this,t)},r.prototype.removeClientLimit=function(){e.prototype.removeLimit.call(this)};var s=["getParams","setParams","setFrom","setTo","setBounds","addFilter","removeFilter","resetFilter","addQuery","removeQuery","resetQuery","getQuery"];return t.each(s,function(t){r.prototype[t]=function(){return this.sourceCollection_[t].apply(this.sourceCollection_,arguments)}},this),r}),n("aeris/api/models/earthquake",["aeris/util","aeris/api/models/pointdata","aeris/errors/apiresponseerror"],function(t,e,i){var r=function(t,i){e.call(this,t,i)};return t.inherits(r,e),r.prototype.parse=function(t){var r=e.prototype.parse.apply(this,arguments);if(!t.report||!t.report.id)throw new i("Missing earthquake id");return r.id=t.report.id,r},r.prototype.testFilter=function(t){return"shallow"===t?this.isShallow():t===this.getAtPath("report.type")},r.prototype.isShallow=function(){return this.getAtPath("report.depthKM")<70},t.expose(r,"aeris.api.models.Earthquake")}),n("aeris/datehelper",["aeris/util"],function(t){var e=1,i=1e3*e,r=60*i,s=60*r,n=24*s,o=7*n,a=function(t){this.date_=t||new Date};return a.prototype.addMilliseconds=function(t){return this.date_.setTime(this.date_.getTime()+t),this.date_},a.prototype.addSeconds=function(t){return this.addMilliseconds(t*i)},a.prototype.addMinutes=function(t){return this.addMilliseconds(t*r)},a.prototype.addHours=function(t){return this.addMilliseconds(t*s)},a.prototype.addDays=function(t){return this.addMilliseconds(t*n)},a.prototype.addWeeks=function(t){return this.addMilliseconds(t*o)},a.prototype.getDate=function(){return this.date_},a.prototype.setDate=function(t){this.date_=t||new Date},t.expose(a,"aeris.DateHelper")}),n("aeris/api/collections/earthquakes",["aeris/util","aeris/api/collections/pointdatacollection","aeris/api/collections/aerisapiclientcollection","aeris/api/models/earthquake","aeris/datehelper"],function(t,e,i,r,s){var n=function(n,o){var a=t.defaults(o||{},{params:{},model:r,endpoint:"earthquakes",action:"within",SourceCollectionType:e});t.defaults(a.params,{from:(new s).addWeeks(-7),to:new Date,radius:"3000miles"}),i.call(this,n,a)};return t.inherits(n,i),t.expose(n,"aeris.api.collections.Earthquakes")}),n("aeris/maps/markers/pointdatamarker",["aeris/util","aeris/maps/markers/marker","aeris/config"],function(t,e,i){var r=function(r,s){var n=t.defaults(s||{},{iconPath:i.get("assetPath")+"{name}.png",iconLookup:{},typeAttribute:""});n.attributeTransforms=t.defaults(n.attributeTransforms||{},{url:this.lookupUrl_,selectedUrl:this.lookupSelectedUrl_,title:this.lookupTitle_,position:this.lookupPosition_,type:this.lookupType_}),this.iconPath_=n.iconPath,this.selectedIconPath_=n.selectedIconPath||n.iconPath,this.iconLookup_=n.iconLookup,this.typeAttribute_=n.typeAttribute,e.call(this,r,n)};return t.inherits(r,e),r.prototype.getType=function(){return this.get("type")},r.prototype.lookupType_=function(){var e,i=this.getDataAttribute(this.typeAttribute_);return t.isArray(i)?(t.each(i,function(i){t.has(this.iconLookup_,i)&&(e=i)},this),e||this.get("type")):i||this.get("type")},r.prototype.lookupUrl_=function(){var t=this.getIconNameForType_();return t?this.iconPath_.replace(/\{name\}/,t):this.get("url")},r.prototype.lookupSelectedUrl_=function(){var t=this.getIconNameForType_();return t?this.selectedIconPath_.replace(/\{name\}/,t):this.get("selectedUrl")},r.prototype.getIconNameForType_=function(){var t=this.getType()||this.lookupType_();return this.lookupTypeIcon_(t)},r.prototype.lookupTypeIcon_=function(t){return this.iconLookup_[t]},r.prototype.lookupTitle_=function(){return""},r.prototype.lookupPosition_=function(){var t=this.getDataAttribute("loc");return t?[t.lat,t.long]:this.get("position")},r}),n("aeris/maps/markers/earthquakemarker",["aeris/util","aeris/config","aeris/maps/markers/pointdatamarker","aeris/maps/markers/config/iconlookup"],function(t,e,i,r){var s=function(s,n){var o=t.extend({url:e.get("assetPath")+"quake_minor.png"},s),a=t.extend({iconLookup:r.earthquake,typeAttribute:"report.type"},n);i.call(this,o,a)};return t.inherits(s,i),s.prototype.lookupTitle_=function(){var e=this.getDataAttribute("report.mag").toFixed(1);return t.isUndefined(e)?"Earthquake":"Magnitute "+e+" Earthquake."},t.expose(s,"aeris.maps.markers.EarthquakeMarker")}),n("aeris/maps/markercollections/earthquakemarkers",["aeris/util","aeris/maps/markercollections/pointdatamarkers","aeris/api/collections/earthquakes","aeris/maps/markers/earthquakemarker","aeris/maps/markercollections/config/clusterstyles"],function(t,e,i,r,s){var n=function(n,o){var a=t.extend({data:new i,model:r,clusterStyles:s.earthquake},o);e.call(this,n,a)};return t.inherits(n,e),t.expose(n,"aeris.maps.markercollections.EarthquakeMarkers")}),n("aeris/maps/markers/firemarker",["aeris/util","aeris/config","aeris/maps/markers/pointdatamarker"],function(t,e,i){var r=function(r,s){var n=t.extend({url:e.get("assetPath")+"map_fire_marker.png"},r);i.call(this,n,s)};return t.inherits(r,i),r.prototype.lookupTitle_=function(){var t=this.getDataAttribute("report.cause");return t?"Fire caused by "+t:"Fire"},t.expose(r,"aeris.maps.markers.FireMarker")}),n("aeris/api/models/fire",["aeris/util","aeris/api/models/pointdata"],function(t,e){var i=function(t,i){e.call(this,t,i)};return t.inherits(i,e),i.prototype.parse=function(t){var i=e.prototype.parse.apply(this,arguments);if(!t.report||!t.report.id)throw new ApiResponseError("Missing earthquake id");return i.id=t.report.id,i},t.expose(i,"aeris.api.models.Fire")}),n("aeris/api/collections/fires",["aeris/util","aeris/api/collections/pointdatacollection","aeris/api/collections/aerisapiclientcollection","aeris/api/models/fire"],function(t,e,i,r){var s=function(s,n){var o=t.defaults(n||{},{params:{limit:500,query:[{property:"type",value:"L"}]},model:r,endpoint:"fires",action:"search",SourceCollectionType:e});i.call(this,s,o)};return t.inherits(s,i),t.expose(s,"aeris.api.collections.Fires")}),n("aeris/maps/markercollections/firemarkers",["aeris/util","aeris/maps/markercollections/pointdatamarkers","aeris/maps/markers/firemarker","aeris/api/collections/fires"],function(t,e,i,r){var s=function(s,n){var o=t.extend({model:i,data:new r},n);
e.call(this,s,o)};return t.inherits(s,e),t.expose(s,"aeris.maps.markercollections.FireMarkers")}),n("aeris/api/models/lightning",["aeris/util","aeris/api/models/pointdata"],function(t,e){var i=function(t,i){e.call(this,t,i)};return t.inherits(i,e),t.expose(i,"aeris.api.models.Lightning")}),n("aeris/api/collections/lightning",["aeris/util","aeris/api/collections/pointdatacollection","aeris/api/collections/aerisapiclientcollection","aeris/api/models/lightning"],function(t,e,i,r){var r=function(s,n){var o=t.defaults(n||{},{params:{limit:200},model:r,endpoint:"lightning",action:"within",SourceCollectionType:e});i.call(this,s,o)};return t.inherits(r,i),t.expose(r,"aeris.api.collections.Lightning")}),n("aeris/maps/markers/lightningmarker",["aeris/util","aeris/config","aeris/maps/markers/pointdatamarker"],function(t,e,i){var r=function(r,s){var n=t.extend({url:e.get("assetPath")+"lightning_white.png"},r);i.call(this,n,s)};return t.inherits(r,i),r.prototype.lookupTitle_=function(){return"Lightning"},t.expose(r,"aeris.maps.markers.LightningMarker")}),n("aeris/maps/markercollections/lightningmarkers",["aeris/util","aeris/maps/markercollections/pointdatamarkers","aeris/api/collections/lightning","aeris/maps/markers/lightningmarker"],function(t,e,i,r){var s=function(s,n){var o=t.extend({data:new i,model:r},n);e.call(this,s,o)};return t.inherits(s,e),t.expose(s,"aeris.maps.markercollections.LightningMarkers")}),n("aeris/api/models/stormreport",["aeris/util","aeris/api/models/pointdata"],function(t,e){var i=function(t,i){e.call(this,t,i),this.listenTo(this,{"change:report":function(){var t=res.report.type.split(" ");this.set("stormtypes",t)}})};return t.inherits(i,e),i.prototype.parse=function(t){var i=e.prototype.parse.apply(this,arguments);return i.id=t.id,i.stormtypes=t.report.type.split(" "),i},i.prototype.testFilter=function(e){return t.contains(this.get("stormtypes"),e)},t.expose(i,"aeris.api.models.StormReport")}),n("aeris/api/collections/stormreports",["aeris/util","aeris/api/collections/pointdatacollection","aeris/api/collections/aerisapiclientcollection","aeris/api/models/stormreport","aeris/datehelper"],function(t,e,i,r,s){var n=function(n,o){var a=t.defaults(o||{},{params:{from:(new s).addDays(-2),to:new Date,limit:100},endpoint:"stormreports",action:"within",model:r,SourceCollectionType:e});i.call(this,n,a)};return t.inherits(n,i),t.expose(n,"aeris.api.collections.StormReports")}),n("aeris/maps/markers/stormreportmarker",["aeris/util","aeris/config","aeris/maps/markers/pointdatamarker","aeris/maps/markers/config/iconlookup"],function(t,e,i,r){var s=function(s,n){var o=t.extend({url:e.get("assetPath")+"marker_yellow.png"},s),a=t.extend({iconLookup:r.stormReport,typeAttribute:"stormtypes"},n);i.call(this,o,a)};return t.inherits(s,i),s.prototype.lookupTitle_=function(){var t=this.getDataAttribute("report.type"),e=this.getDataAttribute("report.name");return t=t.charAt(0).toUpperCase()+t.slice(1),t&&e?t+": "+e:"Storm report"},t.expose(s,"aeris.maps.markers.StormReportMarker")}),n("aeris/maps/markercollections/stormreportmarkers",["aeris/util","aeris/maps/markercollections/pointdatamarkers","aeris/api/collections/stormreports","aeris/maps/markers/stormreportmarker","aeris/maps/markercollections/config/clusterstyles"],function(t,e,i,r,s){var n=function(n,o){var a=t.extend({data:new i,model:r,clusterStyles:s.stormReport},o);e.call(this,n,a)};return t.inherits(n,e),t.expose(n,"aeris.maps.markercollections.StormReportMarkers")}),n("aeris/packages/markers",["aeris/maps/markers/marker","aeris/maps/markercollections/earthquakemarkers","aeris/maps/markercollections/firemarkers","aeris/maps/markercollections/lightningmarkers","aeris/maps/markercollections/stormreportmarkers"],function(){}),n("aeris/packages/maps",["aeris/maps/map","aeris/packages/animations","aeris/packages/infobox","aeris/packages/layers","aeris/packages/markers"],function(){}),n("aeris/maps/strategy/infobox",["aeris/util","aeris/util/gmaps","aeris/maps/strategy/abstractstrategy","googlemaps!"],function(t,e,i,r){var s=function(t){this.infoBox_=t,i.apply(this,arguments),this.listenTo(this.infoBox_,{"change:position":this.setPosition,"change:content":this.setContent_})};return t.inherits(s,i),s.prototype.createView_=function(){return new r.InfoWindow(this.getOptions_())},s.prototype.getOptions_=function(){return{content:this.infoBox_.get("content"),position:e.arrayToLatLng(this.infoBox_.get("position"))}},s.prototype.setMap=function(){i.prototype.setMap.apply(this,arguments),this.getView().open(this.mapView_),this.proxyViewEvents_()},s.prototype.setPosition=function(){var t=e.arrayToLatLng(this.infoBox_.get("position"));this.getView().setPosition(t)},s.prototype.setContent_=function(){var t=this.infoBox_.get("content");this.getView().setContent(t)},s.prototype.beforeRemove_=function(){this.getView().close(),this.infoBox_.trigger("close"),this.googleEvents_.stopListening(this.getView())},s.prototype.proxyViewEvents_=function(){var e={closeclick:"close"};t.each(e,function(t,e){this.googleEvents_.listenTo(this.getView(),e,function(){this.infoBox_.trigger(t)},this)},this)},s}),t.prototype.onAdd=function(){var t,e,i=this;this.div_=document.createElement("div"),this.div_.className=this.className_,this.visible_&&this.show(),this.getPanes().overlayMouseTarget.appendChild(this.div_),this.boundsChangedListener_=google.maps.event.addListener(this.getMap(),"bounds_changed",function(){e=t}),google.maps.event.addDomListener(this.div_,"mousedown",function(){t=!0,e=!1}),google.maps.event.addDomListener(this.div_,"click",function(r){if(t=!1,!e){var s,n,o=i.cluster_.getMarkerClusterer();google.maps.event.trigger(o,"click",i.cluster_),google.maps.event.trigger(o,"clusterclick",i.cluster_),o.getZoomOnClick()&&(n=o.getMaxZoom(),s=i.cluster_.getBounds(),o.getMap().fitBounds(s),setTimeout(function(){o.getMap().fitBounds(s),null!==n&&o.getMap().getZoom()>n&&o.getMap().setZoom(n+1)},100)),r.cancelBubble=!0,r.stopPropagation&&r.stopPropagation()}}),google.maps.event.addDomListener(this.div_,"mouseover",function(){var t=i.cluster_.getMarkerClusterer();google.maps.event.trigger(t,"mouseover",i.cluster_)}),google.maps.event.addDomListener(this.div_,"mouseout",function(){var t=i.cluster_.getMarkerClusterer();google.maps.event.trigger(t,"mouseout",i.cluster_)})},t.prototype.onRemove=function(){this.div_&&this.div_.parentNode&&(this.hide(),google.maps.event.removeListener(this.boundsChangedListener_),google.maps.event.clearInstanceListeners(this.div_),this.div_.parentNode.removeChild(this.div_),this.div_=null)},t.prototype.draw=function(){if(this.visible_){var t=this.getPosFromLatLng_(this.center_);this.div_.style.top=t.y+"px",this.div_.style.left=t.x+"px"}},t.prototype.hide=function(){this.div_&&(this.div_.style.display="none"),this.visible_=!1},t.prototype.show=function(){if(this.div_){var t="",e=this.backgroundPosition_.split(" "),i=parseInt(e[0].trim(),10),r=parseInt(e[1].trim(),10),s=this.getPosFromLatLng_(this.center_);this.div_.style.cssText=this.createCss(s),t="<img src='"+this.url_+"' style='position: absolute; top: "+r+"px; left: "+i+"px; ",this.cluster_.getMarkerClusterer().enableRetinaIcons_||(t+="clip: rect("+-1*r+"px, "+(-1*i+this.width_)+"px, "+(-1*r+this.height_)+"px, "+-1*i+"px);"),t+="'>",this.div_.innerHTML=t+"<div style='position: absolute;top: "+this.anchorText_[0]+"px;left: "+this.anchorText_[1]+"px;color: "+this.textColor_+";font-size: "+this.textSize_+"px;font-family: "+this.fontFamily_+";font-weight: "+this.fontWeight_+";font-style: "+this.fontStyle_+";text-decoration: "+this.textDecoration_+";text-align: center;width: "+this.width_+"px;line-height:"+this.height_+"px;'>"+this.sums_.text+"</div>",this.div_.title="undefined"==typeof this.sums_.title||""===this.sums_.title?this.cluster_.getMarkerClusterer().getTitle():this.sums_.title,this.div_.style.display=""}this.visible_=!0},t.prototype.useStyle=function(t){this.sums_=t;var e=Math.max(0,t.index-1);e=Math.min(this.styles_.length-1,e);var i=this.styles_[e];this.url_=i.url,this.height_=i.height,this.width_=i.width,this.anchorText_=i.anchorText||[0,0],this.anchorIcon_=i.anchorIcon||[parseInt(this.height_/2,10),parseInt(this.width_/2,10)],this.textColor_=i.textColor||"black",this.textSize_=i.textSize||11,this.textDecoration_=i.textDecoration||"none",this.fontWeight_=i.fontWeight||"bold",this.fontStyle_=i.fontStyle||"normal",this.fontFamily_=i.fontFamily||"Arial,sans-serif",this.backgroundPosition_=i.backgroundPosition||"0 0"},t.prototype.setCenter=function(t){this.center_=t},t.prototype.createCss=function(t){var e=[];return e.push("cursor: pointer;"),e.push("position: absolute; top: "+t.y+"px; left: "+t.x+"px;"),e.push("width: "+this.width_+"px; height: "+this.height_+"px;"),e.join("")},t.prototype.getPosFromLatLng_=function(t){var e=this.getProjection().fromLatLngToDivPixel(t);return e.x-=this.anchorIcon_[1],e.y-=this.anchorIcon_[0],e.x=parseInt(e.x,10),e.y=parseInt(e.y,10),e},e.prototype.getSize=function(){return this.markers_.length},e.prototype.getMarkers=function(){return this.markers_},e.prototype.getCenter=function(){return this.center_},e.prototype.getMap=function(){return this.map_},e.prototype.getMarkerClusterer=function(){return this.markerClusterer_},e.prototype.getBounds=function(){var t,e=new google.maps.LatLngBounds(this.center_,this.center_),i=this.getMarkers();for(t=0;t<i.length;t++)e.extend(i[t].getPosition());return e},e.prototype.remove=function(){this.clusterIcon_.setMap(null),this.markers_=[],delete this.markers_},e.prototype.addMarker=function(t){var e,i,r;if(this.isMarkerAlreadyAdded_(t))return!1;if(this.center_){if(this.averageCenter_){var s=this.markers_.length+1,n=(this.center_.lat()*(s-1)+t.getPosition().lat())/s,o=(this.center_.lng()*(s-1)+t.getPosition().lng())/s;this.center_=new google.maps.LatLng(n,o),this.calculateBounds_()}}else this.center_=t.getPosition(),this.calculateBounds_();if(t.isAdded=!0,this.markers_.push(t),i=this.markers_.length,r=this.markerClusterer_.getMaxZoom(),null!==r&&this.map_.getZoom()>r)t.getMap()!==this.map_&&t.setMap(this.map_);else if(i<this.minClusterSize_)t.getMap()!==this.map_&&t.setMap(this.map_);else if(i===this.minClusterSize_)for(e=0;i>e;e++)this.markers_[e].setMap(null);else t.setMap(null);return this.updateIcon_(),!0},e.prototype.isMarkerInClusterBounds=function(t){return this.bounds_.contains(t.getPosition())},e.prototype.calculateBounds_=function(){var t=new google.maps.LatLngBounds(this.center_,this.center_);this.bounds_=this.markerClusterer_.getExtendedBounds(t)},e.prototype.updateIcon_=function(){var t=this.markers_.length,e=this.markerClusterer_.getMaxZoom();if(null!==e&&this.map_.getZoom()>e)return void this.clusterIcon_.hide();if(t<this.minClusterSize_)return void this.clusterIcon_.hide();var i=this.markerClusterer_.getStyles().length,r=this.markerClusterer_.getCalculator()(this.markers_,i);this.clusterIcon_.setCenter(this.center_),this.clusterIcon_.useStyle(r),this.clusterIcon_.show()},e.prototype.isMarkerAlreadyAdded_=function(t){var e;if(this.markers_.indexOf)return-1!==this.markers_.indexOf(t);for(e=0;e<this.markers_.length;e++)if(t===this.markers_[e])return!0;return!1},i.prototype.onAdd=function(){var t=this;this.activeMap_=this.getMap(),this.ready_=!0,this.repaint(),this.listeners_=[google.maps.event.addListener(this.getMap(),"zoom_changed",function(){t.resetViewport_(!1),(this.getZoom()===(this.get("minZoom")||0)||this.getZoom()===this.get("maxZoom"))&&google.maps.event.trigger(this,"idle")}),google.maps.event.addListener(this.getMap(),"idle",function(){t.redraw_()})]},i.prototype.onRemove=function(){var t;for(t=0;t<this.markers_.length;t++)this.markers_[t].getMap()!==this.activeMap_&&this.markers_[t].setMap(this.activeMap_);for(t=0;t<this.clusters_.length;t++)this.clusters_[t].remove();for(this.clusters_=[],t=0;t<this.listeners_.length;t++)google.maps.event.removeListener(this.listeners_[t]);this.listeners_=[],this.activeMap_=null,this.ready_=!1},i.prototype.draw=function(){},i.prototype.setupStyles_=function(){var t,e;if(!(this.styles_.length>0))for(t=0;t<this.imageSizes_.length;t++)e=this.imageSizes_[t],this.styles_.push({url:this.imagePath_+(t+1)+"."+this.imageExtension_,height:e,width:e})},i.prototype.fitMapToMarkers=function(){var t,e=this.getMarkers(),i=new google.maps.LatLngBounds;for(t=0;t<e.length;t++)i.extend(e[t].getPosition());this.getMap().fitBounds(i)},i.prototype.getGridSize=function(){return this.gridSize_},i.prototype.setGridSize=function(t){this.gridSize_=t},i.prototype.getMinimumClusterSize=function(){return this.minClusterSize_},i.prototype.setMinimumClusterSize=function(t){this.minClusterSize_=t},i.prototype.getMaxZoom=function(){return this.maxZoom_},i.prototype.setMaxZoom=function(t){this.maxZoom_=t},i.prototype.getStyles=function(){return this.styles_},i.prototype.setStyles=function(t){this.styles_=t},i.prototype.getTitle=function(){return this.title_},i.prototype.setTitle=function(t){this.title_=t},i.prototype.getZoomOnClick=function(){return this.zoomOnClick_},i.prototype.setZoomOnClick=function(t){this.zoomOnClick_=t},i.prototype.getAverageCenter=function(){return this.averageCenter_},i.prototype.setAverageCenter=function(t){this.averageCenter_=t},i.prototype.getIgnoreHidden=function(){return this.ignoreHidden_},i.prototype.setIgnoreHidden=function(t){this.ignoreHidden_=t},i.prototype.getEnableRetinaIcons=function(){return this.enableRetinaIcons_},i.prototype.setEnableRetinaIcons=function(t){this.enableRetinaIcons_=t},i.prototype.getImageExtension=function(){return this.imageExtension_},i.prototype.setImageExtension=function(t){this.imageExtension_=t},i.prototype.getImagePath=function(){return this.imagePath_},i.prototype.setImagePath=function(t){this.imagePath_=t},i.prototype.getImageSizes=function(){return this.imageSizes_},i.prototype.setImageSizes=function(t){this.imageSizes_=t},i.prototype.getCalculator=function(){return this.calculator_},i.prototype.setCalculator=function(t){this.calculator_=t},i.prototype.getBatchSizeIE=function(){return this.batchSizeIE_},i.prototype.setBatchSizeIE=function(t){this.batchSizeIE_=t},i.prototype.getClusterClass=function(){return this.clusterClass_},i.prototype.setClusterClass=function(t){this.clusterClass_=t},i.prototype.getMarkers=function(){return this.markers_},i.prototype.getTotalMarkers=function(){return this.markers_.length},i.prototype.getClusters=function(){return this.clusters_},i.prototype.getTotalClusters=function(){return this.clusters_.length},i.prototype.addMarker=function(t,e){this.pushMarkerTo_(t),e||this.redraw_()},i.prototype.addMarkers=function(t,e){var i;for(i in t)t.hasOwnProperty(i)&&this.pushMarkerTo_(t[i]);e||this.redraw_()},i.prototype.pushMarkerTo_=function(t){if(t.getDraggable()){var e=this;google.maps.event.addListener(t,"dragend",function(){e.ready_&&(this.isAdded=!1,e.repaint())})}t.isAdded=!1,this.markers_.push(t)},i.prototype.removeMarker=function(t,e){var i=this.removeMarker_(t);return!e&&i&&this.repaint(),i},i.prototype.removeMarkers=function(t,e){var i,r,s=!1;for(i=0;i<t.length;i++)r=this.removeMarker_(t[i]),s=s||r;return!e&&s&&this.repaint(),s},i.prototype.removeMarker_=function(t){var e,i=-1;if(this.markers_.indexOf)i=this.markers_.indexOf(t);else for(e=0;e<this.markers_.length;e++)if(t===this.markers_[e]){i=e;break}return-1===i?!1:(t.setMap(null),this.markers_.splice(i,1),!0)},i.prototype.clearMarkers=function(){this.resetViewport_(!0),this.markers_=[]},i.prototype.repaint=function(){var t=this.clusters_.slice();this.clusters_=[],this.resetViewport_(!1),this.redraw_(),setTimeout(function(){var e;for(e=0;e<t.length;e++)t[e].remove()},0)},i.prototype.getExtendedBounds=function(t){var e=this.getProjection(),i=new google.maps.LatLng(t.getNorthEast().lat(),t.getNorthEast().lng()),r=new google.maps.LatLng(t.getSouthWest().lat(),t.getSouthWest().lng()),s=e.fromLatLngToDivPixel(i);s.x+=this.gridSize_,s.y-=this.gridSize_;var n=e.fromLatLngToDivPixel(r);n.x-=this.gridSize_,n.y+=this.gridSize_;var o=e.fromDivPixelToLatLng(s),a=e.fromDivPixelToLatLng(n);return t.extend(o),t.extend(a),t},i.prototype.redraw_=function(){this.createClusters_(0)},i.prototype.resetViewport_=function(t){var e,i;for(e=0;e<this.clusters_.length;e++)this.clusters_[e].remove();for(this.clusters_=[],e=0;e<this.markers_.length;e++)i=this.markers_[e],i.isAdded=!1,t&&i.setMap(null)},i.prototype.distanceBetweenPoints_=function(t,e){var i=6371,r=(e.lat()-t.lat())*Math.PI/180,s=(e.lng()-t.lng())*Math.PI/180,n=Math.sin(r/2)*Math.sin(r/2)+Math.cos(t.lat()*Math.PI/180)*Math.cos(e.lat()*Math.PI/180)*Math.sin(s/2)*Math.sin(s/2),o=2*Math.atan2(Math.sqrt(n),Math.sqrt(1-n)),a=i*o;return a},i.prototype.isMarkerInBounds_=function(t,e){return e.contains(t.getPosition())},i.prototype.addToClosestCluster_=function(t){var i,r,s,n,o=4e4,a=null;for(i=0;i<this.clusters_.length;i++)s=this.clusters_[i],n=s.getCenter(),n&&(r=this.distanceBetweenPoints_(n,t.getPosition()),o>r&&(o=r,a=s));a&&a.isMarkerInClusterBounds(t)?a.addMarker(t):(s=new e(this),s.addMarker(t),this.clusters_.push(s))},i.prototype.createClusters_=function(t){var e,i,r,s=this;if(this.ready_){0===t&&(google.maps.event.trigger(this,"clusteringbegin",this),"undefined"!=typeof this.timerRefStatic&&(clearTimeout(this.timerRefStatic),delete this.timerRefStatic)),r=this.getMap().getZoom()>3?new google.maps.LatLngBounds(this.getMap().getBounds().getSouthWest(),this.getMap().getBounds().getNorthEast()):new google.maps.LatLngBounds(new google.maps.LatLng(85.02070771743472,-178.48388434375),new google.maps.LatLng(-85.08136444384544,178.00048865625));var n=this.getExtendedBounds(r),o=Math.min(t+this.batchSize_,this.markers_.length);for(e=t;o>e;e++)i=this.markers_[e],!i.isAdded&&this.isMarkerInBounds_(i,n)&&(!this.ignoreHidden_||this.ignoreHidden_&&i.getVisible())&&this.addToClosestCluster_(i);o<this.markers_.length?this.timerRefStatic=setTimeout(function(){s.createClusters_(o)},0):(delete this.timerRefStatic,google.maps.event.trigger(this,"clusteringend",this))}},i.prototype.extend=function(t,e){return function(t){var e;for(e in t.prototype)this.prototype[e]=t.prototype[e];return this}.apply(t,[e])},i.CALCULATOR=function(t,e){for(var i=0,r="",s=t.length.toString(),n=s;0!==n;)n=parseInt(n/10,10),i++;return i=Math.min(i,e),{text:s,index:i,title:r}},i.BATCH_SIZE=2e3,i.BATCH_SIZE_IE=500,i.IMAGE_PATH="http://google-maps-utility-library-v3.googlecode.com/svn/trunk/markerclustererplus/images/m",i.IMAGE_EXTENSION="png",i.IMAGE_SIZES=[53,56,66,78,90],n("gmaps-markerclusterer-plus",function(t){return function(){var e,r;return r=function(){return i},e=r.apply(t,arguments),e||t.MarkerClusterer}}(this)),n("aeris/maps/strategy/markers/markercluster",["aeris/util","aeris/maps/strategy/abstractstrategy","gmaps-markerclusterer-plus","aeris/util/gmaps"],function(t,e,i,r){var s=function(r,s){var n=t.defaults(s||{},{MarkerClusterer:i});this.MarkerClusterer_=n.MarkerClusterer,e.apply(this,arguments),this.bindToMarkerCollection_(),this.listenTo(this,{"clusterer:add":this.proxyClustererEvents_,"clusterer:remove":function(t){this.googleEvents_.stopListening(t)}})};return t.inherits(s,e),s.prototype.bindToMarkerCollection_=function(){var e=t.debounce(function(){this.resetClusters()},500),i=t.debounce(function(){this.repaint()},500);this.listenTo(this.object_,{add:function(t){this.addMarker(t)},remove:e,reset:e,change:i})},s.prototype.createView_=function(){return this.view_={},this.addMarkers(this.object_.models),this.view_},s.prototype.setMap=function(){e.prototype.setMap.apply(this,arguments),t.invoke(this.getView(),"setMap",this.mapView_)},s.prototype.beforeRemove_=function(){t.invoke(this.getView(),"setMap",null),t.defer(function(){this.object_.getMap()||t.invoke(this.getAllMarkers_(),"setMap",null)}.bind(this))},s.prototype.destroy=function(){e.prototype.destroy.apply(this,arguments),this.clearClusters()},s.prototype.addMarkers=function(e){t.each(e,function(t){this.addMarker(t)},this)},s.prototype.addMarker=function(e){var i=this.getMarkerGroup_(e);this.getClusterer(i)||this.addClusterer_(this.createClusterer_(i),i),e.requestView().done(function(t){this.getClusterer(i).addMarker(t)},this).fail(t.throwUncatchable)},s.prototype.removeMarker=function(e){var i=this.getMarkerGroup_(e),r=this.getClusterer(i);r&&e.requestView().done(function(t){r.removeMarker(t)},this).fail(t.throwUncatchable)},s.prototype.removeMarkers=function(e){t.each(e,function(t){this.removeMarker(t)},this)},s.prototype.clearClusters=function(){var e=this.getView();t.each(e,function(t,i){t.clearMarkers(),t.setMap(null),delete e[i],this.trigger("clusterer:remove",t,i)},this)},s.prototype.resetClusters=function(){this.clearClusters(),this.addMarkers(this.object_.models)},s.prototype.repaint=function(){t(this.getView()).invoke("repaint")},s.prototype.getMarkerGroup_=function(t){return t.getType()||s.SINGLE_CLUSTER_GROUPNAME},s.prototype.createClusterer_=function(e){var i,r=t.defaults({},this.object_.getClusterOptions(),{clusterClass:"aeris-cluster",styles:this.object_.getClusterStyle(e),averageCenter:!0,zoomOnClick:!0,gridSize:60,maxZoom:9,minimumClusterSize:3});return i=new this.MarkerClusterer_(this.mapView_,[],r),this.trigger("clusterer:create",i),i},s.prototype.addClusterer_=function(t,e){this.view_[e]=t,this.trigger("clusterer:add",t,e)},s.prototype.getClusterer=function(t){return this.getView()[t]},s.prototype.proxyClustererEvents_=function(e){var i=t.bind(function(t,e){var i=r.latLngToArray(e.getCenter());this.object_.trigger("cluster:"+t,i)},this);this.googleEvents_.listenTo(e,{click:function(t){i("click",t)},mouseout:function(t){i("mouseout",t)},mouseover:function(t){i("mouseover",t)}})},s.prototype.getAllMarkers_=function(){return t.reduce(this.getView(),function(t,e){return t.concat(e.getMarkers())},[],this)},s.SINGLE_CLUSTER_GROUPNAME="MARKERCLUSTERSTRATEGY_SINGLE_CLUSTER",s}),n("aeris/maps/strategy/layers/aeristile",["aeris/util","aeris/maps/strategy/layers/tile"],function(t,e){var i=function(){this.isBaseLayer_=!1,e.apply(this,arguments),this.listenTo(this.object_,{"change:time":this.recreateView_})};return t.inherits(i,e),i.prototype.recreateView_=function(){this.view_=this.createView_(),this.remove(),this.setMap(this.object_.get("map"))},i.prototype.getUrl_=function(){var t=e.prototype.getUrl_.apply(this,arguments);return t?t.replace(/\{t\}/,this.object_.getAerisTimeString()):null},i}),n("aeris/maps/strategy/layers/googlemaptype",["aeris/util","aeris/errors/invalidargumenterror","aeris/maps/strategy/layers/abstractmaptype","googlemaps!"],function(t,e,i,r){var s=function(t){this.mapTypeId_=r.MapTypeId[t.get("mapTypeId")],this.isBaseLayer_=!0,i.call(this,t)};return t.inherits(s,i),s.prototype.createView_=function(){},s.prototype.getView=function(){var t;if(this.mapView_&&(t=this.mapView_.mapTypes.get(this.mapTypeId_)),!t)throw new Error("Unable to return MapType view. Basic Google MapTypes must be set to a mapbefore they can provide a view");return t},s.prototype.setMap=function(r,s){var n=t.extend({baseLayer:this.isBaseLayer_},s);if(!n.baseLayer)throw new e("Basic Google MapTypes cannot be set as overlay map types");i.prototype.setMap.apply(this,arguments)},s.prototype.registerMapType_=function(){},s}),n("aeris/maps/strategy/polylines/polyline",["aeris/util","aeris/maps/strategy/abstractstrategy","aeris/util/gmaps","googlemaps!"],function(t,e,i,r){var s=function(){e.apply(this,arguments),this.bindViewEvents_(),this.listenTo(this.object_,{"change:path":this.updatePath,"change:strokeColor":this.updateViewStyle,"change:strokeWeight":this.updateViewStyle,"change:strokeOpacity":this.updateViewStyle})};return t.inherits(s,e),s.prototype.createView_=function(){return new r.Polyline({path:i.pathToLatLng(this.object_.get("path")),strokeColor:this.object_.get("strokeColor"),strokeWeight:this.object_.get("strokeWeight"),strokeOpacity:this.object_.get("strokeOpacity")})},s.prototype.setMap=function(){e.prototype.setMap.apply(this,arguments),this.getView().setMap(this.mapView_)},s.prototype.beforeRemove_=function(){this.getView().setMap(null)},s.prototype.updatePath=function(){var t=i.pathToLatLng(this.object_.get("path"));this.getView().setPath(t)},s.prototype.updateViewStyle=function(){this.getView().setOptions({strokeColor:this.object_.get("strokeColor"),strokeWeight:this.object_.get("strokeWeight"),strokeOpacity:this.object_.get("strokeOpacity")})},s.prototype.bindViewEvents_=function(){this.googleEvents_.listenTo(this.getView(),{click:function(t){var e=i.latLngToArray(t.latLng);this.object_.trigger("click",e,this)}},this)},s}),n("aeris/packages/gmaps",["aeris/packages/maps","aeris/maps/strategy/infobox","aeris/maps/strategy/map","aeris/maps/strategy/markers/marker","aeris/maps/strategy/markers/markercluster","aeris/maps/strategy/layers/aeristile","aeris/maps/strategy/layers/aerispolygons","aeris/maps/strategy/layers/googlemaptype","aeris/maps/strategy/layers/kml","aeris/maps/strategy/layers/osm","aeris/maps/strategy/layers/tile","aeris/maps/strategy/polylines/polyline"],function(){}),n("aeris/api/models/advisory",["aeris/util","aeris/api/models/aerisapimodel"],function(t,e){var i=function(i,r){var s=t.defaults(r||{},{endpoint:"advisories"});e.call(this,i,s)};return t.inherits(i,e),i.prototype.parse=function(t){return t.response?t.response[0]:t},t.expose(i,"aeris.api.models.Advisory")}),n("aeris/api/models/forecast",["aeris/util","aeris/api/models/aerisapimodel"],function(t,e){var i=function(i,r){var s=t.defaults(r||{},{endpoint:"forecasts"});e.call(this,i,s)};return t.inherits(i,e),t.expose(i,"aeris.api.models.Forecast")}),n("aeris/api/models/observation",["aeris/util","aeris/api/models/aerisapimodel"],function(t,e){var i=function(i,r){var s=t.defaults(r||{},{endpoint:"observations"});e.call(this,i,s)};return t.inherits(i,e),t.expose(i,"aeris.api.models.Observation")}),n("aeris/packages/api",["aeris/api/collections/earthquakes","aeris/api/collections/fires","aeris/api/collections/lightning","aeris/api/collections/stormreports","aeris/api/models/advisory","aeris/api/models/earthquake","aeris/api/models/fire","aeris/api/models/forecast","aeris/api/models/lightning","aeris/api/models/observation","aeris/api/models/stormreport"],function(){}),n("aeris/geolocate/options/geolocateserviceoptions",["aeris/util"],function(t){var e=function(e){var i=t.defaults(e||{},this.getDefaultOptions());this.enableHighAccuracy=i.enableHighAccuracy,this.maximumAge=i.maximumAge,this.timeout=i.timeout};return e.prototype.getDefaultOptions=function(){return t.clone(e.DEFAULT_OPTIONS)},e.DEFAULT_OPTIONS={enableHighAccuracy:!1,maximumAge:3e4,timeout:1e4},e}),n("aeris/geolocate/options/freegeoipserviceoptions",["aeris/util","aeris/geolocate/options/geolocateserviceoptions","aeris/jsonp"],function(t,e,i){var r=function(i){var r=t.defaults(i||{},this.getDefaultOptions());this.jsonp=r.jsonp,this.ip_address=r.ip_address,e.call(this,r)};return t.inherits(r,e),r.prototype.getDefaultOptions=function(){return t.clone(r.DEFAULT_OPTIONS)},r.DEFAULT_OPTIONS=t.extend({},e.DEFAULT_OPTIONS,{ip_address:"",jsonp:i}),r}),n("aeris/geolocate/results/geolocateposition",["aeris/util"],function(t){var e=function(e){return t.defaults(e,{latLon:null,altitude:null,altitudeAccuracy:null,accuracy:null,heading:null,speed:null,timestamp:null}),e};return e}),n("aeris/geolocate/errors/geolocateserviceerror",["aeris/errors/errortypefactory"],function(t){var e=function(i){var r=new t({name:"GeolocateServiceError"}),s=new r(i.message);return s.code=i.code,s.PERMISSION_DENIED=e.PERMISSION_DENIED,s.POSITION_UNAVAILABLE=e.POSITION_UNAVAILABLE,s.TIMEOUT=e.TIMEOUT,s};return e.PERMISSION_DENIED=1,e.POSITION_UNAVAILABLE=2,e.TIMEOUT=3,e}),n("aeris/geolocate/freegeoipgeolocateservice",["aeris/util","aeris/promise","aeris/geolocate/options/freegeoipserviceoptions","aeris/geolocate/results/geolocateposition","aeris/geolocate/errors/geolocateserviceerror"],function(t,e,i,r,s){var n=function(t){var e=new i(t);this.url_="//freegeoip.net/json/"+e.ip_address,this.jsonp_=e.jsonp,this.watchId_=null,this.lastPosition_};return n.prototype.getCurrentPosition=function(){var i=new e;return this.jsonp_.get(this.url_,{},t.bind(this.resolve_,this,i)),i},n.prototype.watchPosition=function(e,i,r){var s=t.extend({interval:3e3},r),n=this,o=function(){};e||(e=o),i||(i=o);var a=function(){n.getCurrentPosition().done(function(i){n.lastPosition_&&t.isEqual(i,n.lastPosition_)||(e(i),n.lastPosition_=i)}).fail(i)};this.watchId_=window.setInterval(a,s.interval),a()},n.prototype.clearWatch=function(){t.isNull(this.watchId_)||(window.clearInterval(this.watchId_),this.lastPosition_=null)},n.isSupported=function(){return!0},n.prototype.resolve_=function(e,i){i&&t.isNumber(i.latitude)&&t.isNumber(i.longitude)?e.resolve(new r({latLon:[i.latitude,i.longitude]})):e.reject(new s({code:s.POSITION_UNAVAILABLE,message:"FreeGeoIP returned unexpected data."}))},t.expose(n,"aeris.geolocate.FreeGeoIPGeolocateService")}),n("aeris/geolocate/options/html5serviceoptions",["aeris/util","aeris/geolocate/options/geolocateserviceoptions"],function(t,e){var i=this,r=function(i){var r=t.defaults(i||{},this.getDefaultOptions());this.navigator=r.navigator,e.call(this,r)};return t.inherits(r,e),r.prototype.getDefaultOptions=function(){return t.clone(r.DEFAULT_OPTIONS)},r.DEFAULT_OPTIONS=t.extend({},e.DEFAULT_OPTIONS,{navigator:i.navigator}),r}),n("aeris/geolocate/html5geolocateservice",["aeris/util","aeris/promise","aeris/geolocate/options/html5serviceoptions","aeris/geolocate/results/geolocateposition","aeris/geolocate/errors/geolocateserviceerror"],function(t,e,i,r,s){var n=this,o=function(e){var r=new i(e);this.navigatorOptions_=t.pick(r,"enableHighAccuracy","maximumAge","timeout"),this.navigator_=r.navigator,this.watchId_=null};return o.prototype.getCurrentPosition=function(){var i=new e,r=t.bind(function(t){i.resolve(this.createPosition_(t))},this),s=t.bind(function(t){i.reject(this.createGeolocateError_(t))},this);return o.isSupported()?this.navigator_.geolocation.getCurrentPosition(r,s,this.navigatorOptions_):i.reject(this.createServiceUnavailableError_()),i},o.prototype.watchPosition=function(t,e){var i=this;o.isSupported()?this.watchId_=this.navigator_.geolocation.watchPosition(function(e){t(i.createPosition_(e))},function(t){e(i.createGeolocateError_(t))},this.navigatorOptions_):e(this.createServiceUnavailableError_())},o.prototype.createServiceUnavailableError_=function(){return this.createGeolocateError_({message:"HTML5 Geolocation is not available.",code:s.POSITION_UNAVAILABLE})},o.prototype.clearWatch=function(){t.isNull(this.watchId_)||(this.navigator_.geolocation.clearWatch(this.watchId_),this.watchId_=null)},o.isSupported=function(){return!(!n.navigator||!n.navigator.geolocation)},o.prototype.createPosition_=function(e){return new r(t.extend({latLon:[e.coords.latitude,e.coords.longitude],timestamp:e.timestamp||null},t.pick(e.coords,"altitude","altitudeAccuracy","accuracy","heading","speed")))},o.prototype.createGeolocateError_=function(t){return new s(t)},t.expose(o,"aeris.geolocate.HTML5GeolocateService")}),n("aeris/geocode/geocodeserviceresponse",[],function(){var t=function(t){return t};return t}),n("aeris/geocode/geocodeservicestatus",["aeris/util"],function(t){return t.expose({OK:"OK",API_ERROR:"API_ERROR",INVALID_REQUEST:"INVALID_REQUEST",NO_RESULTS:"NO_RESULTS"},"aeris.geocode.GeocodeServiceStatus")}),n("aeris/geocode/googlegeocodeservice",["aeris/util","aeris/util/gmaps","googlemaps!","aeris/promise","aeris/geocode/geocodeserviceresponse","aeris/geocode/geocodeservicestatus"],function(t,e,i,r,s,n){var o=function(){this.googleService_=new i.Geocoder};return o.prototype.setGoogleService=function(t){this.googleService_=t},o.prototype.geocode=function(t){var i=new r,o={OK:"OK",OVER_QUERY_LIMIT:"API_ERROR",ZERO_RESULTS:"NO_RESULTS",REQUEST_DENIED:"API_ERROR",INVALID_REQUEST:"INVALID_REQUEST"},a={address:t};return this.googleService_.geocode(a,function(r,a){var l=n[o[a]];l===n.OK?i.resolve(new s({latLon:e.latLngToArray(r[0].geometry.location),status:new s({code:l,apiCode:a,message:"Successfully geocoded location: "+t})})):i.reject({status:new s({code:l,apiCode:a,message:"Error geocoding location: "+a})})
}),i},t.expose(o,"aeris.geocode.GoogleGeocodeService")}),n("aeris/geocode/config",["aeris/util","aeris/model","module"],function(t,e,i){return new e(i.config())}),n("aeris/errors/invalidconfigerror",["aeris/errors/errortypefactory"],function(t){return new t({name:"InvalidConfigError"})}),n("aeris/geocode/mapquestgeocodeservice",["aeris/util","aeris/promise","aeris/jsonp","aeris/geocode/config","aeris/errors/invalidconfigerror","aeris/geocode/geocodeserviceresponse","aeris/geocode/geocodeservicestatus"],function(t,e,i,r,s,n,o){var a=function(e){var s=t.defaults(e||{},{apiId:r.get("apiId")});this.apiId_=s.apiId,this.serviceUrl_="//open.mapquestapi.com/geocoding/v1/address",this.jsonp_=i};return a.prototype.geocode=function(i){var r=new e,s=this.getMapQuestUri_(),n={location:i};return this.jsonp_.get(s,n,t.bind(function(e){e&&e.info&&!t.isUndefined(e.info.statuscode)?this.isStatusCodeErrorResponse_(e)?r.reject(this.createStatusCodeError_(e)):this.isNoResultsErrorResponse_(e)?r.reject(this.createNoResultsError_(e)):r.resolve(this.createGeocodeResponse_(e)):r.reject(this.createUnexpectedResultsError_(e))},this)),r},a.prototype.getMapQuestUri_=function(){return this.ensureApiId_(),this.serviceUrl_+"?key="+this.apiId_},a.prototype.ensureApiId_=function(){if(this.apiId_=this.apiId_||r.get("apiId"),!this.apiId_)throw new s("The MapQuestGeocodeService requires an apiId")},a.prototype.isStatusCodeErrorResponse_=function(e){var i=e&&e.info,r=i?parseInt(e.info.statuscode):null;return!t.isNumeric(r)||r>=400},a.prototype.isNoResultsErrorResponse_=function(t){var e=t&&t.results;return!(!e||t.results.length&&t.results[0].locations&&t.results[0].locations.length)},a.prototype.createUnexpectedResultsError_=function(){return new n({latLon:[],status:{code:o.API_ERROR,apiCode:"",message:"The MapQuest Geolocation API returned an unexpected response."}})},a.prototype.createStatusCodeError_=function(t){var e={0:o.OK,400:o.INVALID_REQUEST,403:o.API_ERROR,500:o.API_ERROR};return new n({latLon:[],status:{code:e[t.info.statuscode]||o.API_ERROR,apiCode:t.info.statuscode,message:t.info.messages.join("; ")}})},a.prototype.createNoResultsError_=function(t){return new n({latLon:[],status:{code:o.NO_RESULTS,apiCode:t.info.statuscode,message:t.info.messages.join("; ")}})},a.prototype.createGeocodeResponse_=function(t){var e=t.results[0].locations[0];return new n({latLon:[parseFloat(e.latLng.lat),parseFloat(e.latLng.lng)],status:{code:o.OK,apiCode:t.info.statuscode,message:t.info.messages.join("; ")}})},a.prototype.setJSONP=function(t){this.jsonp_=t},t.expose(a,"aeris.geocode.MapQuestGeocodeService")}),n("aeris/packages/geoservice",["aeris/geolocate/freegeoipgeolocateservice","aeris/geolocate/html5geolocateservice","aeris/geocode/googlegeocodeservice","aeris/geocode/mapquestgeocodeservice"],function(){}),s("aeris/packages/gmaps"),s("aeris/packages/api"),s("aeris/packages/geoservice"),aeris});